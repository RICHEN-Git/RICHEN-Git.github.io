<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RICHEN</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="./image/git.png">
    <link rel="stylesheet" href="./css/style.css">
    <meta name="description" content="enRiching GIt doCumentation witH Examples miNed from Stack Overflow">
    
    <link rel="preload" href="./assets/css/0.styles.2ca7c5d3.css" as="style"><link rel="preload" href="./assets/js/app.e311b099.js" as="script"><link rel="preload" href="./assets/js/2.48635caf.js" as="script"><link rel="preload" href="./assets/js/119.13f74eae.js" as="script"><link rel="prefetch" href="./assets/js/10.e1617348.js"><link rel="prefetch" href="./assets/js/100.33cca180.js"><link rel="prefetch" href="./assets/js/101.18976a0a.js"><link rel="prefetch" href="./assets/js/102.8317b37b.js"><link rel="prefetch" href="./assets/js/103.07197de5.js"><link rel="prefetch" href="./assets/js/104.731bc1e4.js"><link rel="prefetch" href="./assets/js/105.c63b5cda.js"><link rel="prefetch" href="./assets/js/106.6d64500a.js"><link rel="prefetch" href="./assets/js/107.41117ce7.js"><link rel="prefetch" href="./assets/js/108.ae1670af.js"><link rel="prefetch" href="./assets/js/109.334fc4b2.js"><link rel="prefetch" href="./assets/js/11.d2acd68b.js"><link rel="prefetch" href="./assets/js/110.a423a716.js"><link rel="prefetch" href="./assets/js/111.ec3f4b9d.js"><link rel="prefetch" href="./assets/js/112.99e97bd6.js"><link rel="prefetch" href="./assets/js/113.dca119e6.js"><link rel="prefetch" href="./assets/js/114.62cf553b.js"><link rel="prefetch" href="./assets/js/115.b3dc05f5.js"><link rel="prefetch" href="./assets/js/116.f1ad5266.js"><link rel="prefetch" href="./assets/js/117.9554ab91.js"><link rel="prefetch" href="./assets/js/118.767812f8.js"><link rel="prefetch" href="./assets/js/12.03eb7f39.js"><link rel="prefetch" href="./assets/js/120.3616df73.js"><link rel="prefetch" href="./assets/js/121.cdacf559.js"><link rel="prefetch" href="./assets/js/122.e46153a3.js"><link rel="prefetch" href="./assets/js/123.18b06bd9.js"><link rel="prefetch" href="./assets/js/124.028e957c.js"><link rel="prefetch" href="./assets/js/125.1499f786.js"><link rel="prefetch" href="./assets/js/126.6d4256ba.js"><link rel="prefetch" href="./assets/js/127.e0aac155.js"><link rel="prefetch" href="./assets/js/128.e58a9c82.js"><link rel="prefetch" href="./assets/js/129.153a8856.js"><link rel="prefetch" href="./assets/js/13.b3c19674.js"><link rel="prefetch" href="./assets/js/130.a53c0b9a.js"><link rel="prefetch" href="./assets/js/131.7828ecc2.js"><link rel="prefetch" href="./assets/js/132.41634721.js"><link rel="prefetch" href="./assets/js/133.2cb44028.js"><link rel="prefetch" href="./assets/js/134.58581a37.js"><link rel="prefetch" href="./assets/js/135.c9380642.js"><link rel="prefetch" href="./assets/js/136.b6ffd3c7.js"><link rel="prefetch" href="./assets/js/137.1a8edb9d.js"><link rel="prefetch" href="./assets/js/138.5fce928f.js"><link rel="prefetch" href="./assets/js/139.71aa88e1.js"><link rel="prefetch" href="./assets/js/14.babb932e.js"><link rel="prefetch" href="./assets/js/140.7f377bd1.js"><link rel="prefetch" href="./assets/js/141.f49215bb.js"><link rel="prefetch" href="./assets/js/142.130e4ba1.js"><link rel="prefetch" href="./assets/js/143.94c54ada.js"><link rel="prefetch" href="./assets/js/144.6ed9cf6e.js"><link rel="prefetch" href="./assets/js/145.3846d48f.js"><link rel="prefetch" href="./assets/js/146.f245fd88.js"><link rel="prefetch" href="./assets/js/147.f2406a95.js"><link rel="prefetch" href="./assets/js/148.39c0e458.js"><link rel="prefetch" href="./assets/js/149.ffa6fd8a.js"><link rel="prefetch" href="./assets/js/15.07fe9b50.js"><link rel="prefetch" href="./assets/js/150.02bb59b1.js"><link rel="prefetch" href="./assets/js/151.37a6afec.js"><link rel="prefetch" href="./assets/js/152.796eec33.js"><link rel="prefetch" href="./assets/js/153.dc7c378e.js"><link rel="prefetch" href="./assets/js/154.cf710861.js"><link rel="prefetch" href="./assets/js/155.c30753e3.js"><link rel="prefetch" href="./assets/js/156.ddce82b2.js"><link rel="prefetch" href="./assets/js/157.069e9f8f.js"><link rel="prefetch" href="./assets/js/16.ef23c91e.js"><link rel="prefetch" href="./assets/js/17.817c34aa.js"><link rel="prefetch" href="./assets/js/18.c6f6e6ed.js"><link rel="prefetch" href="./assets/js/19.cfc0468d.js"><link rel="prefetch" href="./assets/js/20.3546a4ea.js"><link rel="prefetch" href="./assets/js/21.c290e743.js"><link rel="prefetch" href="./assets/js/22.cc04f442.js"><link rel="prefetch" href="./assets/js/23.1a94bca1.js"><link rel="prefetch" href="./assets/js/24.443e3a00.js"><link rel="prefetch" href="./assets/js/25.1a5ee134.js"><link rel="prefetch" href="./assets/js/26.edd51004.js"><link rel="prefetch" href="./assets/js/27.8d0e855e.js"><link rel="prefetch" href="./assets/js/28.17f95192.js"><link rel="prefetch" href="./assets/js/29.e3219a64.js"><link rel="prefetch" href="./assets/js/3.6bd04ed3.js"><link rel="prefetch" href="./assets/js/30.7ddd3774.js"><link rel="prefetch" href="./assets/js/31.671ee6bc.js"><link rel="prefetch" href="./assets/js/32.14e6e041.js"><link rel="prefetch" href="./assets/js/33.694f0624.js"><link rel="prefetch" href="./assets/js/34.a24cb95a.js"><link rel="prefetch" href="./assets/js/35.b9274172.js"><link rel="prefetch" href="./assets/js/36.90de1eb5.js"><link rel="prefetch" href="./assets/js/37.316285c4.js"><link rel="prefetch" href="./assets/js/38.7666fb89.js"><link rel="prefetch" href="./assets/js/39.d325104f.js"><link rel="prefetch" href="./assets/js/4.e3ec6571.js"><link rel="prefetch" href="./assets/js/40.c69344c4.js"><link rel="prefetch" href="./assets/js/41.255ef83a.js"><link rel="prefetch" href="./assets/js/42.93911f6f.js"><link rel="prefetch" href="./assets/js/43.2d2a661b.js"><link rel="prefetch" href="./assets/js/44.fb24dd71.js"><link rel="prefetch" href="./assets/js/45.deac9add.js"><link rel="prefetch" href="./assets/js/46.ac87e5e7.js"><link rel="prefetch" href="./assets/js/47.addfea2d.js"><link rel="prefetch" href="./assets/js/48.5fefec78.js"><link rel="prefetch" href="./assets/js/49.a328b7d6.js"><link rel="prefetch" href="./assets/js/5.dd8b7ea7.js"><link rel="prefetch" href="./assets/js/50.2cbc41fc.js"><link rel="prefetch" href="./assets/js/51.08ce739c.js"><link rel="prefetch" href="./assets/js/52.59af3778.js"><link rel="prefetch" href="./assets/js/53.9ead31f4.js"><link rel="prefetch" href="./assets/js/54.f24de741.js"><link rel="prefetch" href="./assets/js/55.05aa52da.js"><link rel="prefetch" href="./assets/js/56.d43fb632.js"><link rel="prefetch" href="./assets/js/57.7fa6e090.js"><link rel="prefetch" href="./assets/js/58.fb6d6521.js"><link rel="prefetch" href="./assets/js/59.778ade86.js"><link rel="prefetch" href="./assets/js/6.82ef2073.js"><link rel="prefetch" href="./assets/js/60.613c4878.js"><link rel="prefetch" href="./assets/js/61.681c256c.js"><link rel="prefetch" href="./assets/js/62.e943d1b9.js"><link rel="prefetch" href="./assets/js/63.990aaadb.js"><link rel="prefetch" href="./assets/js/64.5759fedf.js"><link rel="prefetch" href="./assets/js/65.f970e42e.js"><link rel="prefetch" href="./assets/js/66.dd24c3d9.js"><link rel="prefetch" href="./assets/js/67.5fb2be90.js"><link rel="prefetch" href="./assets/js/68.ec785420.js"><link rel="prefetch" href="./assets/js/69.1d315c02.js"><link rel="prefetch" href="./assets/js/7.a3b325ca.js"><link rel="prefetch" href="./assets/js/70.d6012aac.js"><link rel="prefetch" href="./assets/js/71.52d01068.js"><link rel="prefetch" href="./assets/js/72.bbe5d2f6.js"><link rel="prefetch" href="./assets/js/73.0d7b6abc.js"><link rel="prefetch" href="./assets/js/74.3b1eeb63.js"><link rel="prefetch" href="./assets/js/75.6afe5c8a.js"><link rel="prefetch" href="./assets/js/76.d9877d60.js"><link rel="prefetch" href="./assets/js/77.5d4a9d5d.js"><link rel="prefetch" href="./assets/js/78.e2ad497a.js"><link rel="prefetch" href="./assets/js/79.697e2354.js"><link rel="prefetch" href="./assets/js/8.e85cc98d.js"><link rel="prefetch" href="./assets/js/80.be1f2dd0.js"><link rel="prefetch" href="./assets/js/81.ce13acd9.js"><link rel="prefetch" href="./assets/js/82.df76b5ac.js"><link rel="prefetch" href="./assets/js/83.3c842d13.js"><link rel="prefetch" href="./assets/js/84.6534a56c.js"><link rel="prefetch" href="./assets/js/85.c0b581a0.js"><link rel="prefetch" href="./assets/js/86.bfbfbed9.js"><link rel="prefetch" href="./assets/js/87.f7e7b93e.js"><link rel="prefetch" href="./assets/js/88.f69371e0.js"><link rel="prefetch" href="./assets/js/89.b970999b.js"><link rel="prefetch" href="./assets/js/9.2cc7c68c.js"><link rel="prefetch" href="./assets/js/90.31b35c49.js"><link rel="prefetch" href="./assets/js/91.8a794555.js"><link rel="prefetch" href="./assets/js/92.4a75f06f.js"><link rel="prefetch" href="./assets/js/93.83c18202.js"><link rel="prefetch" href="./assets/js/94.2d339421.js"><link rel="prefetch" href="./assets/js/95.2dcb1fb2.js"><link rel="prefetch" href="./assets/js/96.8d019eed.js"><link rel="prefetch" href="./assets/js/97.b9ff4345.js"><link rel="prefetch" href="./assets/js/98.316d9923.js"><link rel="prefetch" href="./assets/js/99.0006ac5c.js">
    <link rel="stylesheet" href="./assets/css/0.styles.2ca7c5d3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><!----> <span class="site-name">RICHEN</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./richen/" class="nav-link router-link-active">
  RICHEN
</a></div><div class="nav-item"><a href="https://stackoverflow.com/questions/tagged/git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Stack Overflow
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/./richen/" class="nav-link router-link-active">
  RICHEN
</a></div><div class="nav-item"><a href="https://stackoverflow.com/questions/tagged/git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Stack Overflow
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Enchied Git Documentation</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./richen/git-add.html" class="sidebar-link">git add</a></li><li><a href="/./richen/git-am.html" class="sidebar-link">git am</a></li><li><a href="/./richen/git-annotate.html" class="sidebar-link">git annotate</a></li><li><a href="/./richen/git-apply.html" class="sidebar-link">git apply</a></li><li><a href="/./richen/git-archimport.html" class="sidebar-link">git archimport</a></li><li><a href="/./richen/git-archive.html" class="sidebar-link">git archive</a></li><li><a href="/./richen/git-bisect.html" class="sidebar-link">git bisect</a></li><li><a href="/./richen/git-blame.html" class="sidebar-link">git blame</a></li><li><a href="/./richen/git-branch.html" class="sidebar-link">git branch</a></li><li><a href="/./richen/git-bugreport.html" class="sidebar-link">git bugreport</a></li><li><a href="/./richen/git-bundle.html" class="sidebar-link">git bundle</a></li><li><a href="/./richen/git-cat-file.html" class="sidebar-link">git cat-file</a></li><li><a href="/./richen/git-check-attr.html" class="sidebar-link">git check-attr</a></li><li><a href="/./richen/git-check-ignore.html" class="sidebar-link">git check-ignore</a></li><li><a href="/./richen/git-check-mailmap.html" class="sidebar-link">git check-mailmap</a></li><li><a href="/./richen/git-check-ref-format.html" class="sidebar-link">git check-ref-format</a></li><li><a href="/./richen/git-checkout.html" class="sidebar-link">git checkout</a></li><li><a href="/./richen/git-checkout-index.html" class="sidebar-link">git checkout-index</a></li><li><a href="/./richen/git-cherry.html" class="sidebar-link">git cherry</a></li><li><a href="/./richen/git-cherry-pick.html" class="sidebar-link">git cherry-pick</a></li><li><a href="/./richen/git-citool.html" class="sidebar-link">git citool</a></li><li><a href="/./richen/git-clean.html" class="sidebar-link">git clean</a></li><li><a href="/./richen/git-clone.html" class="sidebar-link">git clone</a></li><li><a href="/./richen/git-column.html" class="sidebar-link">git column</a></li><li><a href="/./richen/git-commit.html" class="sidebar-link">git commit</a></li><li><a href="/./richen/git-commit-graph.html" class="sidebar-link">git commit-graph</a></li><li><a href="/./richen/git-commit-tree.html" class="sidebar-link">git commit-tree</a></li><li><a href="/./richen/git-config.html" class="sidebar-link">git config</a></li><li><a href="/./richen/git-count-objects.html" class="sidebar-link">git count-objects</a></li><li><a href="/./richen/git-credential.html" class="sidebar-link">git credential</a></li><li><a href="/./richen/git-credential-cache.html" class="sidebar-link">git credential-cache</a></li><li><a href="/./richen/git-credential-store.html" class="sidebar-link">git credential-store</a></li><li><a href="/./richen/git-cvsexportcommit.html" class="sidebar-link">git cvsexportcommit</a></li><li><a href="/./richen/git-cvsimport.html" class="sidebar-link">git cvsimport</a></li><li><a href="/./richen/git-cvsserver.html" class="sidebar-link">git cvsserver</a></li><li><a href="/./richen/git-daemon.html" class="sidebar-link">git daemon</a></li><li><a href="/./richen/git-describe.html" class="sidebar-link">git describe</a></li><li><a href="/./richen/git-diff.html" class="sidebar-link">git diff</a></li><li><a href="/./richen/git-diff-files.html" class="sidebar-link">git diff-files</a></li><li><a href="/./richen/git-diff-index.html" class="sidebar-link">git diff-index</a></li><li><a href="/./richen/git-diff-tree.html" class="sidebar-link">git diff-tree</a></li><li><a href="/./richen/git-difftool.html" class="sidebar-link">git difftool</a></li><li><a href="/./richen/git-fast-export.html" class="sidebar-link">git fast-export</a></li><li><a href="/./richen/git-fast-import.html" class="sidebar-link">git fast-import</a></li><li><a href="/./richen/git-fetch.html" class="sidebar-link">git fetch</a></li><li><a href="/./richen/git-fetch-pack.html" class="sidebar-link">git fetch-pack</a></li><li><a href="/./richen/git-filter-branch.html" class="sidebar-link">git filter-branch</a></li><li><a href="/./richen/git-fmt-merge-msg.html" class="sidebar-link">git fmt-merge-msg</a></li><li><a href="/./richen/git-for-each-ref.html" class="sidebar-link">git for-each-ref</a></li><li><a href="/./richen/git-for-each-repo.html" class="sidebar-link">git for-each-repo</a></li><li><a href="/./richen/git-format-patch.html" class="sidebar-link">git format-patch</a></li><li><a href="/./richen/git-fsck.html" class="sidebar-link">git fsck</a></li><li><a href="/./richen/git-gc.html" class="sidebar-link">git gc</a></li><li><a href="/./richen/git-get-tar-commit-id.html" class="sidebar-link">git get-tar-commit-id</a></li><li><a href="/./richen/git-grep.html" class="sidebar-link">git grep</a></li><li><a href="/./richen/git-gui.html" class="sidebar-link">git gui</a></li><li><a href="/./richen/git-hash-object.html" class="sidebar-link">git hash-object</a></li><li><a href="/./richen/git-help.html" class="sidebar-link">git help</a></li><li><a href="/./richen/git-http-backend.html" class="sidebar-link">git http-backend</a></li><li><a href="/./richen/git-http-fetch.html" class="sidebar-link">git http-fetch</a></li><li><a href="/./richen/git-http-push.html" class="sidebar-link">git http-push</a></li><li><a href="/./richen/git-imap-send.html" class="sidebar-link">git imap-send</a></li><li><a href="/./richen/git-index-pack.html" class="sidebar-link">git index-pack</a></li><li><a href="/./richen/git-init.html" class="sidebar-link">git init</a></li><li><a href="/./richen/git-instaweb.html" class="sidebar-link">git instaweb</a></li><li><a href="/./richen/git-interpret-trailers.html" class="sidebar-link">git interpret-trailers</a></li><li><a href="/./richen/git-log.html" class="sidebar-link">git log</a></li><li><a href="/./richen/git-ls-files.html" class="sidebar-link">git ls-files</a></li><li><a href="/./richen/git-ls-remote.html" class="sidebar-link">git ls-remote</a></li><li><a href="/./richen/git-ls-tree.html" class="sidebar-link">git ls-tree</a></li><li><a href="/./richen/git-mailinfo.html" class="sidebar-link">git mailinfo</a></li><li><a href="/./richen/git-mailsplit.html" class="sidebar-link">git mailsplit</a></li><li><a href="/./richen/git-maintenance.html" class="sidebar-link">git maintenance</a></li><li><a href="/./richen/git-merge.html" class="sidebar-link">git merge</a></li><li><a href="/./richen/git-merge-base.html" class="sidebar-link">git merge-base</a></li><li><a href="/./richen/git-merge-file.html" class="sidebar-link">git merge-file</a></li><li><a href="/./richen/git-merge-index.html" class="sidebar-link">git merge-index</a></li><li><a href="/./richen/git-merge-one-file.html" class="sidebar-link">git merge-one-file</a></li><li><a href="/./richen/git-merge-tree.html" class="sidebar-link">git merge-tree</a></li><li><a href="/./richen/git-mergetool.html" class="sidebar-link">git mergetool</a></li><li><a href="/./richen/git-mktag.html" class="sidebar-link">git mktag</a></li><li><a href="/./richen/git-mktree.html" class="sidebar-link">git mktree</a></li><li><a href="/./richen/git-multi-pack-index.html" class="sidebar-link">git multi-pack-index</a></li><li><a href="/./richen/git-mv.html" class="sidebar-link">git mv</a></li><li><a href="/./richen/git-name-rev.html" class="sidebar-link">git name-rev</a></li><li><a href="/./richen/git-notes.html" class="sidebar-link">git notes</a></li><li><a href="/./richen/git-p4.html" class="sidebar-link">git p4</a></li><li><a href="/./richen/git-pack-objects.html" class="sidebar-link">git pack-objects</a></li><li><a href="/./richen/git-pack-redundant.html" class="sidebar-link">git pack-redundant</a></li><li><a href="/./richen/git-pack-refs.html" class="sidebar-link">git pack-refs</a></li><li><a href="/./richen/git-patch-id.html" class="sidebar-link">git patch-id</a></li><li><a href="/./richen/git-prune.html" class="sidebar-link">git prune</a></li><li><a href="/./richen/git-prune-packed.html" class="sidebar-link">git prune-packed</a></li><li><a href="/./richen/git-pull.html" class="sidebar-link">git pull</a></li><li><a href="/./richen/git-push.html" class="sidebar-link">git push</a></li><li><a href="/./richen/git-quiltimport.html" class="sidebar-link">git quiltimport</a></li><li><a href="/./richen/git-range-diff.html" class="sidebar-link">git range-diff</a></li><li><a href="/./richen/git-read-tree.html" class="sidebar-link">git read-tree</a></li><li><a href="/./richen/git-rebase.html" class="sidebar-link">git rebase</a></li><li><a href="/./richen/git-receive-pack.html" class="sidebar-link">git receive-pack</a></li><li><a href="/./richen/git-reflog.html" class="sidebar-link">git reflog</a></li><li><a href="/./richen/git-remote.html" class="sidebar-link">git remote</a></li><li><a href="/./richen/git-repack.html" class="sidebar-link">git repack</a></li><li><a href="/./richen/git-replace.html" class="sidebar-link">git replace</a></li><li><a href="/./richen/git-request-pull.html" class="sidebar-link">git request-pull</a></li><li><a href="/./richen/git-rerere.html" class="sidebar-link">git rerere</a></li><li><a href="/./richen/git-reset.html" class="sidebar-link">git reset</a></li><li><a href="/./richen/git-restore.html" class="sidebar-link">git restore</a></li><li><a href="/./richen/git-rev-list.html" class="sidebar-link">git rev-list</a></li><li><a href="/./richen/git-rev-parse.html" aria-current="page" class="active sidebar-link">git rev-parse</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#revs-only" class="sidebar-link">🔹 --revs-only</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#verify" class="sidebar-link">🔹 --verify</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#q" class="sidebar-link">🔹 -q</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#quiet" class="sidebar-link">🔹 --quiet</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#short" class="sidebar-link">🔹 --short</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#not" class="sidebar-link">🔹 --not</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#abbrev-ref" class="sidebar-link">🔹 --abbrev-ref</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#symbolic" class="sidebar-link">🔹 --symbolic</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#symbolic-full-name" class="sidebar-link">🔹 --symbolic-full-name</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#all" class="sidebar-link">🔹 --all</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#git-dir" class="sidebar-link">🔹 --git-dir</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#git-path" class="sidebar-link">🔹 --git-path</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#show-toplevel" class="sidebar-link">🔹 --show-toplevel</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#show-superproject-working-tree" class="sidebar-link">🔹 --show-superproject-working-tree</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#absolute-git-dir" class="sidebar-link">🔹 --absolute-git-dir</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#is-inside-work-tree" class="sidebar-link">🔹 --is-inside-work-tree</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#is-bare-repository" class="sidebar-link">🔹 --is-bare-repository</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#show-cdup" class="sidebar-link">🔹 --show-cdup</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#show-prefix" class="sidebar-link">🔹 --show-prefix</a></li><li class="sidebar-sub-header"><a href="/./richen/git-rev-parse.html#none" class="sidebar-link">🔹None</a></li></ul></li><li><a href="/./richen/git-revert.html" class="sidebar-link">git revert</a></li><li><a href="/./richen/git-rm.html" class="sidebar-link">git rm</a></li><li><a href="/./richen/git-send-email.html" class="sidebar-link">git send-email</a></li><li><a href="/./richen/git-send-pack.html" class="sidebar-link">git send-pack</a></li><li><a href="/./richen/git-sh-i18n.html" class="sidebar-link">git sh-i18n</a></li><li><a href="/./richen/git-sh-setup.html" class="sidebar-link">git sh-setup</a></li><li><a href="/./richen/git-shell.html" class="sidebar-link">git shell</a></li><li><a href="/./richen/git-shortlog.html" class="sidebar-link">git shortlog</a></li><li><a href="/./richen/git-show.html" class="sidebar-link">git show</a></li><li><a href="/./richen/git-show-branch.html" class="sidebar-link">git show-branch</a></li><li><a href="/./richen/git-show-index.html" class="sidebar-link">git show-index</a></li><li><a href="/./richen/git-show-ref.html" class="sidebar-link">git show-ref</a></li><li><a href="/./richen/git-sparse-checkout.html" class="sidebar-link">git sparse-checkout</a></li><li><a href="/./richen/git-stash.html" class="sidebar-link">git stash</a></li><li><a href="/./richen/git-status.html" class="sidebar-link">git status</a></li><li><a href="/./richen/git-stripspace.html" class="sidebar-link">git stripspace</a></li><li><a href="/./richen/git-submodule.html" class="sidebar-link">git submodule</a></li><li><a href="/./richen/git-svn.html" class="sidebar-link">git svn</a></li><li><a href="/./richen/git-switch.html" class="sidebar-link">git switch</a></li><li><a href="/./richen/git-symbolic-ref.html" class="sidebar-link">git symbolic-ref</a></li><li><a href="/./richen/git-tag.html" class="sidebar-link">git tag</a></li><li><a href="/./richen/git-unpack-file.html" class="sidebar-link">git unpack-file</a></li><li><a href="/./richen/git-unpack-objects.html" class="sidebar-link">git unpack-objects</a></li><li><a href="/./richen/git-update-index.html" class="sidebar-link">git update-index</a></li><li><a href="/./richen/git-update-ref.html" class="sidebar-link">git update-ref</a></li><li><a href="/./richen/git-update-server-info.html" class="sidebar-link">git update-server-info</a></li><li><a href="/./richen/git-upload-archive.html" class="sidebar-link">git upload-archive</a></li><li><a href="/./richen/git-upload-pack.html" class="sidebar-link">git upload-pack</a></li><li><a href="/./richen/git-var.html" class="sidebar-link">git var</a></li><li><a href="/./richen/git-verify-commit.html" class="sidebar-link">git verify-commit</a></li><li><a href="/./richen/git-verify-pack.html" class="sidebar-link">git verify-pack</a></li><li><a href="/./richen/git-verify-tag.html" class="sidebar-link">git verify-tag</a></li><li><a href="/./richen/git-version.html" class="sidebar-link">git version</a></li><li><a href="/./richen/git-whatchanged.html" class="sidebar-link">git whatchanged</a></li><li><a href="/./richen/git-worktree.html" class="sidebar-link">git worktree</a></li><li><a href="/./richen/git-write-tree.html" class="sidebar-link">git write-tree</a></li><li><a href="/./richen/gitk.html" class="sidebar-link">gitk</a></li><li><a href="/./richen/gitweb.html" class="sidebar-link">gitweb</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>📖 76 min read    🔡 15025<br></p></div> <h1 id="git-rev-parse-pick-out-and-massage-parameters"><a href="#git-rev-parse-pick-out-and-massage-parameters" class="header-anchor">#</a> 📌 git rev-parse - Pick out and massage parameters</h1> <h2 id="revs-only"><a href="#revs-only" class="header-anchor">#</a> 🔹 --revs-only</h2> <p><strong>1. Usage scenario: Git - poor merge permanently ignores files changes in sub branches</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-diff.html">git diff</a>, <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-merge-base.html">git merge-base</a>, <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/35511043" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> isChangeInBaseChanges() {
  for element in ${baseChanges[@]}; do 
    if [ $element == $change ]
 then 
 return 1
fi 
  done
  return 0
} 

revopts=`git rev-parse --revs-only $*`

if ! [[ $revopts ]] 
then
  revopts=<span class="token string">&quot;--all&quot;</span>
fi

exitCode=0

for merge in `git rev-list --min-parents=2 $revopts`; do
  mergeChanges=`git log -m -1 --name-only --pretty=<span class="token string">&quot;format:&quot;</span> $merge | sort -u`
  mergeBase=`git merge-base $merge^ $merge^2`  
  baseChanges=`git diff --name-only $merge $mergeBase`

  lostFiles=()
  for change in ${mergeChanges[@]}; do
     isChangeInBaseChanges
if [ $? -ne 1 ]
then
  lostFiles+=($change)
fi 
  done

  if [ ${#lostFiles[@]} -ne 0 ]
  then
    exitCode=1
    echo -n <span class="token string">&quot;Possible botched merge at &quot;</span>
echo  $merge
echo <span class="token string">&quot;files with lost changes are: &quot;</span>
for lostFile in ${lostFiles[@]}; do
 echo $lostFile
done
echo --------------------------------------------
  fi

done

exit $exitCode
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><h2 id="verify"><a href="#verify" class="header-anchor">#</a> 🔹 --verify</h2> <p><strong>1. Usage scenario: How to retrieve the hash for the current commit in Git?</strong></p> <blockquote><p><font size="2">💯Score: 3319    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/949391" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse HEAD

git rev-parse --verify HEAD

git rev-parse --short HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>2. Usage scenario: How to find the nearest parent of a Git branch</strong></p> <blockquote><p><font size="2">💯Score: 382    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a> ]    🌐<a href="https://stackoverflow.com/questions/3162929" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>pushedrev=...
basename=develop
if ! baserev=<span class="token string">&quot;$(git rev-parse --verify refs/heads/&quot;</span>$basename<span class="token string">&quot; 2&gt;/dev/null)&quot;</span>; then
    echo <span class="token string">&quot;'$basename' is missing, call for help!&quot;</span>
    exit 1
fi
parents_of_children_of_base=&quot;$(
  git rev-list --pretty=tformat:%P <span class="token string">&quot;$pushedrev&quot;</span> --not <span class="token string">&quot;$baserev&quot;</span> |
  grep -F <span class="token string">&quot;$baserev&quot;</span>
)&quot;
case <span class="token string">&quot;,$parents_of_children_of_base&quot;</span> in
    ,)     echo <span class="token string">&quot;must descend from tip of '$basename'&quot;</span>
           exit 1 ;;
    ,*\ *) echo <span class="token string">&quot;must not merge tip of '$basename' (rebase instead)&quot;</span>
           exit 1 ;;
    ,*)    exit 0 ;;
esac

pushedrev=...
basename=develop
if ! baserev=<span class="token string">&quot;$(git rev-parse --verify refs/heads/&quot;</span>$basename<span class="token string">&quot; 2&gt;/dev/null)&quot;</span>; then
    echo <span class="token string">&quot;'$basename' is missing, call for help!&quot;</span>
    exit 1
fi
parents_of_commits_beyond_base=&quot;$(
  git rev-list --pretty=tformat:%P <span class="token string">&quot;$pushedrev&quot;</span> --not <span class="token string">&quot;$baserev&quot;</span> |
  grep -v <span class="token string">'^commit '</span>
)&quot;
case <span class="token string">&quot;$parents_of_commits_beyond_base&quot;</span> in
    *\ *)          echo <span class="token string">&quot;must not push merge commits (rebase instead)&quot;</span>
                   exit 1 ;;
    *<span class="token string">&quot;$baserev&quot;</span>*)  exit 0 ;;
    *)             echo <span class="token string">&quot;must descend from tip of '$basename'&quot;</span>
                   exit 1 ;;
esac
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p><strong>3. Usage scenario: Git: How to find out on which branch a tag is?</strong></p> <blockquote><p><font size="2">💯Score: 140    🔗Associated commands: [ <a href="/./richen/git-branch.html">git branch</a> ]    🌐<a href="https://stackoverflow.com/questions/15806668" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git branch --contains tags/&lt;tag&gt;

 git rev-parse --verify tags/&lt;tag&gt;^{commit}
 # or, shorter:
 git rev-parse tags/&lt;tag&gt;~0

git branch --contains &lt;commit&gt;

git branch -a --contains tags/&lt;tag&gt;
git branch -a --contains &lt;commit&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>4. Usage scenario: bypass pre-commit hook for merge commits</strong></p> <blockquote><p><font size="2">💯Score: 31    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/27800562" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> git rev-parse -q --verify MERGE_HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>5. Usage scenario: How to print the latest commit ID from the git repo using shell script</strong></p> <blockquote><p><font size="2">💯Score: 9    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/55861051" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>COMMIT_ID=$(git rev-parse --verify HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>6. Usage scenario: Merging without changing the working directory</strong></p> <blockquote><p><font size="2">💯Score: 8    🔗Associated commands: [ <a href="/./richen/git-commit-tree.html">git commit-tree</a>, <a href="/./richen/git-symbolic-ref.html">git symbolic-ref</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-merge-base.html">git merge-base</a> ]    🌐<a href="https://stackoverflow.com/questions/3409382" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/bash</span>

branch=master
<span class="token comment"># or take an argument:</span>
<span class="token comment"># if [ $@ eq 1 ];</span>
<span class="token comment">#      branch=&quot;$1&quot;;</span>
<span class="token comment"># fi</span>

<span class="token comment"># make sure the branch exists</span>
if ! git rev-parse --verify --quiet --heads <span class="token string">&quot;$branch&quot;</span> &gt; /dev/null; then
     echo <span class="token string">&quot;error: branch $branch does not exist&quot;</span>
     exit 1
fi

<span class="token comment"># make sure this could be a fast-forward   </span>
if [ <span class="token string">&quot;$(git merge-base HEAD $branch)&quot;</span> == <span class="token string">&quot;$(git rev-parse $branch)&quot;</span> ]; then
    # find the branch name associated with HEAD
    currentbranch=$(git symbolic-ref HEAD | sed <span class="token string">'s@.*/@@'</span>)
    # make the commit
    newcommit=$(echo <span class="token string">&quot;Merge branch '$currentbranch'&quot;</span> | git commit-tree $(git log -n 1 --pretty=%T HEAD) -p $branch -p HEAD)
    # move the branch to point to the new commit
    git update-ref -m <span class="token string">&quot;merge $currentbranch: Merge made by simulated no-ff&quot;</span> <span class="token string">&quot;refs/heads/$branch&quot;</span> $newcommit
else
    echo <span class="token string">&quot;error: merging $currentbranch into $branch would not be a fast-forward&quot;</span>
    exit 1
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><strong>7. Usage scenario: How to detect if a branch exists using git command?</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/31914717" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse --quiet --verify $REVISION

if git rev-parse --quiet --verify $REVISION &gt; /dev/null; then
    # whatever
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>8. Usage scenario: Git pre-commit hook: Prevent commits that change particular files</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ <a href="/./richen/git-push.html">git push</a>, <a href="/./richen/git-diff.html">git diff</a> ]    🌐<a href="https://stackoverflow.com/questions/57962307" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>

<span class="token comment"># full paths from the repo root separated by newlines</span>
MUST_NOT_CHANGE='dir/key1.json
key2.json'

if git rev-parse --verify HEAD &gt;/dev/null 2&gt;&amp;1
then
  against=HEAD
else
  # Initial commit: diff against an empty tree object
  against=4b825dc642cb6eb9a060e54bf8d69288fbee4904
fi

exec 1&gt;&amp;2

if git diff --cached --name-only $against |
   grep --quiet --line-regexp --fixed-strings <span class="token string">&quot;$MUST_NOT_CHANGE&quot;</span>
then
  echo Commit would modify one or more files that must not change.
  exit 1
else
  exit 0
fi

<span class="token comment">#!/bin/sh</span>

<span class="token comment"># full paths from the repo root separated by newlines</span>
MUST_NOT_CHANGE='dir/key1.json
key2.json'

z40=0000000000000000000000000000000000000000

while read old_value new_value ref_name
do
  if [ <span class="token string">&quot;$old_value&quot;</span> = $z40 ]; then
    # New branch: diff against an empty tree object
    against=4b825dc642cb6eb9a060e54bf8d69288fbee4904
  else
    against=$old_value
  fi

  if git diff --name-only $against..$new_value |
     grep --quiet --line-regexp --fixed-strings <span class="token string">&quot;$MUST_NOT_CHANGE&quot;</span>
  then
    echo <span class="token string">&quot;$ref_name&quot;</span> may commit key, rejected ... &gt;&amp;2
    exit 1
  fi
done

<span class="token command">$ git push origin master</span>
Counting objects: 10, done.
Delta compression using up to 40 threads.
Compressing objects: 100% (6/6), done.
Writing objects: 100% (10/10), 820 bytes | 410.00 KiB/s, done.
Total 10 (delta 1), reused 0 (delta 0)
remote: refs/heads/master may commit key, rejected ...
To <span class="token string">'&lt;URL&gt;'</span>
 ! [remote rejected] master -&gt; master (pre-receive hook declined)
error: failed to push some refs to <span class="token string">'&lt;URL&gt;'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p><strong>9. Usage scenario: How to bypass pre-commit hooks after fixing merge conflicts?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/61239779" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse -q --verify MERGE_HEAD &amp;&amp; false
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>10. Usage scenario: Check if my current branch on local fork exists on remote upstream</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/66698435" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ While git rev-parse is great for things that do work, there are things that don<span class="token string">'t work.  For instance, here is what happens if I try to rev-parse a name that doesn'</span>t exist:
<span class="token command">$ git rev-parse refs/remotes/upstream/foobranch</span>
refs/remotes/upstream/foobranch
fatal: ambiguous argument <span class="token string">'refs/remotes/upstream/foobranch'</span>: unknown revision or path not in the working tree.
Use <span class="token string">'--'</span> to separate paths from revisions, like this:
<span class="token string">'git &lt;command&gt; [&lt;revision&gt;...] -- [&lt;file&gt;...]'</span>

▲ If all works, we get this:
<span class="token command">$ git rev-parse refs/remotes/origin/master</span>
225365fb5195e804274ab569ac3cc4919451dc7f

$ result=`git rev-parse refs/remotes/origin/master`
$

$ result=`git rev-parse refs/remotes/upstream/foobranch`
fatal: ambiguous argument <span class="token string">'refs/remotes/upstream/foobranch'</span>: unknown revision or path not in the working tree.
Use <span class="token string">'--'</span> to separate paths from revisions, like this:
<span class="token string">'git &lt;command&gt; [&lt;revision&gt;...] -- [&lt;file&gt;...]'</span>

var=`cmd`

var=$(cmd)

var=`cmd1 `cmd2` -- `cmd3``

var=$(cmd1 $(cmd2) -- $(cmd3))

var=$(cmd) || {
    echo <span class="token string">&quot;unable to run the given command&quot;</span>
    exit 1
}

▲ for instance.  So with git rev-parse, if the upstream doesn't exist, we might want:
result=$(git rev-parse refs/remotes/upstream/$MY_BRANCH) || exit

<span class="token deleted">--quiet --verify</span>

MY_BRANCH=$(git rev-parse --abbrev-ref HEAD) || exit
hash=$(git rev-parse --quiet --verify refs/remotes/upstream/$MY_BRANCH) || {
    echo <span class="token string">&quot;upstream/$MY_BRANCH does not exist&quot;</span>
    exit 1
}
<span class="token comment"># do whatever you like with upstream/$MY_BRANCH here</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h2 id="q"><a href="#q" class="header-anchor">#</a> 🔹 -q</h2> <p><strong>1. Usage scenario: bypass pre-commit hook for merge commits</strong></p> <blockquote><p><font size="2">💯Score: 31    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/27800562" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> git rev-parse -q --verify MERGE_HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>2. Usage scenario: allow new branch only from master</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-merge-base.html">git merge-base</a>, <a href="/./richen/git-symbolic-ref.html">git symbolic-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/24703329" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git branch foo main~1</span>

<span class="token comment">#! /bin/sh</span>
<span class="token comment">#</span>
<span class="token comment"># Are we on a branch, or do we have a detached HEAD?</span>
<span class="token comment"># If detached HEAD, just exit 0 = ok to commit.  Otherwise</span>
<span class="token comment"># set $branch to the short name of the branch.</span>
branch=$(git symbolic-ref -q --abbrev-ref HEAD) || exit 0

case <span class="token string">&quot;$branch&quot;</span> in
master) exit 0;;   # branch master, just allow (or deny=exit 1)
preprod) exit 0;;  # branch preprod, just allow
esac               # all others: fall through to next checks

<span class="token comment"># Must be a ticket branch.</span>
<span class="token comment"># If there are no branches named preprod and master, skip all this.</span>
<span class="token comment"># Otherwise, get their SHA-1 values.</span>
master=$(git rev-parse -q --verify preprod) || exit 0
preprod=$(git rev-parse -q --verify master) || exit 0

<span class="token comment"># Ensure that the new commit, once made, will not be a descendant</span>
<span class="token comment"># of branch preprod, and will be a descendent of master.  That is,</span>
<span class="token comment"># if we add a new commit node to the graph, ancestors(new) will</span>
<span class="token comment"># NOT include the commit labeled preprod but WILL include the</span>
<span class="token comment"># commit labeled master.</span>
<span class="token comment">#</span>
<span class="token comment"># Note that if preprod and master point to the *same* commit,</span>
<span class="token comment"># this condition can never be satisfied.  In this particular</span>
<span class="token comment"># case (preprod == master) just allow the commit.  (We're not</span>
<span class="token comment"># committing *on* master or preprod -- we checked that above --</span>
<span class="token comment"># so this commit will not move either of *those* two labels.)</span>
[ $master = $preprod ] &amp;&amp; exit 0

<span class="token comment"># A new commit's immediate parent will be whatever the SHA-1 of HEAD</span>
<span class="token comment"># is, so we simply check whether HEAD satisfies our conditions.</span>
if git merge-base --is-ancestor $preprod HEAD; then
    echo <span class="token string">&quot;ERROR: new commit will be a descendent of&quot;</span> 1&gt;&amp;2
    echo <span class="token string">&quot;    branch preprod (commit $preprod)&quot;</span> 1&gt;&amp;2
    exit 0
fi
if ! git merge-base --is-ancestor $master HEAD; then
    echo <span class="token string">&quot;ERROR: new commit will not be a descendent of&quot;</span> 1&gt;&amp;2
    echo <span class="token string">&quot;    branch master (commit $master)&quot;</span> 1&gt;&amp;2
    exit 0
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p><strong>3. Usage scenario: How to identify merge commit in jenkins pipeline?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/64080225" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ One simple way is : check if this commit has a second parent
if git rev-parse --verify -q $commitid^2 &gt; /dev/null; then
   echo <span class="token string">&quot;commit $commitid is a merge commit&quot;</span>
else
   echo <span class="token string">&quot;commit $commitid is a simple commit&quot;</span>
fi

▲ You can use that to find out if the current commit is the head of a pull request :
<span class="token comment"># fetch references starting with 'refs/pull/...',</span>
<span class="token comment"># store them locally next to the remote branches : 'refs/remotes/origin/pull/...'</span>
<span class="token comment">#   (note: you can choose whatever pattern you want to store these references locally)</span>
git fetch origin <span class="token string">&quot;+refs/pull/*:refs/remotes/origin/pull/*&quot;</span>

<span class="token comment"># check if one of these refs point to $commitid :</span>
git for-each-ref --points-at <span class="token string">&quot;$commitid&quot;</span> refs/remotes/orign/pull

<span class="token comment"># you can use '--format' to customize the output :</span>
<span class="token comment"># for example you can remove the leading 'refs/remotes/origin/pull' to have a shorter output :</span>
<span class="token command">$ git for-each-ref<span class="token parameter"> --format</span>=</span><span class="token string">&quot;%(refname:lstrip=4)&quot;</span> --points-at <span class="token string">&quot;$commitid&quot;</span> refs/remotes/orign/pull
42/head    # &lt;- this means it is the current head of PR #42

curl \
  -H <span class="token string">&quot;Accept: application/vnd.github.v3+json&quot;</span> \
  https://api.github.com/repos/{myuser}/{myrepo}/pulls/42
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>4. Usage scenario: How to bypass pre-commit hooks after fixing merge conflicts?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/61239779" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse -q --verify MERGE_HEAD &amp;&amp; false
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="quiet"><a href="#quiet" class="header-anchor">#</a> 🔹 --quiet</h2> <p><strong>1. Usage scenario: Merging without changing the working directory</strong></p> <blockquote><p><font size="2">💯Score: 8    🔗Associated commands: [ <a href="/./richen/git-commit-tree.html">git commit-tree</a>, <a href="/./richen/git-symbolic-ref.html">git symbolic-ref</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-merge-base.html">git merge-base</a> ]    🌐<a href="https://stackoverflow.com/questions/3409382" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/bash</span>

branch=master
<span class="token comment"># or take an argument:</span>
<span class="token comment"># if [ $@ eq 1 ];</span>
<span class="token comment">#      branch=&quot;$1&quot;;</span>
<span class="token comment"># fi</span>

<span class="token comment"># make sure the branch exists</span>
if ! git rev-parse --verify --quiet --heads <span class="token string">&quot;$branch&quot;</span> &gt; /dev/null; then
     echo <span class="token string">&quot;error: branch $branch does not exist&quot;</span>
     exit 1
fi

<span class="token comment"># make sure this could be a fast-forward   </span>
if [ <span class="token string">&quot;$(git merge-base HEAD $branch)&quot;</span> == <span class="token string">&quot;$(git rev-parse $branch)&quot;</span> ]; then
    # find the branch name associated with HEAD
    currentbranch=$(git symbolic-ref HEAD | sed <span class="token string">'s@.*/@@'</span>)
    # make the commit
    newcommit=$(echo <span class="token string">&quot;Merge branch '$currentbranch'&quot;</span> | git commit-tree $(git log -n 1 --pretty=%T HEAD) -p $branch -p HEAD)
    # move the branch to point to the new commit
    git update-ref -m <span class="token string">&quot;merge $currentbranch: Merge made by simulated no-ff&quot;</span> <span class="token string">&quot;refs/heads/$branch&quot;</span> $newcommit
else
    echo <span class="token string">&quot;error: merging $currentbranch into $branch would not be a fast-forward&quot;</span>
    exit 1
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><strong>2. Usage scenario: How to detect if a branch exists using git command?</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/31914717" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse --quiet --verify $REVISION

if git rev-parse --quiet --verify $REVISION &gt; /dev/null; then
    # whatever
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>3. Usage scenario: Check if my current branch on local fork exists on remote upstream</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/66698435" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ While git rev-parse is great for things that do work, there are things that don<span class="token string">'t work.  For instance, here is what happens if I try to rev-parse a name that doesn'</span>t exist:
<span class="token command">$ git rev-parse refs/remotes/upstream/foobranch</span>
refs/remotes/upstream/foobranch
fatal: ambiguous argument <span class="token string">'refs/remotes/upstream/foobranch'</span>: unknown revision or path not in the working tree.
Use <span class="token string">'--'</span> to separate paths from revisions, like this:
<span class="token string">'git &lt;command&gt; [&lt;revision&gt;...] -- [&lt;file&gt;...]'</span>

▲ If all works, we get this:
<span class="token command">$ git rev-parse refs/remotes/origin/master</span>
225365fb5195e804274ab569ac3cc4919451dc7f

$ result=`git rev-parse refs/remotes/origin/master`
$

$ result=`git rev-parse refs/remotes/upstream/foobranch`
fatal: ambiguous argument <span class="token string">'refs/remotes/upstream/foobranch'</span>: unknown revision or path not in the working tree.
Use <span class="token string">'--'</span> to separate paths from revisions, like this:
<span class="token string">'git &lt;command&gt; [&lt;revision&gt;...] -- [&lt;file&gt;...]'</span>

var=`cmd`

var=$(cmd)

var=`cmd1 `cmd2` -- `cmd3``

var=$(cmd1 $(cmd2) -- $(cmd3))

var=$(cmd) || {
    echo <span class="token string">&quot;unable to run the given command&quot;</span>
    exit 1
}

▲ for instance.  So with git rev-parse, if the upstream doesn't exist, we might want:
result=$(git rev-parse refs/remotes/upstream/$MY_BRANCH) || exit

<span class="token deleted">--quiet --verify</span>

MY_BRANCH=$(git rev-parse --abbrev-ref HEAD) || exit
hash=$(git rev-parse --quiet --verify refs/remotes/upstream/$MY_BRANCH) || {
    echo <span class="token string">&quot;upstream/$MY_BRANCH does not exist&quot;</span>
    exit 1
}
<span class="token comment"># do whatever you like with upstream/$MY_BRANCH here</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p><strong>4. Usage scenario: List branches not merged to their upstream</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-config.html">git config</a>, <a href="/./richen/git-diff.html">git diff</a> ]    🌐<a href="https://stackoverflow.com/questions/33946569" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Script
<span class="token comment">#!/bin/sh</span>

<span class="token comment"># git-bbu.sh</span>
<span class="token comment">#</span>
<span class="token comment"># List the local Branches Behind their Upstream branch, if any.</span>
<span class="token comment">#</span>
<span class="token comment"># Usage: git bbu</span>
<span class="token comment">#</span>
<span class="token comment"># To make a Git alias called 'bbu' out of this script,</span>
<span class="token comment"># put the latter on your search path, and run</span>
<span class="token comment">#</span>
<span class="token comment">#   git config --global alias.bbu \</span>
<span class="token comment">#       '!sh git-bbu.sh'</span>

if [ $# -ne 0 ]; then
    printf <span class="token string">&quot;%s\n\n&quot;</span> <span class="token string">&quot;usage: git bbu&quot;</span>
    exit 1
fi

git for-each-ref --format=<span class="token string">'%(refname:short)'</span> refs/heads | \
    while read ref; do
      if (git rev-parse --verify --quiet <span class="token string">&quot;$ref&quot;</span>@{upstream} &amp;&amp;
          ! git diff --quiet <span class="token string">&quot;$ref&quot;</span>...<span class="token string">&quot;$ref&quot;</span>@{upstream}) \
              &gt;/dev/null 2&gt;&amp;1; then
        printf <span class="token string">&quot;%s\n&quot;</span> <span class="token string">&quot;$ref&quot;</span>
      fi
    done

▲ Explanation
git for-each-ref --format=<span class="token string">'%(refname:short)'</span> refs/heads

▲ References
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="short"><a href="#short" class="header-anchor">#</a> 🔹 --short</h2> <p><strong>1. Usage scenario: How to retrieve the hash for the current commit in Git?</strong></p> <blockquote><p><font size="2">💯Score: 3319    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/949391" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse HEAD

git rev-parse --verify HEAD

git rev-parse --short HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>2. Usage scenario: Git command to display HEAD commit id?</strong></p> <blockquote><p><font size="2">💯Score: 556    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/1968001" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse HEAD

git rev-parse --short HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>3. Usage scenario: How to get the short sha for the github workflow?</strong></p> <blockquote><p><font size="2">💯Score: 37    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/59819441" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>      - name: Set outputs
        id: vars
        run: echo <span class="token string">&quot;::set-output name=sha_short::$(git rev-parse --short HEAD)&quot;</span>
      - name: Check outputs
        run: echo ${{ steps.vars.outputs.sha_short }}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>4. Usage scenario: How to increment docker tag automatically?</strong></p> <blockquote><p><font size="2">💯Score: 19    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/41098637" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>docker tag &lt;image&gt; &lt;image&gt;:$(git rev-parse --short HEAD)&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>5. Usage scenario: How do I find out which version I've got checked out in git?</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ <a href="/./richen/git-describe.html">git describe</a> ]    🌐<a href="https://stackoverflow.com/questions/9141541" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse HEAD

git rev-parse --short HEAD

git describe --long
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>6. Usage scenario: How can I create a Docker image based on a git tag in the public Registry?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/41098579" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>docker tag &lt;image&gt; &lt;image&gt;:$(git rev-parse --short HEAD)&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>7. Usage scenario: How to extract columns about current commit in git local and remote repos</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/49618817" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Name of current branch
git rev-parse --abbrev-ref HEAD

▲ Hash of currently checked out commit (branch)
git rev-parse HEAD          # full hash
git rev-parse --short HEAD  # short hash

▲ Remote tracking branch (upstream) of current branch
git rev-parse --abbrev-ref @{upstream}

▲ Commit message subject of currently checked out commit
git log -1 --format=<span class="token string">&quot;%s&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="not"><a href="#not" class="header-anchor">#</a> 🔹 --not</h2> <p><strong>1. Usage scenario: Find first ancestor commit in another branch</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a> ]    🌐<a href="https://stackoverflow.com/questions/13461275" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ To do this, take a look at the post-receive-email script that comes with your Git distribution (should be installed somewhere like /usr/share/doc/git-core/contrib/hooks/post-receive-email if you want a local copy). This has a long comment that describes how to find only commits that are new in a given branch, and haven't been seen in any others before:
    # Consider this:
    #   1 --- 2 --- O --- X --- 3 --- 4 --- N
    #
    # O is $oldrev for $refname
    # N is $newrev for $refname
    # X is a revision pointed to by some other ref, for which we may
    #   assume that an email has already been generated.
    # In this case we want to issue an email containing only revisions
    # 3, 4, and N.  Given (almost) by
    #
    #  git rev-list N ^O --not --all
    #
    # The reason for the <span class="token string">&quot;almost&quot;</span>, is that the <span class="token string">&quot;--not --all&quot;</span> will take
    # precedence over the <span class="token string">&quot;N&quot;</span>, and effectively will translate to
    #
    #  git rev-list N ^O ^X ^N
    #
    # So, we need to build up the list more carefully.  git rev-parse
    # will generate a list of revs that may be fed into git rev-list.
    # We can get it to make the <span class="token string">&quot;--not --all&quot;</span> part and then filter out
    # the <span class="token string">&quot;^N&quot;</span> with:
    #
    #  git rev-parse --not --all | grep -v N
    #
    # Then, using the --stdin switch to git rev-list we have effectively
    # manufactured
    #
    #  git rev-list N ^O ^X

▲ There are more details to handle corner cases in the comment, and the rest of the script; but if the basic case is all you care about, this should give you the answer:
git rev-parse --not --all | grep -v I | git rev-list --stdin I
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h2 id="abbrev-ref"><a href="#abbrev-ref" class="header-anchor">#</a> 🔹 --abbrev-ref</h2> <p><strong>1. Usage scenario: Show just the current branch in Git</strong></p> <blockquote><p><font size="2">💯Score: 754    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/1418022" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref HEAD</span>
master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>2. Usage scenario: Prevent commits in master branch</strong></p> <blockquote><p><font size="2">💯Score: 191    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/40465455" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>

branch=<span class="token string">&quot;$(git rev-parse --abbrev-ref HEAD)&quot;</span>

if [ <span class="token string">&quot;$branch&quot;</span> = <span class="token string">&quot;master&quot;</span> ]; then
  echo <span class="token string">&quot;You can't commit directly to master branch&quot;</span>
  exit 1
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>3. Usage scenario: How can I sync documentation with Github Pages?</strong></p> <blockquote><p><font size="2">💯Score: 37    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/16389663" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/bash</span>
<span class="token comment">###</span>
<span class="token comment">### The following block runs after commit to &quot;master&quot; branch</span>
<span class="token comment">###</span>
if [ `git rev-parse --abbrev-ref HEAD` == <span class="token string">&quot;master&quot;</span> ]; then

    # Layout prefix is prepended to each markdown file synced
    ###################################################################
    LAYOUT_PREFIX=<span class="token string">'---\r\nlayout: index\r\n---\r\n\r\n'</span>

    # Switch to gh-pages branch to sync it with master
    ###################################################################
    git checkout gh-pages

    # Sync the README.md in master to index.md adding jekyll header
    ###################################################################
    git checkout master -- README.md
    echo -e $LAYOUT_PREFIX &gt; index.md
    cat README.md &gt;&gt; index.md
    rm README.md
    git add index.md
    git commit -a -m <span class="token string">&quot;Sync README.md in master branch to index.md in gh-pages&quot;</span>

    # Sync the markdown files in the docs/* directory
    ###################################################################
    git checkout master -- docs
    FILES=docs/*
    for file in $FILES
    do
        echo -e $LAYOUT_PREFIX | cat - <span class="token string">&quot;$file&quot;</span> &gt; temp &amp;&amp; mv temp <span class="token string">&quot;$file&quot;</span>
    done

    git add docs
    git commit -a -m <span class="token string">&quot;Sync docs from master branch to docs gh-pages directory&quot;</span>

    # Uncomment the following push if you want to auto push to
    # the gh-pages branch whenever you commit to master locally.
    # This is a little extreme. Use with care!
    ###################################################################
    # git push origin gh-pages

    # Finally, switch back to the master branch and exit block
    git checkout master
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p><strong>4. Usage scenario: Git commit hooks per branch</strong></p> <blockquote><p><font size="2">💯Score: 37    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/6376054" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>if [ `git rev-parse --abbrev-ref HEAD` == <span class="token string">&quot;development&quot;</span> ]; then
   echo <span class="token string">&quot;development-script&quot;</span>
elif [ `git rev-parse --abbrev-ref HEAD` == <span class="token string">&quot;staging&quot;</span> ]; then
   echo <span class="token string">&quot;staging-script&quot;</span>
elif [ `git rev-parse --abbrev-ref HEAD` == <span class="token string">&quot;production&quot;</span> ]; then
   echo <span class="token string">&quot;production-script&quot;</span>
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>5. Usage scenario: How to find the last branch checked out in git</strong></p> <blockquote><p><font size="2">💯Score: 13    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/40291733" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git rev-parse<span class="token parameter"> --symbolic</span>-full-name @{-1}</span>
refs/heads/stash-exp
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref @{-1}</span>
stash-exp

<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref @{-2} &amp;&amp; echo ok || echo fail</span>
master
ok
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref @{-3} &amp;&amp; echo ok || echo fail</span>
ok
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>6. Usage scenario: Avoiding merge conflicts when merging master into per-host customized branch</strong></p> <blockquote><p><font size="2">💯Score: 9    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/39762768" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>
branch=$(git rev-parse --symbolic --abbrev-ref HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>7. Usage scenario: Git: how to check out the currently pushed branch in the pre-push hook?</strong></p> <blockquote><p><font size="2">💯Score: 8    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/20047273" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>Information about what is to be pushed is provided on the hook's standard input
with lines of the form:

   &lt;local ref&gt; SP &lt;local sha1&gt; SP &lt;remote ref&gt; SP &lt;remote sha1&gt; LF

For instance, if the command git push origin master:foreign were run the hook would
receive a line like the following:

   refs/heads/master 67890 refs/heads/foreign 12345

although the full, 40-character SHA-1s would be supplied.

<span class="token comment">#!/bin/sh</span>

z40=0000000000000000000000000000000000000000

IFS=<span class="token string">' '</span>
while read local_ref local_sha remote_ref remote_sha
do
    current_sha1=$(git rev-parse HEAD)
    current_branch=$(git rev-parse --abbrev-ref HEAD)
    if [ <span class="token string">&quot;$local_sha&quot;</span> != $z40 ] &amp;&amp; [ <span class="token string">&quot;$local_sha&quot;</span> != <span class="token string">&quot;$current_sha1&quot;</span> ]; then
        git checkout $local_sha

        # do unit testing...

        git checkout $current_branch
    fi
done

exit 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p><strong>8. Usage scenario: find active git branch of all 1st level subdirectories under a directory</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/49282554" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>for i in */; do \
     (cd $i &amp;&amp; echo -n <span class="token string">&quot;${i}: &quot;</span> &amp;&amp; git rev-parse --abbrev-ref HEAD); \
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>9. Usage scenario: Turning a git branch name into a valid docker image tag</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/62906041" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>docker build . -t image_name:$(git rev-parse --abbrev-ref HEAD | sed <span class="token string">'s/[^a-zA-Z0-9]/-/g'</span>) 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>10. Usage scenario: How to prevent direct commits to master branch using husky?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/64060996" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>

branch=<span class="token string">&quot;$(git rev-parse --abbrev-ref HEAD)&quot;</span>

if [ <span class="token string">&quot;$branch&quot;</span> = <span class="token string">&quot;master&quot;</span> ]; then
  echo <span class="token string">&quot;You can't commit directly to master branch&quot;</span>
  exit 1
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>11. Usage scenario: How to push a file to past time?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/24722927" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/bash</span>
<span class="token comment"># commit</span>
<span class="token comment"># date YYYY-mm-dd HH:MM:SS</span>

commit=<span class="token string">&quot;$1&quot;</span> datecal=<span class="token string">&quot;$2&quot;</span>
temp_branch=<span class="token string">&quot;temp-rebasing-branch&quot;</span>
current_branch=<span class="token string">&quot;$(git rev-parse --abbrev-ref HEAD)&quot;</span>

date_timestamp=$(date -d <span class="token string">&quot;$datecal&quot;</span> +%s)
date_r=$(date -R -d <span class="token string">&quot;$datecal&quot;</span>)
echo <span class="token string">&quot;datecal=$datecal =&gt; date_timestamp=$date_timestamp date_r=$date_r&quot;</span>

if [[ -z <span class="token string">&quot;$commit&quot;</span> ]]; then
    exit 0
fi

git checkout -b <span class="token string">&quot;$temp_branch&quot;</span> <span class="token string">&quot;$commit&quot;</span>
GIT_COMMITTER_DATE=<span class="token string">&quot;$date_timestamp&quot;</span> GIT_AUTHOR_DATE=<span class="token string">&quot;$date_timestamp&quot;</span> git commit --amend --no-edit --date <span class="token string">&quot;$date_r&quot;</span>
git checkout <span class="token string">&quot;$current_branch&quot;</span>
git rebase --autostash --committer-date-is-author-date <span class="token string">&quot;$commit&quot;</span> --onto <span class="token string">&quot;$temp_branch&quot;</span>
git branch -d <span class="token string">&quot;$temp_branch&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><strong>12. Usage scenario: How to update a file across all branches in a Git repository</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-ls-files.html">git ls-files</a> ]    🌐<a href="https://stackoverflow.com/questions/45075092" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/bash</span>

if [ $# != 1 ]; then
    echo <span class="token string">&quot;usage: $0 &lt;filename&gt;&quot;</span>
    exit;
fi

branches=`git for-each-ref --format=<span class="token string">'%(refname:short)'</span> refs/heads/\*`
curr_branch=`git rev-parse --abbrev-ref HEAD`
<span class="token comment"># echo &quot;curr_branch:&quot;$curr_branch</span>

filename=$1
file_in_repo=`git ls-files ${filename}`

if [ ! <span class="token string">&quot;$file_in_repo&quot;</span> ]; then
    echo <span class="token string">&quot;file not added in current branch&quot;</span>
    exit
fi

for branch in ${branches[@]}; do
    if [[ ${branch} != ${curr_branch} ]]; then
        git checkout <span class="token string">&quot;${branch}&quot;</span>
        git checkout <span class="token string">&quot;${curr_branch}&quot;</span> -- <span class="token string">&quot;$filename&quot;</span>
        git commit -am <span class="token string">&quot;Added $filename in $branch from $curr_branch&quot;</span>
        echo <span class="token string">&quot;&quot;</span>
    fi
done
git checkout <span class="token string">&quot;${curr_branch}&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><strong>13. Usage scenario: how to check a local branch tracking which remote branch?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/8831204" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git checkout test_branch</span>
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref<span class="token parameter"> --symbolic</span>-full-name @{u}</span>
origin/remote_project001
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>14. Usage scenario: How to make jenkins build status badge dynamically show the branch of the its file is in</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/65493847" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>branch=$(git rev-parse --symbolic --abbrev-ref HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>15. Usage scenario: GIT merge -keep specific parts of one branch and everything else of the other</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/48449663" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>branch=$(git rev-parse --symbolic --abbrev-ref HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>16. Usage scenario: Prepend partial branch name to commit message</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/67581619" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment"># get the current branch name</span>
git_branch_command = <span class="token string">&quot;git rev-parse --abbrev-ref HEAD&quot;</span>
branch_name, error, result = Open3.capture3(git_branch_command)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>17. Usage scenario: Convert full GIT ref to unambiguous short ref</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-for-each-ref.html">git for-each-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/49054947" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git for-each-ref refs --format=<span class="token string">'%(refname)'</span> | xargs git rev-parse --abbrev-ref
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>18. Usage scenario: How to get the full path of a file in a Git remote repo</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-config.html">git config</a> ]    🌐<a href="https://stackoverflow.com/questions/47526678" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>is_git=false
relative_to_git=<span class="token string">&quot;&quot;</span>
check=<span class="token string">&quot;&quot;</span>
initial=$(pwd)
current_dir=<span class="token string">&quot;&quot;</span>
count=0

if [ ! $(git rev-parse --is-inside-work-tree 2&gt; /dev/null) ]; then
  echo <span class="token string">&quot;NOT INSIDE A VALID GIT REPOSITORY&quot;</span>
  return
fi

git_remote=$(git config --get remote.origin.url)
git_remote=${git_remote%.git}
git_branch=$(git rev-parse --abbrev-ref HEAD)

while [ $is_git=true ]
do
  if [ -d <span class="token string">&quot;.git&quot;</span> ]; then
    break
  fi
  current_dir=${PWD##*/}
  relative_to_git=<span class="token string">&quot;$current_dir/$relative_to_git&quot;</span>
  cd ../
done

<span class="token comment"># echo &quot;$git_remote/+/$git_branch/$relative_to_git&quot;</span>
<span class="token comment"># For andoid.googlesource.com uncomment the above and comment the below lines</span>
echo <span class="token string">&quot;$git_remote/tree/$git_branch/$relative_to_git&quot;</span>

cd $initial
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p><strong>19. Usage scenario: Getting commit history from multiple repositories for some period</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/51412293" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>curl -s <span class="token string">&quot;https://api.github.com/search/repositories?q=org%3Agoogle%20test&amp;per_page=100&quot;</span> | \
    jq -r <span class="token string">'.items[] | select(.name | startswith(&quot;test&quot;)) | .clone_url'</span> | \
    xargs -I{} git clone {}

for d in */; 
do 
    ( cd $d &amp;&amp; \
      echo <span class="token string">&quot;repo ${d::-1}&quot;</span> &amp;&amp; \
      echo <span class="token string">&quot;branch $(git rev-parse --abbrev-ref HEAD)&quot;</span> &amp;&amp; \
      git --no-pager log --oneline --before 2018-07-1 --after 2012-06-10; )
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>20. Usage scenario: How can I view the pull request URL for the current branch?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/49198073" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>@echo off

setlocal 
for /f <span class="token string">&quot;tokens=*&quot;</span> %%a in ( 
    <span class="token string">'git rev-parse --abbrev-ref HEAD'</span>
) do ( 
    set branch=%%a
    set url=https://bitbucket.org/my-company/repo/pull-requests/new?source=%%a^^^&amp;t=1
) 

echo %url%
endlocal 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>21. Usage scenario: Merge upstream without specifying branch name</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/29598752" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse --symbolic-full-name --abbrev-ref @{u}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>22. Usage scenario: Formal notation for Git (repository, branch, commit) tuple</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-branch.html">git branch</a> ]    🌐<a href="https://stackoverflow.com/questions/48738861" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git branch --contains &lt;commit&gt;

git rev-parse --abbrev-ref &lt;branch&gt;@{upstream}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>23. Usage scenario: How to get ALL hashes that are being committed in a pre-receive hook?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a> ]    🌐<a href="https://stackoverflow.com/questions/39006825" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>chomp(my @commits = `git rev-list $old..$new`);
if ($?) {
  warn <span class="token string">&quot;git rev-list $old..$new failed\n&quot;</span>;
  ++$errors, next;
}

foreach my $sha1 (@commits) {
  // validate some policy
}

<span class="token comment">#!/bin/bash</span>
while read oldrev newrev refname
do
    branch=$(git rev-parse --symbolic --abbrev-ref $refname)
    if [ <span class="token string">&quot;master&quot;</span> == <span class="token string">&quot;$branch&quot;</span> ]; then
        # Do something
    fi
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>24. Usage scenario: Check if my current branch on local fork exists on remote upstream</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/66698435" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ While git rev-parse is great for things that do work, there are things that don<span class="token string">'t work.  For instance, here is what happens if I try to rev-parse a name that doesn'</span>t exist:
<span class="token command">$ git rev-parse refs/remotes/upstream/foobranch</span>
refs/remotes/upstream/foobranch
fatal: ambiguous argument <span class="token string">'refs/remotes/upstream/foobranch'</span>: unknown revision or path not in the working tree.
Use <span class="token string">'--'</span> to separate paths from revisions, like this:
<span class="token string">'git &lt;command&gt; [&lt;revision&gt;...] -- [&lt;file&gt;...]'</span>

▲ If all works, we get this:
<span class="token command">$ git rev-parse refs/remotes/origin/master</span>
225365fb5195e804274ab569ac3cc4919451dc7f

$ result=`git rev-parse refs/remotes/origin/master`
$

$ result=`git rev-parse refs/remotes/upstream/foobranch`
fatal: ambiguous argument <span class="token string">'refs/remotes/upstream/foobranch'</span>: unknown revision or path not in the working tree.
Use <span class="token string">'--'</span> to separate paths from revisions, like this:
<span class="token string">'git &lt;command&gt; [&lt;revision&gt;...] -- [&lt;file&gt;...]'</span>

var=`cmd`

var=$(cmd)

var=`cmd1 `cmd2` -- `cmd3``

var=$(cmd1 $(cmd2) -- $(cmd3))

var=$(cmd) || {
    echo <span class="token string">&quot;unable to run the given command&quot;</span>
    exit 1
}

▲ for instance.  So with git rev-parse, if the upstream doesn't exist, we might want:
result=$(git rev-parse refs/remotes/upstream/$MY_BRANCH) || exit

<span class="token deleted">--quiet --verify</span>

MY_BRANCH=$(git rev-parse --abbrev-ref HEAD) || exit
hash=$(git rev-parse --quiet --verify refs/remotes/upstream/$MY_BRANCH) || {
    echo <span class="token string">&quot;upstream/$MY_BRANCH does not exist&quot;</span>
    exit 1
}
<span class="token comment"># do whatever you like with upstream/$MY_BRANCH here</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p><strong>25. Usage scenario: How do I prevent git push-to-deploy from creating &quot;refs&quot; folder above working tree?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/36685964" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>    branch=$(git rev-parse --symbolic --abbrev-ref $refname)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>26. Usage scenario: Github - Cleaning up branches after they're merged as part of a pull request</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-push.html">git push</a>, <a href="/./richen/git-show-ref.html">git show-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/55864954" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git branch -d &lt;branch-name&gt;
git push origin :&lt;branch-name&gt;

<span class="token comment">#!/bin/sh</span>

<span class="token comment">#---------------------------------</span>
<span class="token comment"># Delete branch merged into master</span>
<span class="token comment">#---------------------------------</span>

<span class="token comment"># Define your master branch name</span>
master=<span class="token string">&quot;master&quot;</span>

currentBranch=$(git branch | grep \* | cut -d <span class="token string">' '</span> -f2)

if [ $currentBranch = $master ]; then
    branchToDelete=$(git rev-parse --abbrev-ref $(git show-ref | grep $(git rev-parse HEAD^2)| cut -d <span class="token string">' '</span> -f 2))
    if [ $branchToDelete != <span class="token string">&quot;&quot;</span> ]; then
        git branch -d $branchToDelete
        git push origin :$branchToDelete
    fi 
fi
exit 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><strong>27. Usage scenario: How to extract columns about current commit in git local and remote repos</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/49618817" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Name of current branch
git rev-parse --abbrev-ref HEAD

▲ Hash of currently checked out commit (branch)
git rev-parse HEAD          # full hash
git rev-parse --short HEAD  # short hash

▲ Remote tracking branch (upstream) of current branch
git rev-parse --abbrev-ref @{upstream}

▲ Commit message subject of currently checked out commit
git log -1 --format=<span class="token string">&quot;%s&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>28. Usage scenario: How to auto include the newest git commit metadata into the commited files?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-config.html">git config</a>, <a href="/./richen/git-ls-files.html">git ls-files</a> ]    🌐<a href="https://stackoverflow.com/questions/62813028" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>%% ------------------------------------------------  
%  
% Created on:       &lt;date_of_creation&gt;  
% Author:           &lt;author&gt;  
%  
% Last modifier:    &lt;modifier&gt;  
% Last modified:    &lt;date_of_last_mod&gt;  
% On Branch:        &lt;branch&gt;  
%  
%%-------------------------------------------------

▲ insert_changelog.sh:
<span class="token comment">#!/bin/bash</span>

<span class="token comment">#If there are no .m files for which this would apply, suppress the this notification (If i get that right)</span>
shopt -s nullglob

<span class="token comment">#Act on untracked files </span>
files=($(git ls-files --others --exclude-standard))
for item in ${files[*]}
do
    #For time being, only consider matlab files
    if [[ $item == *.m ]]
    then
        #Check whether the header already exists
        read -r first_line &lt; $item 
        first_cl_line=<span class="token string">&quot;%% ------------------------------------------------&quot;</span>
        if [ <span class="token string">&quot;$first_line&quot;</span> = <span class="token string">&quot;$first_cl_line&quot;</span> ]
        then
            continue
        else
            #Include Changelog into file
            cat changelog_template.txt &gt; tempfile
            cat $item &gt;&gt; tempfile 
            mv tempfile $item

            #Fill in static fields of inception date and author
            sed -i <span class="token string">&quot;3,4d&quot;</span> $item
            sed -i <span class="token string">&quot;2 a % Created on:       $(date)&quot;</span> $item
            sed -i <span class="token string">&quot;3 a % Author:           $(git config user.name)&quot;</span> $item

            #Update current changelog
            ./update_changelog.sh $item
        fi
    fi
done;

▲ update_changelog.sh:
<span class="token comment">#!/bin/bash</span>
USER=$(git config user.name)  
BRANCH=$(git rev-parse --abbrev-ref HEAD)  
<span class="token comment">#Remove outdated lines and replace with updated ones.  </span>
   for item in $(git ls-files -m)  
   do  
       sed -i <span class="token string">&quot;5,8d&quot;</span> $item  
       sed -i <span class="token string">&quot;5 a % Last Modifier:    $USER&quot;</span> $item  
       sed -i <span class="token string">&quot;6 a % Last Modified:    $(date)&quot;</span> $item  
       sed -i <span class="token string">&quot;7 a % On Branch:        $BRANCH&quot;</span> $item  
       sed -i <span class="token string">&quot;8 a %&quot;</span> $item  
   done;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p><strong>29. Usage scenario: Finding un-pushed commits on current branch through a function</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-diff.html">git diff</a> ]    🌐<a href="https://stackoverflow.com/questions/64175175" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>notpushed = <span class="token string">&quot;!f() { branch=$(git rev-parse --abbrev-ref HEAD); git diff --stat --cached origin/$branch; }; f&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>30. Usage scenario: apply hook for a specific branch in Git</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/36131730" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>

current_branch=$(git rev-parse --abbrev-ref --symbolic-full-name HEAD)
if [ <span class="token string">&quot;$current_branch&quot;</span> != <span class="token string">&quot;my_branch&quot;</span> ]; then
  echo <span class="token string">&quot;wrong branch&quot;</span>
  exit
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>31. Usage scenario: Remove files and code in dev branch only but keep them in master when merging</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/48037148" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>
branch=$(git rev-parse --symbolic --abbrev-ref HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>32. Usage scenario: Getting git pull request number from git hash?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/62009399" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>$ hub pr list -f <span class="token string">&quot;%I%n&quot;</span> -h <span class="token string">&quot;$(git rev-parse --abbrev-ref HEAD)&quot;</span>
12345
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>33. Usage scenario: How to prevent developers to push on a particular branch?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/36909229" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/bash</span>
locked_branch=<span class="token string">'feature/foo'</span>
push_branch=$(git rev-parse --abbrev-ref HEAD)

if [ <span class="token string">&quot;$locked_branch&quot;</span> = <span class="token string">&quot;$push_branch&quot;</span> ]
then
    echo <span class="token string">&quot;Do not push this branch! Use feature/bar instead&quot;</span>
    exit 1
fi
exit 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>34. Usage scenario: Ignore files when merging branches</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/41945090" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>branch=$(git rev-parse --symbolic --abbrev-ref HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="symbolic"><a href="#symbolic" class="header-anchor">#</a> 🔹 --symbolic</h2> <p><strong>1. Usage scenario: command to determine the upstream ref of the current HEAD?</strong></p> <blockquote><p><font size="2">💯Score: 15    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/15284176" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse --symbolic-full-name @{u}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>2. Usage scenario: How to find the last branch checked out in git</strong></p> <blockquote><p><font size="2">💯Score: 13    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/40291733" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git rev-parse<span class="token parameter"> --symbolic</span>-full-name @{-1}</span>
refs/heads/stash-exp
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref @{-1}</span>
stash-exp

<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref @{-2} &amp;&amp; echo ok || echo fail</span>
master
ok
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref @{-3} &amp;&amp; echo ok || echo fail</span>
ok
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>3. Usage scenario: How read the current upstream for a git branch</strong></p> <blockquote><p><font size="2">💯Score: 11    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-config.html">git config</a>, <a href="/./richen/git-symbolic-ref.html">git symbolic-ref</a>, <a href="/./richen/git-status.html">git status</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/46516201" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ TL;DR: use git rev-parse
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref master@{u}</span>
weird/master

fatal: no upstream configured for branch <span class="token string">'master'</span>

if master_upstream=$(git rev-parse --abbrev-ref master@{u} 2&gt;/dev/null); then
    master_has_upstream=true
else
    master_has_upstream=false
fi

▲ Explanation
<span class="token command">$ git init</span>
Initialized empty Git repository in .../tmp/tt/.git/
<span class="token command">$ git remote add origin git://github.com/git/git</span>
<span class="token command">$ git config remote.origin.fetch </span><span class="token string">'+refs/heads/*:refs/remotes/weird/*'</span>
<span class="token command">$ git fetch</span>
remote: Counting objects: 231294, done.
remote: Compressing objects: 100% (663/663), done.
remote: Total 231294 (delta 0), reused 662 (delta 0), pack-reused 230631
Receiving objects: 100% (231294/231294), 93.03 MiB | 3.54 MiB/s, done.
Resolving deltas: 100% (170261/170261), done.
From git://github.com/git/git
 * [new branch]          maint      -&gt; weird/maint
 * [new branch]          master     -&gt; weird/master
 * [new branch]          next       -&gt; weird/next
 * [new branch]          pu         -&gt; weird/pu
 * [new branch]          todo       -&gt; weird/todo
 * [new tag]             v2.14.2    -&gt; v2.14.2
[lots more tags snipped]

<span class="token command">$ git checkout master</span>
Branch master set up to track remote branch master from origin.
Already on <span class="token string">'master'</span>
<span class="token command">$ git status</span>
On branch master
Your branch is up-to-date with <span class="token string">'weird/master'</span>.

nothing to commit, working tree clean

[branch <span class="token string">&quot;master&quot;</span>]
    remote = origin
    merge = refs/heads/master

 branch=<span class="token string">&quot;$(git branch | grep '\*' | cut -d' ' -f2-)&quot;</span>

remote=<span class="token string">&quot;$(git config &quot;</span>branch.${branch}.remote<span class="token string">&quot;)&quot;</span>

remote_branch=<span class="token string">&quot;$(git config &quot;</span>branch.${branch}.merge<span class="token string">&quot; | cut -d/ -f3-)&quot;</span>

<span class="token command">$ git rev-parse<span class="token parameter"> --symbolic</span>-full-name master@{u}</span>
refs/remotes/weird/master

<span class="token command">$ git checkout<span class="token parameter"> --detach</span></span>
HEAD is now at ea220ee40... The eleventh batch for 2.15
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref HEAD</span>
HEAD
<span class="token command">$ git rev-parse<span class="token parameter"> --symbolic</span>-full-name HEAD</span>
HEAD
<span class="token command">$ git symbolic-ref HEAD</span>
fatal: ref HEAD is not a symbolic ref
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><p><strong>4. Usage scenario: Avoiding merge conflicts when merging master into per-host customized branch</strong></p> <blockquote><p><font size="2">💯Score: 9    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/39762768" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>
branch=$(git rev-parse --symbolic --abbrev-ref HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>5. Usage scenario: how to check a local branch tracking which remote branch?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/8831204" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git checkout test_branch</span>
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref<span class="token parameter"> --symbolic</span>-full-name @{u}</span>
origin/remote_project001
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>6. Usage scenario: How do Git's @{upstream} and @{push} differ?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-switch.html">git switch</a>, <a href="/./richen/git-config.html">git config</a> ]    🌐<a href="https://stackoverflow.com/questions/59970785" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git config push.default current</span>
<span class="token command">$ git config remote.pushdefault myfork</span>
<span class="token command">$ git switch<span class="token parameter"> -c</span> mybranch origin/master</span>

<span class="token command">$ git rev-parse<span class="token parameter"> --symbolic</span>-full-name @{upstream}</span>
refs/remotes/origin/master

<span class="token command">$ git rev-parse<span class="token parameter"> --symbolic</span>-full-name @{push}</span>
refs/remotes/myfork/mybranch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>7. Usage scenario: How to make jenkins build status badge dynamically show the branch of the its file is in</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/65493847" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>branch=$(git rev-parse --symbolic --abbrev-ref HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>8. Usage scenario: GIT merge -keep specific parts of one branch and everything else of the other</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/48449663" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>branch=$(git rev-parse --symbolic --abbrev-ref HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>9. Usage scenario: Temporarily clearing untracked files before commit in Git</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-checkout-index.html">git checkout-index</a>, <a href="/./richen/git-diff-index.html">git diff-index</a> ]    🌐<a href="https://stackoverflow.com/questions/4108042" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>
<span class="token comment">#</span>
<span class="token comment"># Via: http://github.com/jwiegley/git-scripts/blob/master/pre-commit.sh</span>
<span class="token comment">#</span>

if [ ! $(git rev-parse --symbolic-full-name HEAD) = refs/heads/master ]; then
    exit 0
fi

<span class="token comment"># These are the locations I keep my temporary source and build trees in</span>
TMPDIR=$HOME/code/myproject-pre-commit
MIRROR=$HOME/code/myproject-pre-commit-mirror

<span class="token comment"># Exit with status 1 if any command below fails</span>
set -e

<span class="token comment"># Checkout a copy of the current index into MIRROR</span>
git checkout-index --prefix=$MIRROR/ -af

<span class="token comment"># Remove files from MIRROR which are no longer present in the index</span>
git diff-index --cached --name-only --diff-filter=D -z HEAD | \
    (cd $MIRROR &amp;&amp; xargs -0 rm -f --)

<span class="token comment"># Copy only _changed files_ from MIRROR to TMPDIR, without copying timestamps.</span>
<span class="token comment"># This includes copying over new files, and deleting removed ones.  This way,</span>
<span class="token comment"># &quot;make check&quot; will only rebuild what is necessary to validate the commit.</span>
rsync -rlpgoDOc --delete --exclude-from=.git-hooks/excludes $MIRROR/ $TMPDIR/

<span class="token comment"># Everything else happens in the temporary build tree</span>
cd $TMPDIR

nosetests

exit 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><strong>10. Usage scenario: How do I tell on GIT whether a reference is a branch or a tag?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/21610463" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse --symbolic-full-name v1.9-rc2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>11. Usage scenario: Git: want to know whether a given string refers to a commit-ish or a (possibly remote) branch</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/62340432" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>fullspell=`git rev-parse --symbolic-full-name $specifier --`

if fullspell=`git rev-parse --symbolic-full-name $specifier --`; then
case $fullspell in
refs/heads/* | refs/remotes/*)
        # it's a remote-tracking branch or a local branch
        ;;
?*)
        # it<span class="token string">'s something else, but it'</span>s a legit refname
        ;;
*)
        # there<span class="token string">'s no full spelling but the command succeeded. It'</span>s not a bare refname,
        # but it does resolve to something (so e.g. master~3 would get here)
        ;;
esac
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>12. Usage scenario: Merge upstream without specifying branch name</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/29598752" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse --symbolic-full-name --abbrev-ref @{u}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>13. Usage scenario: how to maintain a production and development branches in git?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/67898483" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>branch=$(git rev-parse --symbolic --abbrev-ref HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>14. Usage scenario: How to get ALL hashes that are being committed in a pre-receive hook?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a> ]    🌐<a href="https://stackoverflow.com/questions/39006825" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>chomp(my @commits = `git rev-list $old..$new`);
if ($?) {
  warn <span class="token string">&quot;git rev-list $old..$new failed\n&quot;</span>;
  ++$errors, next;
}

foreach my $sha1 (@commits) {
  // validate some policy
}

<span class="token comment">#!/bin/bash</span>
while read oldrev newrev refname
do
    branch=$(git rev-parse --symbolic --abbrev-ref $refname)
    if [ <span class="token string">&quot;master&quot;</span> == <span class="token string">&quot;$branch&quot;</span> ]; then
        # Do something
    fi
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>15. Usage scenario: How do I prevent git push-to-deploy from creating &quot;refs&quot; folder above working tree?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/36685964" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>    branch=$(git rev-parse --symbolic --abbrev-ref $refname)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>16. Usage scenario: How to make git merge's default --no-ff only for remotes?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/21666573" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ The simplest test is to run git rev-parse --symbolic-full-name on it.  If the resulting name starts with refs/remotes/, the name is symbolic and names a remote branch:
name_is_remote_branch() {
    local full

    full=$(git rev-parse --symbolic-full-name $1)
    case $full in
    refs/remotes/*) return 0;;
    *) return 1;;
    esac
}

if name_is_remote_branch origin/master; then
    echo seems to work
else
    echo oops
fi

name_is_remote_branch master || echo ok # master should not be <span class="token string">&quot;remote branch&quot;</span>

▲ What happens if we apply this test to a raw SHA-1 ID?
<span class="token command">$ git log<span class="token parameter"> -1</span><span class="token parameter"> --decorate</span><span class="token parameter"> --oneline</span></span>
676699a (origin/master, master) commit subject here
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><strong>17. Usage scenario: apply hook for a specific branch in Git</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/36131730" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>

current_branch=$(git rev-parse --abbrev-ref --symbolic-full-name HEAD)
if [ <span class="token string">&quot;$current_branch&quot;</span> != <span class="token string">&quot;my_branch&quot;</span> ]; then
  echo <span class="token string">&quot;wrong branch&quot;</span>
  exit
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>18. Usage scenario: Remove files and code in dev branch only but keep them in master when merging</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/48037148" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>
branch=$(git rev-parse --symbolic --abbrev-ref HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>19. Usage scenario: Ignore files when merging branches</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/41945090" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>branch=$(git rev-parse --symbolic --abbrev-ref HEAD)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="symbolic-full-name"><a href="#symbolic-full-name" class="header-anchor">#</a> 🔹 --symbolic-full-name</h2> <p><strong>1. Usage scenario: command to determine the upstream ref of the current HEAD?</strong></p> <blockquote><p><font size="2">💯Score: 15    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/15284176" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse --symbolic-full-name @{u}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>2. Usage scenario: How to find the last branch checked out in git</strong></p> <blockquote><p><font size="2">💯Score: 13    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/40291733" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git rev-parse<span class="token parameter"> --symbolic</span>-full-name @{-1}</span>
refs/heads/stash-exp
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref @{-1}</span>
stash-exp

<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref @{-2} &amp;&amp; echo ok || echo fail</span>
master
ok
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref @{-3} &amp;&amp; echo ok || echo fail</span>
ok
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>3. Usage scenario: How read the current upstream for a git branch</strong></p> <blockquote><p><font size="2">💯Score: 11    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-config.html">git config</a>, <a href="/./richen/git-symbolic-ref.html">git symbolic-ref</a>, <a href="/./richen/git-status.html">git status</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/46516201" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ TL;DR: use git rev-parse
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref master@{u}</span>
weird/master

fatal: no upstream configured for branch <span class="token string">'master'</span>

if master_upstream=$(git rev-parse --abbrev-ref master@{u} 2&gt;/dev/null); then
    master_has_upstream=true
else
    master_has_upstream=false
fi

▲ Explanation
<span class="token command">$ git init</span>
Initialized empty Git repository in .../tmp/tt/.git/
<span class="token command">$ git remote add origin git://github.com/git/git</span>
<span class="token command">$ git config remote.origin.fetch </span><span class="token string">'+refs/heads/*:refs/remotes/weird/*'</span>
<span class="token command">$ git fetch</span>
remote: Counting objects: 231294, done.
remote: Compressing objects: 100% (663/663), done.
remote: Total 231294 (delta 0), reused 662 (delta 0), pack-reused 230631
Receiving objects: 100% (231294/231294), 93.03 MiB | 3.54 MiB/s, done.
Resolving deltas: 100% (170261/170261), done.
From git://github.com/git/git
 * [new branch]          maint      -&gt; weird/maint
 * [new branch]          master     -&gt; weird/master
 * [new branch]          next       -&gt; weird/next
 * [new branch]          pu         -&gt; weird/pu
 * [new branch]          todo       -&gt; weird/todo
 * [new tag]             v2.14.2    -&gt; v2.14.2
[lots more tags snipped]

<span class="token command">$ git checkout master</span>
Branch master set up to track remote branch master from origin.
Already on <span class="token string">'master'</span>
<span class="token command">$ git status</span>
On branch master
Your branch is up-to-date with <span class="token string">'weird/master'</span>.

nothing to commit, working tree clean

[branch <span class="token string">&quot;master&quot;</span>]
    remote = origin
    merge = refs/heads/master

 branch=<span class="token string">&quot;$(git branch | grep '\*' | cut -d' ' -f2-)&quot;</span>

remote=<span class="token string">&quot;$(git config &quot;</span>branch.${branch}.remote<span class="token string">&quot;)&quot;</span>

remote_branch=<span class="token string">&quot;$(git config &quot;</span>branch.${branch}.merge<span class="token string">&quot; | cut -d/ -f3-)&quot;</span>

<span class="token command">$ git rev-parse<span class="token parameter"> --symbolic</span>-full-name master@{u}</span>
refs/remotes/weird/master

<span class="token command">$ git checkout<span class="token parameter"> --detach</span></span>
HEAD is now at ea220ee40... The eleventh batch for 2.15
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref HEAD</span>
HEAD
<span class="token command">$ git rev-parse<span class="token parameter"> --symbolic</span>-full-name HEAD</span>
HEAD
<span class="token command">$ git symbolic-ref HEAD</span>
fatal: ref HEAD is not a symbolic ref
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><p><strong>4. Usage scenario: How do Git's @{upstream} and @{push} differ?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-switch.html">git switch</a>, <a href="/./richen/git-config.html">git config</a> ]    🌐<a href="https://stackoverflow.com/questions/59970785" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git config push.default current</span>
<span class="token command">$ git config remote.pushdefault myfork</span>
<span class="token command">$ git switch<span class="token parameter"> -c</span> mybranch origin/master</span>

<span class="token command">$ git rev-parse<span class="token parameter"> --symbolic</span>-full-name @{upstream}</span>
refs/remotes/origin/master

<span class="token command">$ git rev-parse<span class="token parameter"> --symbolic</span>-full-name @{push}</span>
refs/remotes/myfork/mybranch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>5. Usage scenario: how to check a local branch tracking which remote branch?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/8831204" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git checkout test_branch</span>
<span class="token command">$ git rev-parse<span class="token parameter"> --abbrev</span>-ref<span class="token parameter"> --symbolic</span>-full-name @{u}</span>
origin/remote_project001
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>6. Usage scenario: Git: want to know whether a given string refers to a commit-ish or a (possibly remote) branch</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/62340432" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>fullspell=`git rev-parse --symbolic-full-name $specifier --`

if fullspell=`git rev-parse --symbolic-full-name $specifier --`; then
case $fullspell in
refs/heads/* | refs/remotes/*)
        # it's a remote-tracking branch or a local branch
        ;;
?*)
        # it<span class="token string">'s something else, but it'</span>s a legit refname
        ;;
*)
        # there<span class="token string">'s no full spelling but the command succeeded. It'</span>s not a bare refname,
        # but it does resolve to something (so e.g. master~3 would get here)
        ;;
esac
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>7. Usage scenario: Temporarily clearing untracked files before commit in Git</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-checkout-index.html">git checkout-index</a>, <a href="/./richen/git-diff-index.html">git diff-index</a> ]    🌐<a href="https://stackoverflow.com/questions/4108042" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>
<span class="token comment">#</span>
<span class="token comment"># Via: http://github.com/jwiegley/git-scripts/blob/master/pre-commit.sh</span>
<span class="token comment">#</span>

if [ ! $(git rev-parse --symbolic-full-name HEAD) = refs/heads/master ]; then
    exit 0
fi

<span class="token comment"># These are the locations I keep my temporary source and build trees in</span>
TMPDIR=$HOME/code/myproject-pre-commit
MIRROR=$HOME/code/myproject-pre-commit-mirror

<span class="token comment"># Exit with status 1 if any command below fails</span>
set -e

<span class="token comment"># Checkout a copy of the current index into MIRROR</span>
git checkout-index --prefix=$MIRROR/ -af

<span class="token comment"># Remove files from MIRROR which are no longer present in the index</span>
git diff-index --cached --name-only --diff-filter=D -z HEAD | \
    (cd $MIRROR &amp;&amp; xargs -0 rm -f --)

<span class="token comment"># Copy only _changed files_ from MIRROR to TMPDIR, without copying timestamps.</span>
<span class="token comment"># This includes copying over new files, and deleting removed ones.  This way,</span>
<span class="token comment"># &quot;make check&quot; will only rebuild what is necessary to validate the commit.</span>
rsync -rlpgoDOc --delete --exclude-from=.git-hooks/excludes $MIRROR/ $TMPDIR/

<span class="token comment"># Everything else happens in the temporary build tree</span>
cd $TMPDIR

nosetests

exit 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><strong>8. Usage scenario: How do I tell on GIT whether a reference is a branch or a tag?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/21610463" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse --symbolic-full-name v1.9-rc2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>9. Usage scenario: Merge upstream without specifying branch name</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/29598752" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse --symbolic-full-name --abbrev-ref @{u}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>10. Usage scenario: apply hook for a specific branch in Git</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/36131730" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>

current_branch=$(git rev-parse --abbrev-ref --symbolic-full-name HEAD)
if [ <span class="token string">&quot;$current_branch&quot;</span> != <span class="token string">&quot;my_branch&quot;</span> ]; then
  echo <span class="token string">&quot;wrong branch&quot;</span>
  exit
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>11. Usage scenario: How to make git merge's default --no-ff only for remotes?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/21666573" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ The simplest test is to run git rev-parse --symbolic-full-name on it.  If the resulting name starts with refs/remotes/, the name is symbolic and names a remote branch:
name_is_remote_branch() {
    local full

    full=$(git rev-parse --symbolic-full-name $1)
    case $full in
    refs/remotes/*) return 0;;
    *) return 1;;
    esac
}

if name_is_remote_branch origin/master; then
    echo seems to work
else
    echo oops
fi

name_is_remote_branch master || echo ok # master should not be <span class="token string">&quot;remote branch&quot;</span>

▲ What happens if we apply this test to a raw SHA-1 ID?
<span class="token command">$ git log<span class="token parameter"> -1</span><span class="token parameter"> --decorate</span><span class="token parameter"> --oneline</span></span>
676699a (origin/master, master) commit subject here
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="all"><a href="#all" class="header-anchor">#</a> 🔹 --all</h2> <p><strong>1. Usage scenario: Find first ancestor commit in another branch</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a> ]    🌐<a href="https://stackoverflow.com/questions/13461275" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ To do this, take a look at the post-receive-email script that comes with your Git distribution (should be installed somewhere like /usr/share/doc/git-core/contrib/hooks/post-receive-email if you want a local copy). This has a long comment that describes how to find only commits that are new in a given branch, and haven't been seen in any others before:
    # Consider this:
    #   1 --- 2 --- O --- X --- 3 --- 4 --- N
    #
    # O is $oldrev for $refname
    # N is $newrev for $refname
    # X is a revision pointed to by some other ref, for which we may
    #   assume that an email has already been generated.
    # In this case we want to issue an email containing only revisions
    # 3, 4, and N.  Given (almost) by
    #
    #  git rev-list N ^O --not --all
    #
    # The reason for the <span class="token string">&quot;almost&quot;</span>, is that the <span class="token string">&quot;--not --all&quot;</span> will take
    # precedence over the <span class="token string">&quot;N&quot;</span>, and effectively will translate to
    #
    #  git rev-list N ^O ^X ^N
    #
    # So, we need to build up the list more carefully.  git rev-parse
    # will generate a list of revs that may be fed into git rev-list.
    # We can get it to make the <span class="token string">&quot;--not --all&quot;</span> part and then filter out
    # the <span class="token string">&quot;^N&quot;</span> with:
    #
    #  git rev-parse --not --all | grep -v N
    #
    # Then, using the --stdin switch to git rev-list we have effectively
    # manufactured
    #
    #  git rev-list N ^O ^X

▲ There are more details to handle corner cases in the comment, and the rest of the script; but if the basic case is all you care about, this should give you the answer:
git rev-parse --not --all | grep -v I | git rev-list --stdin I
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h2 id="git-dir"><a href="#git-dir" class="header-anchor">#</a> 🔹 --git-dir</h2> <p><strong>1. Usage scenario: Git submodule commit hooks</strong></p> <blockquote><p><font size="2">💯Score: 34    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/15146529" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ If you have Git 2.10+ you can get the hooks directory by running:
`git rev-parse --git-path hooks`

▲ Pre Git 2.10+ you would want something like:
`git rev-parse --git-dir`/hooks
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>2. Usage scenario: git: changing an old commit message without creating conflicts</strong></p> <blockquote><p><font size="2">💯Score: 16    🔗Associated commands: [ <a href="/./richen/git-filter-branch.html">git filter-branch</a>, <a href="/./richen/git-config.html">git config</a> ]    🌐<a href="https://stackoverflow.com/questions/27699824" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#! /bin/bash</span>
REV=$1
MESSAGE=$2
FILTER=<span class="token string">&quot;test $(echo '$GIT_COMMIT') = $(git rev-parse $REV) &amp;&amp; echo $MESSAGE || cat&quot;</span>
git filter-branch --msg-filter <span class="token string">&quot;$FILTER&quot;</span> -- --all

git config alias.undo-filter-branch <span class="token string">'! DIR=$(git rev-parse --git-dir); cp -r $DIR/refs/original/refs/ .git/; rm -r $DIR/refs/original/'</span>
git config alias.confirm-filter-branch <span class="token string">'! DIR=$(git rev-parse --git-dir); rm -r $DIR/refs/original/'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>3. Usage scenario: Missing commits in repo on CircleCI container</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/44188746" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token string">&quot;[[ ! -s \&quot;$(git rev-parse --git-dir)/shallow\&quot; ]] || git fetch --unshallow&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>4. Usage scenario: How can I get git's <code>.git</code> path from git itself?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/48992724" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Use git rev-parse, which has options specifically for this:
git rev-parse --git-dir

git rev-parse --absolute-git-dir

▲ (new in Git version 2.13.0), and:
git rev-parse --show-toplevel

git rev-parse --show-cdup

▲ (note that its output is empty if you are already in the top level of the repository).  View your own documentation to find out which options your Git supports; most of these have been around since Git 1.7, though.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>5. Usage scenario: how to sync a &quot;shadow&quot; git repository with a main repository &quot;secretly&quot;</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-pull.html">git pull</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/39369847" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>rem set Git to use the sub-developer's git repository
set GIT_DIR=/path/to/sub/repository.com

rem verify which repository that you are on
git rev-parse --git-dir

rem pull the sub-developer's latest
git pull

rem merge, commit, change, push, change branches, whatever
rem ... when the code is the way you want it

rem switch to client repository
set GIT_DIR=/path/to/client/repository.com

rem bring main repository up to date
git commit -m<span class="token string">&quot;changes brought over from sub-developer&quot;</span>

rem push the updated code to the client repository
git push
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>6. Usage scenario: Exclude remotes from git log --graph</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/23547914" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>temp=`mktemp -u`
git clone -s --bare `git rev-parse --git-dir` $temp
git --git-dir=$temp log --graph --decorate --oneline --branches --simplify-by-decoration
rm -rf $temp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>7. Usage scenario: How to simulantenously work on multiple branches while waiting for tests to to run?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/19115378" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>sh -c 't=$(git rev-parse --git-dir) &amp;&amp; export GIT_DIR=$(readlink -f $t) &amp;&amp; \
    cd /tmp &amp;&amp; mkdir test-xx &amp;&amp; cd test-xx &amp;&amp; git checkout -- . || \
    echo <span class="token string">&quot;unable to check out copy into test dir&quot;</span>'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="git-path"><a href="#git-path" class="header-anchor">#</a> 🔹 --git-path</h2> <p><strong>1. Usage scenario: Git submodule commit hooks</strong></p> <blockquote><p><font size="2">💯Score: 34    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/15146529" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ If you have Git 2.10+ you can get the hooks directory by running:
`git rev-parse --git-path hooks`

▲ Pre Git 2.10+ you would want something like:
`git rev-parse --git-dir`/hooks
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>2. Usage scenario: Command to assert the current HEAD points to master?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/51727582" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>test <span class="token string">&quot;$(cat &quot;</span>$(git rev-parse --git-path HEAD)<span class="token string">&quot;)&quot;</span> == <span class="token string">&quot;ref: refs/heads/master&quot;</span>

test <span class="token string">&quot;$(cat &quot;</span>$(git rev-parse --git-path HEAD)<span class="token string">&quot;)&quot;</span> == <span class="token string">&quot;ref: refs/heads/master&quot;</span> &amp;&amp; echo <span class="token string">&quot;HEAD points to master&quot;</span> || echo <span class="token string">&quot;HEAD does not point to master&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>3. Usage scenario: Git: Preventing Commit During a Rebase</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/49039695" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/bash</span>
set -e
shopt -s extglob

if [[ -d `git rev-parse --git-path rebase-merge` \
   || -d `git rev-parse --git-path rebase-apply` ]]; then
  read -p <span class="token string">'Rebase in progress, continue? '</span>
  [[ ${REPLY,,} == @(y|yes) ]]
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>4. Usage scenario: Viewing the current commit's message during git rebase</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-am.html">git am</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-worktree.html">git worktree</a> ]    🌐<a href="https://stackoverflow.com/questions/53982686" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ TL;DR: check for git rev-parse --git-path rebase-merge/message and git rev-parse --git-path rebase-apply/msg in case you are in an added worktree.
<span class="token command">$ git rev-parse<span class="token parameter"> --git</span>-path HEAD</span>
.git/HEAD
<span class="token command">$ git worktree add ../git2<span class="token parameter"> --detach</span></span>
Preparing worktree (detached HEAD 5d826e9729)
HEAD is now at 5d826e9729 Git 2.20
$ (cd ../git2; git rev-parse --git-path HEAD)
[redacted]/git/.git/worktrees/git2/HEAD

rebase-apply
rebase-merge

▲ (as always, use the git-path trick to locate the actual directories or individual files in them).  The files therein are initially symmetric, as the code just sets up a state directory and then drops files into it as needed.  The set of files may change in any future Git release; however, there's at least some hope of consistency due to contrib/completion/git-prompt.sh.  This looks inside rebase-merge first, if it exists, for:
head-name    the branch you were on when you started the rebase
msgnum       how many commits are already done (how far along are you)
end          the total number of commits to do
interactive  if exists, means this is git rebase -i (vs git rebase -m)

▲ If rebase-merge does not exist, it looks inside rebase-apply (if that exists) for:
next         how many commits are already done (how far along are you)
last         the total number of commits to do
rebasing     if exists, means this is an ordinary git rebase, in which case:
  head-name    the branch you were on when you started rebasing
applying     if exists, means this is a git am without rebase

MERGE_HEAD        a merge is in progress
CHERRY_PICK_HEAD  a cherry-pick is in progress
REVERT_HEAD       a revert is in progress
BISECT_LOG        a bisect is in progress
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="show-toplevel"><a href="#show-toplevel" class="header-anchor">#</a> 🔹 --show-toplevel</h2> <p><strong>1. Usage scenario: How do you get the Git repository's name in some Git repository?</strong></p> <blockquote><p><font size="2">💯Score: 202    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/15716016" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>basename `git rev-parse --show-toplevel`
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>2. Usage scenario: Putting git hooks into repository</strong></p> <blockquote><p><font size="2">💯Score: 159    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/3464399" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/bash</span>
HOOK_NAMES=<span class="token string">&quot;applypatch-msg pre-applypatch post-applypatch pre-commit prepare-commit-msg commit-msg post-commit pre-rebase post-checkout post-merge pre-receive update post-receive post-update pre-auto-gc&quot;</span>
<span class="token comment"># assuming the script is in a bin directory, one level into the repo</span>
HOOK_DIR=$(git rev-parse --show-toplevel)/.git/hooks

for hook in $HOOK_NAMES; do
    # If the hook already exists, is executable, and is not a symlink
    if [ ! -h $HOOK_DIR/$hook -a -x $HOOK_DIR/$hook ]; then
        mv $HOOK_DIR/$hook $HOOK_DIR/$hook.local
    fi
    # create the symlink, overwriting the file if it exists
    # probably the only way this would happen is if you're using an old version of git
    # -- back when the sample hooks were not executable, instead of being named ____.sample
    ln -s -f ../../bin/hooks-wrapper $HOOK_DIR/$hook
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>3. Usage scenario: How do I find out what Git thinks the top-level working directory is?</strong></p> <blockquote><p><font size="2">💯Score: 49    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/6748135" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse --show-toplevel
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>4. Usage scenario: How do I cd to the closest parent folder that has a .git folder with bash?</strong></p> <blockquote><p><font size="2">💯Score: 9    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/44310225" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>gr() {
    cd <span class="token string">&quot;$(git rev-parse --show-toplevel)&quot;</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>5. Usage scenario: How to set the root of git repository to vi/vim find path?</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/30171876" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>let &amp;path .= <span class="token string">&quot;,&quot;</span> . system(<span class="token string">&quot;git rev-parse --show-toplevel | tr -d '\\n'&quot;</span>)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>6. Usage scenario: How can I get git's <code>.git</code> path from git itself?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/48992724" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Use git rev-parse, which has options specifically for this:
git rev-parse --git-dir

git rev-parse --absolute-git-dir

▲ (new in Git version 2.13.0), and:
git rev-parse --show-toplevel

git rev-parse --show-cdup

▲ (note that its output is empty if you are already in the top level of the repository).  View your own documentation to find out which options your Git supports; most of these have been around since Git 1.7, though.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>7. Usage scenario: How to know all Bazel targets affected by a git commit?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-merge-base.html">git merge-base</a>, <a href="/./richen/git-diff.html">git diff</a> ]    🌐<a href="https://stackoverflow.com/questions/64559165" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment"># Under Apache 2.0 licence</span>
COMMIT_RANGE=${COMMIT_RANGE:-$(git merge-base origin/master HEAD)<span class="token string">&quot;..&quot;</span>}

<span class="token comment"># Go to the root of the repo</span>
cd <span class="token string">&quot;$(git rev-parse --show-toplevel)&quot;</span>

<span class="token comment"># Get a list of the current files in package form by querying Bazel.</span>
files=()
for file in $(git diff --name-only ${COMMIT_RANGE} ); do
  files+=($(bazel query $file))
  echo $(bazel query $file)
done

<span class="token comment"># Query for the associated buildables</span>
buildables=$(bazel query \
    --keep_going \
    --noshow_progress \
    <span class="token string">&quot;kind(.*_binary, rdeps(//..., set(${files[*]})))&quot;</span>)
<span class="token comment"># Run the tests if there were results</span>
if [[ ! -z $buildables ]]; then
  echo <span class="token string">&quot;Building binaries&quot;</span>
  bazel build $buildables
fi

tests=$(bazel query \
    --keep_going \
    --noshow_progress \
    <span class="token string">&quot;kind(test, rdeps(//..., set(${files[*]}))) except attr('tags', 'manual', //...)&quot;</span>)
<span class="token comment"># Run the tests if there were results</span>
if [[ ! -z $tests ]]; then
  echo <span class="token string">&quot;Running tests&quot;</span>
  bazel test $tests
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p><strong>8. Usage scenario: How can I play a sound whenever I commit to Git?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/17219541" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>

toplevel_path=`git rev-parse --show-toplevel`
afplay -v 0.1 $toplevel_path/.git/hooks/happykids.wav &gt; /dev/null 2&gt;&amp;1 &amp;

<span class="token comment">#!/bin/sh</span>

toplevel_path=`git rev-parse --show-toplevel`
$toplevel_path/.git/hooks/post-commit.tweet
$toplevel_path/.git/hooks/post-commit.playsound
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>9. Usage scenario: How to create tag automatically in SourceTree</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-diff.html">git diff</a>, <a href="/./richen/git-tag.html">git tag</a> ]    🌐<a href="https://stackoverflow.com/questions/33890643" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#! /bin/bash</span>
version=`git diff HEAD^..HEAD -- <span class="token string">&quot;$(git rev-parse --show-toplevel)&quot;</span>/package.json | grep <span class="token string">'^\+.*version'</span> | sed -s <span class="token string">'s/[^0-9\.]//g'</span>`

if [ <span class="token string">&quot;$version&quot;</span> != <span class="token string">&quot;&quot;</span> ]; then
    git tag -a <span class="token string">&quot;v$version&quot;</span> -m <span class="token string">&quot;`git log -1 --format=%s`&quot;</span>
    echo <span class="token string">&quot;Created a new tag, v$version&quot;</span>
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>10. Usage scenario: How to browse back (cd ..) to parent until find a specific folder?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/56048850" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>cd `git rev-parse --show-toplevel`
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>11. Usage scenario: howto find out which git submodule current directory belongs to</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-submodule.html">git submodule</a>, <a href="/./richen/git-add.html">git add</a> ]    🌐<a href="https://stackoverflow.com/questions/54637531" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>mytoplevel=`git rev-parse --show-toplevel`
abovethat=`git -C <span class="token string">&quot;$mytoplevel&quot;</span>/.. rev-parse --show-toplevel`

git init git_repo; cd $_
mkdir a/b; git init a/b/c; cd $_
mkdir something; touch something/somefile;
git add .; git commit -m-
cd `git -C .. rev-parse --show-toplevel`
git submodule add --name foo/bar ./a/b/c -- a/b/c
git add .; git commit -m-
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>12. Usage scenario: Show parents of uncommitted merge in git</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/13844768" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>
git --no-pager log -1

WORKDIR=`git rev-parse --show-toplevel`
if [ -f <span class="token string">&quot;${WORKDIR}/.git/MERGE_HEAD&quot;</span> ]; then
    for a in `cat <span class="token string">&quot;${WORKDIR}/.git/MERGE_HEAD&quot;</span> | xargs` ; do
        git --no-pager log -1 $a
    done
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>13. Usage scenario: how can I find out if I'm inside a git submodule?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-cat-file.html">git cat-file</a> ]    🌐<a href="https://stackoverflow.com/questions/59019026" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>top=`git rev-parse --show-toplevel 2&gt;&amp;-` || exit
if up=`git -C <span class="token string">&quot;$top/..&quot;</span> rev-parse --show-toplevel 2&gt;&amp;-` 
then    echo work tree is at ${top#$up/} in another work tree
        at=`git -C <span class="token string">&quot;$up&quot;</span> rev-parse :${top#$up/}` &amp;&amp; echo ... which thinks $(git cat-file -t $at) $at should be checked out there
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>14. Usage scenario: How to check if the current repository is the top level git repo</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/52047313" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>toplevel=$(git rev-parse --show-toplevel)
superproject=$(git rev-parse --show-superproject-working-tree)

if [[ -z <span class="token string">&quot;$superproject&quot;</span> ]]; then
    echo <span class="token string">&quot;submodule in $superproject&quot;</span>
else
    echo <span class="token string">&quot;toplevel is $toplevel&quot;</span>
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>15. Usage scenario: Git: Preserving current code state and last four commits</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-tag.html">git tag</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/51501904" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/bash</span>

function gitConsolidation() {

    # Default settings
    numCommitsToKeep=4
    branchName=<span class="token string">&quot;master&quot;</span>
    path=<span class="token string">&quot;/home/steve/test/testgit&quot;</span>

    # Set working directory
    cd $path

    # Get git repo name
    gitRepoName=$(basename `git rev-parse --show-toplevel`)

    # Print default message
    echo -e <span class="token string">&quot;** Prepairing to consolidate current Git Repo: $gitRepoName **&quot;</span>
    echo -e <span class="token string">&quot;Branch: $branchName&quot;</span>
    echo -e <span class="token string">&quot;Path: $path&quot;</span>
    echo -e <span class="token string">&quot;Total past commits to keep: $numCommitsToKeep\n&quot;</span>

    # Get required branch
    git checkout $branchName

    # Get size before consolidation
    echo -e <span class="token string">&quot;Repo size before consolidation: $(du -hs)&quot;</span> 

    # Print current log list
    echo -e <span class="token string">&quot;\n* Git commits prior to consolidation *&quot;</span>  
    git log --pretty=<span class="token string">&quot;%H - %s&quot;</span>

    # Get initial commit hash
    initialCommitHash=$(git rev-list --max-parents=0 HEAD)
    echo -e <span class="token string">&quot;\n* Found initial commit hash: $initialCommitHash *&quot;</span>

    # Get hash for commit to be consolidated with intiial commit
    consCommitHash=$(git log --format=%H | head -$numCommitsToKeep | tail     -1)
    echo -e <span class="token string">&quot;* Found hash for commit to consolidate with initial commit: $consCommitHash *&quot;</span>

    # Get hash for latest commit
    latestCommitHash=$(git log --format=%H | head -1)
    echo -e <span class="token string">&quot;* Found hash for latest commit $latestCommitHash *\n&quot;</span>

    # Begin consolidation
    echo -e <span class="token string">&quot;* BEGIN: Git repo consolidation *&quot;</span>

    # Checkout commit to consolidate with initial commit
    git checkout $consCommitHash

    # Soft reset initial commit
    git reset --soft $initialCommitHash

    # Commit changes
    git commit -m <span class="token string">&quot;Consolidated commit $initialCommitHash -&gt; $consCommitHash&quot;</span>

    # Set tag
    git tag new_base

    # Checkout
    git checkout -b consolidated $latestCommitHash

    # Rebase
    git rebase --onto new_base $consCommitHash

    # Get size after consolidation
    echo -e <span class="token string">&quot;Repo size after consolidation: $(du -hs)&quot;</span>

    # Print current log list
    echo -e <span class="token string">&quot;\n * Git commits after consolidation *&quot;</span>    
    git log --pretty=<span class="token string">&quot;%H - %s&quot;</span>

    echo -e <span class="token string">&quot;\n* END: Git repo consolidation *&quot;</span>
}

<span class="token comment"># Call function</span>
gitConsolidation
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><p><strong>16. Usage scenario: How do I get a list of files that have changed in a git commit, but with an absolute path?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-diff-tree.html">git diff-tree</a>, <a href="/./richen/git-diff.html">git diff</a> ]    🌐<a href="https://stackoverflow.com/questions/36769557" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git diff --name-only &lt;commit-ish&gt;^! | sed <span class="token string">&quot;s|^|$(git rev-parse --show-toplevel)/|&quot;</span>

git diff-tree --no-commit-id --name-only -r &lt;commit-ish&gt; | sed <span class="token string">&quot;s|^|$(git rev-parse --show-toplevel)/|&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="show-superproject-working-tree"><a href="#show-superproject-working-tree" class="header-anchor">#</a> 🔹 --show-superproject-working-tree</h2> <p><strong>1. Usage scenario: Git: Automatically commit submodule with the same message</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/64110853" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>COMMIT_MSG=$(git log -1 --pretty=<span class="token string">'format:%B'</span> HEAD)
<span class="token comment"># I use zsh so $0 works for me. In bash BASH_SOURCE is correct</span>
TOP=$(realpath $(dirname $0)/../../../..)

GIT_INDEX_FILE_SAV=$GIT_INDEX_FILE
unset GIT_INDEX_FILE
git --git-dir .git --work-tree . -C ${TOP} commit sub -m <span class="token string">&quot;${COMMIT_MSG}&quot;</span>
GIT_INDEX_FILE=$GIT_INDEX_FILE_SAV

TOP=$(git rev-parse --show-superproject-working-tree)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>2. Usage scenario: How to check if the current repository is the top level git repo</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/52047313" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>toplevel=$(git rev-parse --show-toplevel)
superproject=$(git rev-parse --show-superproject-working-tree)

if [[ -z <span class="token string">&quot;$superproject&quot;</span> ]]; then
    echo <span class="token string">&quot;submodule in $superproject&quot;</span>
else
    echo <span class="token string">&quot;toplevel is $toplevel&quot;</span>
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="absolute-git-dir"><a href="#absolute-git-dir" class="header-anchor">#</a> 🔹 --absolute-git-dir</h2> <p><strong>1. Usage scenario: How can I get git's <code>.git</code> path from git itself?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/48992724" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Use git rev-parse, which has options specifically for this:
git rev-parse --git-dir

git rev-parse --absolute-git-dir

▲ (new in Git version 2.13.0), and:
git rev-parse --show-toplevel

git rev-parse --show-cdup

▲ (note that its output is empty if you are already in the top level of the repository).  View your own documentation to find out which options your Git supports; most of these have been around since Git 1.7, though.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="is-inside-work-tree"><a href="#is-inside-work-tree" class="header-anchor">#</a> 🔹 --is-inside-work-tree</h2> <p><strong>1. Usage scenario: How to get the full path of a file in a Git remote repo</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-config.html">git config</a> ]    🌐<a href="https://stackoverflow.com/questions/47526678" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>is_git=false
relative_to_git=<span class="token string">&quot;&quot;</span>
check=<span class="token string">&quot;&quot;</span>
initial=$(pwd)
current_dir=<span class="token string">&quot;&quot;</span>
count=0

if [ ! $(git rev-parse --is-inside-work-tree 2&gt; /dev/null) ]; then
  echo <span class="token string">&quot;NOT INSIDE A VALID GIT REPOSITORY&quot;</span>
  return
fi

git_remote=$(git config --get remote.origin.url)
git_remote=${git_remote%.git}
git_branch=$(git rev-parse --abbrev-ref HEAD)

while [ $is_git=true ]
do
  if [ -d <span class="token string">&quot;.git&quot;</span> ]; then
    break
  fi
  current_dir=${PWD##*/}
  relative_to_git=<span class="token string">&quot;$current_dir/$relative_to_git&quot;</span>
  cd ../
done

<span class="token comment"># echo &quot;$git_remote/+/$git_branch/$relative_to_git&quot;</span>
<span class="token comment"># For andoid.googlesource.com uncomment the above and comment the below lines</span>
echo <span class="token string">&quot;$git_remote/tree/$git_branch/$relative_to_git&quot;</span>

cd $initial
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="is-bare-repository"><a href="#is-bare-repository" class="header-anchor">#</a> 🔹 --is-bare-repository</h2> <p><strong>1. Usage scenario: Is the clone repository created by <code>git clone</code> without <code>--bare</code> a repository with a working directory?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/38234945" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse --is-bare-repository 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="show-cdup"><a href="#show-cdup" class="header-anchor">#</a> 🔹 --show-cdup</h2> <p><strong>1. Usage scenario: How can I get git's <code>.git</code> path from git itself?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/48992724" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Use git rev-parse, which has options specifically for this:
git rev-parse --git-dir

git rev-parse --absolute-git-dir

▲ (new in Git version 2.13.0), and:
git rev-parse --show-toplevel

git rev-parse --show-cdup

▲ (note that its output is empty if you are already in the top level of the repository).  View your own documentation to find out which options your Git supports; most of these have been around since Git 1.7, though.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="show-prefix"><a href="#show-prefix" class="header-anchor">#</a> 🔹 --show-prefix</h2> <p><strong>1. Usage scenario: How to get the path of the current directory relative to root of the git repository?</strong></p> <blockquote><p><font size="2">💯Score: 40    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/39923104" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git rev-parse<span class="token parameter"> --show</span>-prefix</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="none"><a href="#none" class="header-anchor">#</a> 🔹None</h2> <p><strong>1. Usage scenario: How do I 'overwrite', rather than 'merge', a branch on another branch in Git?</strong></p> <blockquote><p><font size="2">💯Score: 252    🔗Associated commands: [ <a href="/./richen/git-merge.html">git merge</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-commit-tree.html">git commit-tree</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/4624383" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ You can use the <span class="token string">'ours'</span> merge strategy (this links to octopus merge, you have to scroll down to next option; deeplinking to the correct section is not possible):
<span class="token command">$ git checkout staging</span>
<span class="token command">$ git merge<span class="token parameter"> -s</span> ours email # Merge branches, but use our (=staging) branch head</span>
<span class="token command">$ git checkout email</span>
<span class="token command">$ git merge staging</span>

▲ I thought a bit more about this question and possible solutions. If you absolutely require the merge parents in the correct order, need to perform this action with a single command line invocation, and don't mind running plumbing commands, you can do the following:
<span class="token command">$ git checkout A</span>
<span class="token command">$ git merge<span class="token parameter"> --ff</span>-only $(git commit-tree<span class="token parameter"> -m</span> </span><span class="token string">&quot;Throw away branch 'A'&quot;</span> -p A -p B B^{tree})

<span class="token command">$ git rev-parse A^{tree} B^{tree} HEAD^{tree}</span>
3859ea064e85b2291d189e798bfa1bff87f51f3e
0389f8f2a3e560b639d82597a7bc5489a4c96d44
0389f8f2a3e560b639d82597a7bc5489a4c96d44

<span class="token command">$ git init</span>
$ echo <span class="token string">'original'</span> | tee file1 file2 file3
<span class="token command">$ git commit<span class="token parameter"> -m</span> </span><span class="token string">'initial commit'</span>
<span class="token command">$ git branch A</span>
<span class="token command">$ git branch B</span>
<span class="token command">$ git checkout A</span>
$ echo <span class="token string">'A'</span> &gt; file1
<span class="token command">$ git commit<span class="token parameter"> -m</span> </span><span class="token string">'change on branch A'</span> file1
<span class="token command">$ git checkout B</span>
$ echo <span class="token string">'B'</span> &gt; file2
<span class="token command">$ git commit<span class="token parameter"> -m</span> </span><span class="token string">'change on branch B'</span> file2

▲ Now, let<span class="token string">'s try the strategy option (doesn'</span>t really matter if we use theirs or ours for this explanation):
<span class="token command">$ git merge<span class="token parameter"> -X</span> ours A</span>
$ cat file*
A
B
original

<span class="token command">$ git merge<span class="token parameter"> -s</span> ours A</span>
$ cat file*
original
B
original

<span class="token command">$ git rev-parse A^{tree} B^{tree} merge-strategy^{tree} strategy-option^{tree}</span>
3859ea064e85b2291d189e798bfa1bff87f51f3e
0389f8f2a3e560b639d82597a7bc5489a4c96d44
0389f8f2a3e560b639d82597a7bc5489a4c96d44
5b09d34a37a183723b409d25268c8cb4d073206e
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p><strong>2. Usage scenario: How to find the hash of branch in Git?</strong></p> <blockquote><p><font size="2">💯Score: 173    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/9110527" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git rev-parse development</span>
17f2303133734f4b9a9aacfe52209e04ec11aff4

<span class="token command">$ git rev-parse origin/master</span>
da1ec1472c108f52d4256049fe1f674af69e785d

git rev-parse master~3
git rev-parse HEAD@{2.days.ago}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>3. Usage scenario: How do I get the commit id of the head of master in git?</strong></p> <blockquote><p><font size="2">💯Score: 113    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/5025316" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>4. Usage scenario: Get hash of most recent git commit in Node</strong></p> <blockquote><p><font size="2">💯Score: 80    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/34518749" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>require(<span class="token string">'child_process'</span>).exec(<span class="token string">'git rev-parse HEAD'</span>, function(err, stdout) {
    console.log(<span class="token string">'Last commit hash on this branch is:'</span>, stdout);
});
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>5. Usage scenario: git rebase interactive: squash merge commits together</strong></p> <blockquote><p><font size="2">💯Score: 55    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-reset.html">git reset</a> ]    🌐<a href="https://stackoverflow.com/questions/4138485" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git checkout my-feature
git reset --soft Y
git rev-parse f &gt; .git/MERGE_HEAD
git commit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>6. Usage scenario: How to find the current git branch in detached HEAD state</strong></p> <blockquote><p><font size="2">💯Score: 51    🔗Associated commands: [ <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-show.html">git show</a> ]    🌐<a href="https://stackoverflow.com/questions/6064223" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git log -n 1 --pretty=%d HEAD

<span class="token comment"># or equivalently:</span>
git show -s --pretty=%d HEAD

git for-each-ref --format=<span class="token string">'%(objectname) %(refname:short)'</span> refs/heads | awk <span class="token string">&quot;/^$(git rev-parse HEAD)/ {print \$2}&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>7. Usage scenario: How do I read tagger information from a GIT tag?</strong></p> <blockquote><p><font size="2">💯Score: 40    🔗Associated commands: [ <a href="/./richen/git-cat-file.html">git cat-file</a> ]    🌐<a href="https://stackoverflow.com/questions/22975719" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git cat-file tag &lt;tagname&gt;

if git rev-parse $TAG^{tag} -- &amp;&gt;/dev/null
then
    # Annotated tag
    COMMIT=$(git rev-parse $TAG^{commit})
    TAGGER=($(git cat-file tag $TAG | grep <span class="token string">'^tagger'</span>))
    N=${#TAGGER} # Number of fields
    DATE=${TAGGER[@]:$N-2:2} # Last two fields
    AUTHOR=${TAGGER[@]:1:$N-3} # Everything but the first and last two
    MESSAGE=$(git cat-file tag $TAG | tail -n+6)
elif git rev-parse refs/tags/$TAG -- &amp;&gt;/dev/null
then
    # Lightweight tag - just a commit, basically
    COMMIT=$(git rev-parse $TAG^{commit})
else
    echo <span class="token string">&quot;$TAG: not a tag&quot;</span> &gt;&amp;2
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>8. Usage scenario: How do I react to new tags in git hooks?</strong></p> <blockquote><p><font size="2">💯Score: 37    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/5810488" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/bash</span>

. $(dirname $0)/functions

process_ref() {
    oldrev=$(git rev-parse $1)
    newrev=$(git rev-parse $2)
    refname=<span class="token string">&quot;$3&quot;</span>

    set_change_type
    set_rev_types
    set_describe_tags

    case <span class="token string">&quot;$refname&quot;</span>,<span class="token string">&quot;$rev_type&quot;</span> in
      refs/tags/*,tag)
        # annotated tag
        refname_type=<span class="token string">&quot;annotated tag&quot;</span>
        function=<span class="token string">&quot;atag&quot;</span>
        short_refname=${refname##refs/tags/}
        # change recipients
        if [ -n <span class="token string">&quot;$announcerecipients&quot;</span> ]; then
          recipients=<span class="token string">&quot;$announcerecipients&quot;</span>
        fi
      ;;
    esac 
}

while read REF; do process_ref $REF; done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><strong>9. Usage scenario: Get SHA1 of latest remote commit</strong></p> <blockquote><p><font size="2">💯Score: 20    🔗Associated commands: [ <a href="/./richen/git-ls-remote.html">git ls-remote</a> ]    🌐<a href="https://stackoverflow.com/questions/14135272" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git rev-parse HEAD</span>

<span class="token command">$ git ls-remote &lt;url&gt; &lt;refs&gt;</span>

$ cd ~/github/scrapy/scrapy
<span class="token command">$ git rev-parse HEAD</span>
9f003a73daec59a73c23a2214b1b8d15a4391a2f
<span class="token command">$ git ls-remote git://github.com/scrapy/scrapy.git HEAD</span>
9f003a73daec59a73c23a2214b1b8d15a4391a2f

$ diff &lt;(git ls-remote git://github.com/scrapy/scrapy.git HEAD) \
       &lt;(git rev-parse HEAD) 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>10. Usage scenario: find out if a git commit was checked in before or after another commit given the hashes</strong></p> <blockquote><p><font size="2">💯Score: 17    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/14233620" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git log -1 --format=<span class="token string">'%ci'</span> &lt;commit&gt;

git rev-list &lt;commitA&gt; | grep $(git rev-parse &lt;commitB&gt;)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>11. Usage scenario: Include Git commit hash and/or branch name in C/C++ source</strong></p> <blockquote><p><font size="2">💯Score: 17    🔗Associated commands: [ <a href="/./richen/git-branch.html">git branch</a> ]    🌐<a href="https://stackoverflow.com/questions/44038455" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>GIT_HASH=`git rev-parse HEAD`
COMPILE_TIME=`date -u +<span class="token string">'%Y-%m-%d %H:%M:%S UTC'</span>`
GIT_BRANCH=`git branch | grep <span class="token string">&quot;^\*&quot;</span> | sed <span class="token string">'s/^..//'</span>`
export VERSION_FLAGS=-DGIT_HASH=<span class="token string">&quot;\&quot;$(GIT_HASH)\&quot;&quot;</span> -DCOMPILE_TIME=<span class="token string">&quot;\&quot;$(COMPILE_TIME)\&quot;&quot;</span> -DGIT_BRANCH=<span class="token string">&quot;\&quot;$(GIT_BRANCH)\&quot;&quot;</span>

all:
    g++ main.cpp $(VERSION_FLAGS)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>12. Usage scenario: How to get information where branch starts?</strong></p> <blockquote><p><font size="2">💯Score: 12    🔗Associated commands: [ <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-reflog.html">git reflog</a> ]    🌐<a href="https://stackoverflow.com/questions/4481159" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git reflog show &lt;branch&gt;

git for-each-ref --format=<span class="token string">'%(refname)'</span> refs/heads/* | while read b; do
    if [ <span class="token string">&quot;$(git rev-parse $b@{$date_time})&quot;</span> = <span class="token string">&quot;$target_commit&quot;</span> ]; then
        echo <span class="token string">&quot;branch $b contained commit $target_commit at $date_time&quot;</span>
    fi
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>13. Usage scenario: How to concatenate two git histories?</strong></p> <blockquote><p><font size="2">💯Score: 12    🔗Associated commands: [ <a href="/./richen/git-fast-import.html">git fast-import</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-filter-branch.html">git filter-branch</a>, <a href="/./richen/git-fast-export.html">git fast-export</a>, <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/3219820" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git fetch ../old master:ancient_history

<span class="token command">$ git rev-list master | tail<span class="token parameter"> -n</span> 1</span>
d7737bffdad86dc05bbade271a9c16f8f912d3c6

<span class="token command">$ git rev-parse ancient_history</span>
463d0401a3f34bd381c456c6166e514564289ab2

$ echo d7737bffdad86dc05bbade271a9c16f8f912d3c6 \
       463d0401a3f34bd381c456c6166e514564289ab2 \
       &gt; .git/info/grafts

echo $(git rev-list master | tail -n 1) $(git rev-parse ancient_history) &gt; .git/info/grafts 

<span class="token command">$ git fast-export<span class="token parameter"> --all</span> &gt; ../export</span>

$ mkdir ../nuevo-complete

$ cd ../nuevo-complete

<span class="token command">$ git init</span>

<span class="token command">$ git fast-import &lt; ../export</span>
git-fast-import statistics: [...]

git filter-branch $(git rev-parse ancient_history)..HEAD 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><strong>14. Usage scenario: How to get the tree hash for a given directory name?</strong></p> <blockquote><p><font size="2">💯Score: 11    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/52656910" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse HEAD:path/to/directory/in/my/git
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>15. Usage scenario: How can I find empty git commits?</strong></p> <blockquote><p><font size="2">💯Score: 11    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a> ]    🌐<a href="https://stackoverflow.com/questions/26691249" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>for sha in $(git rev-list --min-parents=1 --max-parents=1 --all)
do
   if [ $(git rev-parse ${sha}^{tree}) == $(git rev-parse ${sha}^1^{tree} ) ]
   then
       echo <span class="token string">&quot;${sha} will be pruned&quot;</span>
   fi
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>16. Usage scenario: How to get sha of current git commit from R</strong></p> <blockquote><p><font size="2">💯Score: 8    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/46377001" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>system(<span class="token string">&quot;git rev-parse HEAD&quot;</span>, intern=TRUE)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>17. Usage scenario: How to find commit hash from within a running docker image</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/63178429" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>docker build --build-arg GIT_COMMIT=$(git rev-parse HEAD) -t my_image:$(git rev-parse HEAD) .
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>18. Usage scenario: How to get a commit id after a branch creation?</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/45461258" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Suppose you have the following situation:
C0 --- C4 --- C5          &lt;= master
   \
    \--- C1 --- C2 --- C3 &lt;= B1

▲ If you execute:
git log --oneline master..B1

C3 COMMIT3-MESSAGE
C2 COMMIT2-MESSAGE
C1 COMMIT1-MESSAGE

▲ Then if you execute:
git rev-parse C1^

C0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>19. Usage scenario: How do I check in files for building with git?</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ <a href="/./richen/git-stash.html">git stash</a>, <a href="/./richen/git-diff-index.html">git diff-index</a>, <a href="/./richen/git-symbolic-ref.html">git symbolic-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/2164243" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>
<span class="token comment">#</span>
<span class="token comment"># This hook does two things:</span>
<span class="token comment">#</span>
<span class="token comment">#  1. update the &quot;info&quot; files that allow the list of references to be</span>
<span class="token comment">#     queries over dumb transports such as http</span>
<span class="token comment">#</span>
<span class="token comment">#  2. if this repository looks like it is a non-bare repository, and</span>
<span class="token comment">#     the checked-out branch is pushed to, then update the working copy.</span>
<span class="token comment">#     This makes &quot;push&quot; function somewhat similarly to darcs and bzr.</span>
<span class="token comment">#</span>
<span class="token comment"># To enable this hook, make this file executable by &quot;chmod +x post-update&quot;.</span>

git-update-server-info

is_bare=$(git-config --get --bool core.bare)

if [ -z <span class="token string">&quot;$is_bare&quot;</span> ]
then
    # for compatibility's sake, guess
    git_dir_full=$(cd $GIT_DIR; pwd)
    case $git_dir_full in */.git) is_bare=false;; *) is_bare=true;; esac
fi

update_wc() {
    ref=$1
    echo <span class="token string">&quot;Push to checked out branch $ref&quot;</span> &gt;&amp;2
    if [ ! -f $GIT_DIR/logs/HEAD ]
    then
        echo <span class="token string">&quot;E:push to non-bare repository requires a HEAD reflog&quot;</span> &gt;&amp;2
        exit 1
    fi
    if (cd $GIT_WORK_TREE; git-diff-files -q --exit-code &gt;/dev/null)
    then
        wc_dirty=0
    else
        echo <span class="token string">&quot;W:unstaged changes found in working copy&quot;</span> &gt;&amp;2
        wc_dirty=1
        desc=<span class="token string">&quot;working copy&quot;</span>
    fi
    if git diff-index --cached HEAD@{1} &gt;/dev/null
    then
        index_dirty=0
    else
        echo <span class="token string">&quot;W:uncommitted, staged changes found&quot;</span> &gt;&amp;2
        index_dirty=1
        if [ -n <span class="token string">&quot;$desc&quot;</span> ]
        then
            desc=<span class="token string">&quot;$desc and index&quot;</span>
        else
            desc=<span class="token string">&quot;index&quot;</span>
        fi
    fi
    if [ <span class="token string">&quot;$wc_dirty&quot;</span> -ne 0 -o <span class="token string">&quot;$index_dirty&quot;</span> -ne 0 ]
    then
        new=$(git rev-parse HEAD)
        echo <span class="token string">&quot;W:stashing dirty $desc - see git-stash(1)&quot;</span> &gt;&amp;2
        ( trap <span class="token string">'echo trapped $$; git symbolic-ref HEAD &quot;'</span><span class="token string">&quot;$ref&quot;</span><span class="token string">'&quot;'</span> 2 3 13 15 ERR EXIT
        git-update-ref --no-deref HEAD HEAD@{1}
        cd $GIT_WORK_TREE
        git stash save <span class="token string">&quot;dirty $desc before update to $new&quot;</span>;
        git-symbolic-ref HEAD <span class="token string">&quot;$ref&quot;</span>
        )
    fi

    # eye candy - show the WC updates :)
    echo <span class="token string">&quot;Updating working copy&quot;</span> &gt;&amp;2
    (cd $GIT_WORK_TREE
    git-diff-index -R --name-status HEAD &gt;&amp;2
    git-reset --hard HEAD)
}

if [ <span class="token string">&quot;$is_bare&quot;</span> = <span class="token string">&quot;false&quot;</span> ]
then
    active_branch=`git-symbolic-ref HEAD`
    export GIT_DIR=$(cd $GIT_DIR; pwd)
    GIT_WORK_TREE=${GIT_WORK_TREE-..}
    for ref
    do
        if [ <span class="token string">&quot;$ref&quot;</span> = <span class="token string">&quot;$active_branch&quot;</span> ]
        then
            update_wc $ref
        fi
    done
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br></div></div><p><strong>20. Usage scenario: How to pull into not-the-current-branch?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-branch.html">git branch</a> ]    🌐<a href="https://stackoverflow.com/questions/9747958" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git branch | grep </span><span class="token string">'^*'</span>
* SOMEBRANCH
<span class="token command">$ git rev-parse OTHER_BRANCH origin/OTHER_BRANCH</span>
7b9b8e57cf19964b60ebda0f03a1d5da3de9e2fe
7b9b8e57cf19964b60ebda0f03a1d5da3de9e2fe
<span class="token command">$ git fetch</span>
7b9b8e5..1efca56  OTHER_BRANCH -&gt; origin/OTHER_BRANCH
<span class="token command">$ git rev-parse OTHER_BRANCH origin/OTHER_BRANCH</span>
7b9b8e57cf19964b60ebda0f03a1d5da3de9e2fe
1efca56c08b7a0f511a3951195656a798c56aa62
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>21. Usage scenario: How to use the &quot;colon slash&quot; revision short form and still refer to a commit's parent?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/37004618" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse $(git rev-parse :/&lt;text&gt;)^

git rev-parse HEAD^{/&lt;text&gt;}^

git rev-parse <span class="token string">&quot;@^{/&lt;text&gt;}^&quot;</span>
<span class="token comment"># or, more complex, as ^ is the windows escape sign:</span>
git rev-parse ^@^^{/&lt;text&gt;}^^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>22. Usage scenario: Git lost track of the fact that I was merging</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-merge.html">git merge</a> ]    🌐<a href="https://stackoverflow.com/questions/63578457" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git update-ref MERGE_HEAD $(git rev-parse &lt;target-branch&gt;)
git merge --continue
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>23. Usage scenario: Jenkins + Git: Only build if PR introduced changes in subdirectory</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-diff.html">git diff</a> ]    🌐<a href="https://stackoverflow.com/questions/58384666" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>&gt; git fetch --no-tags --progress -- http://bitbucket.ccm.com:7990/scm/JUP/jt.git +refs/pull-requests/9/from:refs/remotes/origin/PR-9 
&gt; git fetch --no-tags --progress -- http://bitbucket.ccm.com:7990/scm/JUP/jt.git +refs/heads/master:refs/remotes/upstream/master

&gt; git fetch the PR ref, store it as <span class="token string">'origin/PR-9'</span>
&gt; git fetch master ref, store it as <span class="token string">'upstream/master'</span>

def boolean sourceChanged(String module) {
    def target_branch = env.CHANGE_TARGET;
    def pr_ref        = env.BRANCH_NAME;

    if (target_branch == null) {
        echo <span class="token string">&quot;No target branch defined...&quot;</span>;
        return true;
    }

    def TARGET = sh(returnStdout: true, script: <span class="token string">&quot;git rev-parse upstream/${target_branch}&quot;</span>).trim()
    def HEAD   = sh(returnStdout: true, script: <span class="token string">&quot;git rev-parse origin/${pr_ref}&quot;</span>).trim()

    echo <span class="token string">&quot;Checking for source changes between ${TARGET} (${target_branch}) and ${HEAD} (${pr_ref})...&quot;</span>;
    return sh(returnStatus: true, script: <span class="token string">&quot;git diff --exit-code --name-only ${TARGET}...${HEAD} {module}&quot;</span>) == 1;
}

def SOURCE_DIRS = [
    <span class="token string">&quot;A/&quot;</span>,
    <span class="token string">&quot;X/&quot;</span>
];
...
when { expression { return sourceChanged(SOURCE_DIRS) } }
...
def sourceChanged(ArrayList&lt;String&gt; source_dirs) {
    def target_branch = env.CHANGE_TARGET;
    def pr_ref        = env.BRANCH_NAME;

    if (target_branch == null) {
        echo <span class="token string">&quot;No target branch defined...&quot;</span>;
        return true;
    }

    def TARGET = sh(returnStdout: true, script: <span class="token string">&quot;git rev-parse upstream/${target_branch}&quot;</span>).trim()
    def HEAD   = sh(returnStdout: true, script: <span class="token string">&quot;git rev-parse origin/${pr_ref}&quot;</span>).trim()

    echo <span class="token string">&quot;Checking for source changes between ${TARGET} (${target_branch}) and ${HEAD} (${pr_ref})...&quot;</span>;
    for (String dir : source_dirs) {
        def rc = sh(returnStatus: true, script: <span class="token string">&quot;git diff --name-only --exit-code ${TARGET}...${HEAD} ${dir}&quot;</span>);
        if (rc == 1) {
            echo <span class="token string">&quot;Changes detected in ${dir}!&quot;</span>;
            return true;
        }
    }

    echo <span class="token string">&quot;No changes detected.&quot;</span>;
    return false;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p><strong>24. Usage scenario: Get hash of submodule at previous version of main repo without checking out</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-ls-tree.html">git ls-tree</a> ]    🌐<a href="https://stackoverflow.com/questions/50395503" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse some_tag:submodule

tree=$(git rev-parse some_tag^{tree})
git ls-tree -r $tree
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>25. Usage scenario: How to properly commit in repository with Github Pages branch</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-commit-tree.html">git commit-tree</a>, <a href="/./richen/git-update-ref.html">git update-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/26120283" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#! /bin/sh</span>

<span class="token comment"># Commit the generated HTML pages to the branch gh-pages.</span>
<span class="token comment"># Will not push them to GitHub.</span>

set -e -v

treehash=$(./hash-tree.py <span class="token string">&quot;${1:-_build/html}&quot;</span>)
parent=$(git rev-parse gh-pages)

msg=<span class="token string">&quot;Regenerated docs for $(git rev-parse HEAD)&quot;</span>
commithash=$(echo <span class="token string">&quot;$msg&quot;</span> | git commit-tree $treehash -p $parent)
echo <span class="token string">&quot;Updating gh-pages to $commithash&quot;</span>
git update-ref refs/heads/gh-pages <span class="token string">&quot;$commithash&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>26. Usage scenario: How do I get the ID of the last push in git?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/9653843" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> git rev-parse origin/master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>27. Usage scenario: How include git branch name in apk file name automatically</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/39654630" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>def changeApkName = { variant -&gt;
    variant.outputs.each { output -&gt;
        def apk = output.outputFile;
        def newName = androidApplicationName;
        def branch = getGitRevParseInfo(<span class="token string">&quot;--abbrev-ref&quot;</span>);
        if (variant.buildType.name == <span class="token string">&quot;release&quot;</span>) {
            newName += <span class="token string">&quot;-v&quot;</span> + variant.mergedFlavor.versionName + <span class="token string">&quot;-&quot;</span> + branch + <span class="token string">&quot;-release.apk&quot;</span>;
        } else {
            newName += <span class="token string">&quot;-v&quot;</span> + variant.mergedFlavor.versionName + <span class="token string">&quot;-&quot;</span> + branch + <span class="token string">&quot;.apk&quot;</span>;
        }

        if (!output.zipAlign) {
            newName = newName.replace(<span class="token string">&quot;.apk&quot;</span>, <span class="token string">&quot;-unaligned.apk&quot;</span>);
        }
        output.outputFile = new File(apk.parentFile, newName);

        println <span class="token string">'INFO: Set outputFile to '</span> + output.outputFile + <span class="token string">&quot; for [&quot;</span> + output.name + <span class="token string">&quot;]&quot;</span>
    }
}

def getGitRevParseInfo(what) {
    def cmd = <span class="token string">&quot;git rev-parse &quot;</span> + what + <span class="token string">&quot; HEAD&quot;</span>
    def proc = cmd.execute()
    proc.text.trim()
}

android {
        applicationVariants.all { variant -&gt;
            variant.outputs.each { output -&gt;
                changeApkName(variant)
            }
        }
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><strong>28. Usage scenario: git submodule reference not show current branch, but show commit hash</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/49657454" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Submodules are designed to be detached
$ cat .gitmodules
[submodule <span class="token string">&quot;path/to/sub1&quot;</span>]
        path = path/to/sub1
        url = ssh://one.example.com/repo1.git

[submodule <span class="token string">&quot;path2/sub2&quot;</span>]
        path = path2/sub2
        url = ssh://two.example.com/repo2.git

▲ Names of commits
<span class="token command">$ git rev-parse master</span>
0afbf6caa5b16dcfa3074982e5b48e27d452dbbb

▲ Conclusion (or is it?)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>29. Usage scenario: Creating Git alias that gets the last commit</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-config.html">git config</a> ]    🌐<a href="https://stackoverflow.com/questions/5993921" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse HEAD

<span class="token command">$ git config<span class="token parameter"> --global</span> alias.last-commit </span><span class="token string">&quot;rev-parse HEAD&quot;</span>
<span class="token command">$ git last-commit</span>
dc1ac14864ecb3dd27f934ba964b030cfedf234a
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>30. Usage scenario: git get conflicts from past merge without running merge once again</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-merge.html">git merge</a>, <a href="/./richen/git-diff.html">git diff</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-show.html">git show</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-difftool.html">git difftool</a> ]    🌐<a href="https://stackoverflow.com/questions/15443177" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ If you want to look at what the merge did you can do
git show &lt;hash-of-merge-commit&gt;

▲ If you want to redo the entire merge you do
git checkout &lt;branch-that-you-merged-to&gt;
git reset --hard &lt;hash-of-the-commit-just-before-the-merge&gt;
git merge &lt;branch-that-you-merged-in&gt;

▲ If you want to redo the merge and then compare the second merge to the first merge (to consider if it was better) you can do:
git checkout &lt;branch-that-you-merged-to&gt;
git rev-parse HEAD

git reset --hard &lt;hash-of-the-commit-just-before-the-merge&gt;
git merge &lt;branch-that-you-merged-in&gt;

git difftool &lt;hash-of-commit-noted-above&gt;

▲ If you felt that the original merge was better, you can do
git reset --hard &lt;hash-of-commit-noted-above&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>31. Usage scenario: GIT hook to prevent an experimental branch pushed to a release, or master branch</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-merge-base.html">git merge-base</a>, <a href="/./richen/git-tag.html">git tag</a> ]    🌐<a href="https://stackoverflow.com/questions/13384768" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>refname=<span class="token string">&quot;$1&quot;</span>
oldrev=<span class="token string">&quot;$2&quot;</span>
newrev=<span class="token string">&quot;$3&quot;</span>
case <span class="token string">&quot;$refname&quot;</span> in
  refs/heads/RELEASE|refs/heads/MASTER)
    for forbidden in $(git tag -l <span class="token string">'forbidden/*'</span>); do
      if [ $(git merge-base <span class="token string">&quot;$forbidden&quot;</span> $newrev) = $(git rev-parse <span class="token string">&quot;$forbidden&quot;</span>) ]; then
        echo <span class="token string">&quot;Push to $refname contains commit $forbidden&quot;</span> &gt;&amp;2
        exit 1
      fi
    done
    ;;
esac
exit 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>32. Usage scenario: How to split a git repository into recent and older commits at a specific commit point, preserving branches?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-commit-tree.html">git commit-tree</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-filter-branch.html">git filter-branch</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/48396032" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ First create a branch for the historical commits
git branch history $TRUNCPOINT
git push project-history history:master
git push project-history A

git log --graph --oneline --decorate --all
* fdc8f84 (A) branchA a1
| * 7237a3e (HEAD -&gt; master) fourth
| * 55be55d third
|/  
* 26555d8 second
* 5a68ca2 first

▲ Create a base commit to serve as the parent for the recent commits
MESSAGE=<span class="token string">&quot;Get history from historical repository&quot;</span>
BASECOMMIT=`echo $MESSAGE | git commit-tree ${TRUNCPARENT}^{tree}`

▲ Split the repository by grafting the TRUNCPARENT onto BASECOMMIT
echo <span class="token string">&quot;${TRUNCPOINT} ${BASECOMMIT}&quot;</span> &gt; .git/info/grafts
git filter-branch -- --all
git push project-recent master
git push project-recent B

git log --graph --oneline --decorate --all
* 2335aeb (B) branchB b2
* 2bb7ea3 branchB b1
| * 83c3ae9 (HEAD -&gt; master) sixth
|/  
* 25931c5 fifth
* 1e1e201 fourth
* a7f3373 Get history from historical repository

▲ Fully reproduced example bash script
<span class="token comment">#!/bin/bash</span>
WORKDIR=${PWD}

create_repos () {
    rm -rf repo-split-example repo-split-recent repo-split-history
    # Create the repo to be split
    example_repo

    # Create the repo to contain the historical commits
    HISTREPO=<span class="token string">&quot;file://${WORKDIR}/repo-split-history&quot;</span>
    mkdir ../repo-split-history
    cd ../repo-split-history/
    git init --bare
    cd ../repo-split-example
    git remote add project-history $HISTREPO

    # Create the repo to contain the recent commits
    RECEREPO=<span class="token string">&quot;file://${WORKDIR}/repo-split-recent&quot;</span>
    mkdir ../repo-split-recent
    cd ../repo-split-recent/
    git init --bare
    cd ../repo-split-example
    git remote add project-recent $RECEREPO
}

example_repo () {
    # Part I: set up a test repo with our example commits
    mkdir repo-split-example
    cd repo-split-example/
    git init
    echo <span class="token string">&quot;We want to split the repository into project-recent and project-history portions, following the instructions at https://git-scm.com/book/en/v2/Git-Tools-Replace., but also including branches.&quot;</span> &gt; README.md
    echo <span class="token string">&quot; &quot;</span>
    echo <span class="token string">&quot;First commit.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;first&quot;</span>
    echo <span class="token string">&quot;Second commit.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;second&quot;</span>

    git checkout -b A HEAD
    echo <span class="token string">&quot;Add Branch A change.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;branchA a1&quot;</span>

    git checkout master
    echo <span class="token string">&quot;Third commit.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;third&quot;</span>
    TRUNCPARENT=`git rev-parse HEAD`

    echo <span class="token string">&quot;Fourth commit.&quot;</span> &gt;&gt; README.md 
    git add README.md
    git commit -m <span class="token string">&quot;fourth&quot;</span>
    TRUNCPOINT=`git rev-parse HEAD`

    echo <span class="token string">&quot;Fifth commit.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;fifth&quot;</span>
    FIFTH=`git rev-parse HEAD`

    git checkout -b B HEAD
    echo <span class="token string">&quot;Add Branch B change. b1&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;branchB b1&quot;</span>
    B1=`git rev-parse HEAD`

    echo <span class="token string">&quot;Add Branch B change. b2&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;branchB b2&quot;</span>
    B2=`git rev-parse HEAD`

    git checkout master
    echo <span class="token string">&quot;Sixth commit.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;sixth&quot;</span>

    # Now we have a repo with the requisite structure, ready to be split
    git log --graph --all --oneline --decorate
}


split_repo () {
    # Part II: Split the git repo into historical and current halves at $TRUNCPOINT
    # Following guidelines at https://git-scm.com/book/en/v2/Git-Tools-Replace

    # First create a branch for the historical commits
    echo <span class="token string">&quot;Branching history at $TRUNCPOINT&quot;</span>
    git branch history $TRUNCPOINT
    git log --graph --oneline --decorate history A

    # Now copy the history repo to the remote HISTREPO repository
    git push project-history history:master
    git push project-history A

    # Now to split the repo to get the recent history from TRUNCPOINT to HEAD of master
    # Create a base commit for the new new recent history
    MESSAGE=<span class="token string">&quot;Get history from historical repository at $HISTREPO&quot;</span>
    BASECOMMIT=`echo $MESSAGE | git commit-tree ${TRUNCPARENT}^{tree}`

    # Split the repository by grafting the TRUNCPARENT onto BASECOMMIT
    echo <span class="token string">&quot;${TRUNCPOINT} ${BASECOMMIT}&quot;</span> &gt; .git/info/grafts
    git filter-branch -- --all

    # Finally, push the current rewritten master and associated branches to a new repository
    git push project-recent master
    git push project-recent B
}

create_repos
split_repo 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br></div></div><p><strong>33. Usage scenario: Get the previous raw file from the blob object(hash)</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-show.html">git show</a> ]    🌐<a href="https://stackoverflow.com/questions/44476525" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse 9f38e2d9e6ca81341fecf82d881cf629effb4be2^:README.md

git show 9f38e2d9e6ca81341fecf82d881cf629effb4be2^:README.md
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>34. Usage scenario: discovering merged git branches on repositories that use squash by default?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/64288685" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse remote/main^{tree}

git rev-parse feature^{tree}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>35. Usage scenario: Get commit where merged branch forked from (with intermediate merge)</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-merge-base.html">git merge-base</a> ]    🌐<a href="https://stackoverflow.com/questions/49310657" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>m=11c63bc  # this is the merge
p1=$(git rev-parse ${m}^1)
p2=$(git rev-parse ${m}^2)

git merge-base --all $p1 $p2

mbases=$(git merge-base --all ${m}^1 ${m}^2)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>36. Usage scenario: How to get timestamp-neutral git hash from a given commit hash</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/38934737" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse $CommitHash^{tree}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>37. Usage scenario: git: reliably switching to a detached HEAD and then restore HEAD later, all from a script</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-symbolic-ref.html">git symbolic-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/3467576" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment"># If HEAD is a sym-ref, the first assignment will work</span>
<span class="token comment"># otherwise, it's detached, so get the SHA1 with rev-parse</span>
if ! head=$(git symbolic-ref HEAD 2&gt;&amp;1); then
    head=$(git rev-parse HEAD)
fi
<span class="token comment"># trim a refs/heads/ prefix; no-op otherwise</span>
head=${head#refs/heads/}


<span class="token comment"># now go on and do your stuff, test, whatever you like</span>

<span class="token comment"># then return to where you were</span>
<span class="token comment"># This will ERASE ANY LOCAL CHANGES.</span>
git checkout -f $head
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>38. Usage scenario: How to move E..H commits into a separate repository?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-filter-branch.html">git filter-branch</a>, <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/13376022" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>cd /path/to/repo
git checkout -b newbranch special
git rev-parse E &gt; .git/info/grafts
git filter-branch
rm .git/info/grafts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>39. Usage scenario: How to get revision number of latest commit in master branch</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/58085463" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>40. Usage scenario: How to &quot;dereference&quot; a string to a git sha1 hash?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/8500312" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>41. Usage scenario: How to print latest commit id of kernel code in kernel log?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/18610199" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>gcc main.c -DKERNEL_LAST_COMMIT=<span class="token string">&quot;\&quot;$(cd /kernel/source/path ; git rev-parse HEAD)\&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>42. Usage scenario: How can I run the makefile on every git branch</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-pull.html">git pull</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-clean.html">git clean</a>, <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/7876869" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment"># fetch updates, but don't merge yet</span>
git fetch    # origin is default

<span class="token comment"># list all branches</span>
git for-each-ref --format=<span class="token string">'%(refname:short)'</span> refs/heads |
while read branch; do
    # if the branch is not the same as the remote branch...
    if [ <span class="token string">&quot;$(git rev-parse $branch)&quot;</span> != <span class="token string">&quot;$(git rev-parse origin/$branch)&quot;</span> ]; then
         # only continue to the next step on successful results
         git checkout $branch &amp;&amp;
         git pull &amp;&amp;
         (make &amp;&amp;
         cp executable /somewhere/else;
         make clean)
         # except always make clean as long as we tried to make
         #
         # you might also consider a hard reset and clean, to guarantee things
         # are safe for the next checkout
    fi
done

<span class="token comment"># die hard on unexpected checkout/pull failures</span>
if ! (git checkout $branch &amp;&amp; git pull); then
    exit 1
fi
if make; then
    cp executable /somewhere/else
else
    # report a build failure?
fi
<span class="token comment"># clean up no matter what</span>
git clean -xdf
git reset --hard
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p><strong>43. Usage scenario: Pruning old Git commits without rebasing</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-repack.html">git repack</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-filter-branch.html">git filter-branch</a>, <a href="/./richen/git-prune.html">git prune</a>, <a href="/./richen/git-gc.html">git gc</a> ]    🌐<a href="https://stackoverflow.com/questions/47293861" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> git rev-parse HEAD~100 &gt; .git/info/grafts

 git filter-branch -- --all

git reflog expire --expire=now --all
git gc --prune=now
git gc --aggressive --prune=now
git repack -Ad      # kills in-pack garbage
git prune           # kills loose garbage
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>44. Usage scenario: How can I check out only a part of a git repository during a bamboo build?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-commit-tree.html">git commit-tree</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-tag.html">git tag</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-mktree.html">git mktree</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/10457397" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Easiest is probably to have whoever's hosting the repo tag and commit the particular tree you want.  For instance,
git tag quickie $(git commit-tree $(git rev-parse HEAD:path/to/dir) &lt;/dev/null)

git fetch upstream quickie

▲ If you want the upstream repo to automatically track a subtree on a branch, you can do (a suitably decrypted version of) something like this:
sed -n <span class="token string">'s,^[^ ]* [^ ]* refs/heads/master$,git update-ref refs/heads/master-subtree -m &quot;Auto-tracking master&quot; $(git commit-tree master:subtree -m &quot;Auto-tracking master subtree&quot; $(test -r refs/heads/master-subtree \&amp;\&amp; echo -p refs/heads/master-subtree)),p'</span> | sh -x

mkdir ~/tryitout &amp;&amp; cd ~/tryitout &amp;&amp; git init foo &amp;&amp; git init bar --bare
cat &gt;bar/hooks/post-receive &lt;&lt;<span class="token string">'EOF'</span>
sed -n <span class="token string">'s,^[^ ]* [^ ]* refs/heads/master$,git update-ref refs/heads/master-subtree -m &quot;Auto-tracking master&quot; $(git commit-tree master:subtree -m &quot;Auto-tracking master subtree&quot; $(test -r refs/heads/master-subtree \&amp;\&amp; echo -p refs/heads/master-subtree)),p'</span> | sh -x
EOF
chmod a+x bar/hooks/post-receive
cd foo
mkdir subtree &amp;&amp; touch subtree/oooo &amp;&amp; git add . &amp;&amp; git commit -am-
git push ../bar master

▲ If you're sharing a filesystem with the other repo, you can do this:
git clone --no-checkout /path/to/local/repo/.git subtree
cd subtree
git commit-tree origin/rev:subtree &lt;/dev/null | xargs git checkout -B peek

git mktree &lt;/dev/null | xargs git commit-tree | xargs git checkout -b empty
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><strong>45. Usage scenario: Using git diff to generate the patch file</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/60896340" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse mainline

git rev-parse origin/mainline
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>46. Usage scenario: How to handle nested git repositories?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-ls-tree.html">git ls-tree</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-ls-files.html">git ls-files</a> ]    🌐<a href="https://stackoverflow.com/questions/37243167" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git ls-files -s|grep ^16            # ls-files -s output: mode id stage path

git ls-tree -r $id|grep ^16         # ls-tree -r output:  mode type id path

git rev-parse :path/to/it           # from index i.e. last add/checkout/reset/etc 
git rev-parse $id:path/to/it        # from $id, e.g. `master` or `3fac3`

(cd <span class="token string">&quot;$submodule&quot;</span>; git rev-parse HEAD)

(id=`git rev-parse :<span class="token string">&quot;$submodule&quot;</span>` &amp;&amp; cd <span class="token string">&quot;$submodule&quot;</span> &amp;&amp; git checkout $id)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>47. Usage scenario: How to squash all merges in a branch?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-cherry-pick.html">git cherry-pick</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-show.html">git show</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/27514988" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git commit --amend -C $(git rev-parse $rev^2)

git checkout A~0

for rev in $(git rev-list  HEAD..branch-name --first-parent --reverse)
do
    if [[ $(git show --summary --format=<span class="token string">&quot;%P&quot;</span> $rev | wc -w ) -gt 1 ]]
    then
        git cherry-pick $rev --mainline 1
        # git commit --amend -C $(git rev-parse $rev^2)
    else
        git cherry-pick $rev
    fi
done

git branch -f branch-name HEAD
git checkout branch-name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>48. Usage scenario: Reference directory from master branch on gh-pages branch</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-show.html">git show</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-ls-files.html">git ls-files</a> ]    🌐<a href="https://stackoverflow.com/questions/10791074" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git checkout master -- path/to/my/docs/dir

git ls-files $(git rev-parse master) -- path/to/my/docs/dir

git show master:path/to/my/docs/dir/somefile.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>49. Usage scenario: How to get a result from a Puppet provisioner</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/19426674" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>exec { <span class="token string">&quot;send-hipchat-message&quot;</span> :
   command     =&gt; <span class="token string">&quot;echo \&quot;SHA: $$(git rev-parse HEAD)\&quot;&quot;</span>,
   path        =&gt; <span class="token string">&quot;/usr/bin&quot;</span>,
   subscribe   =&gt; Vcsrepo[<span class="token string">&quot;/opt/ourcompany/distribution&quot;</span>],
   require     =&gt; Vcsrepo[<span class="token string">&quot;/opt/ourcompany/distribution&quot;</span>],
   cwd         =&gt; <span class="token string">'/opt/ourcompany/distribution'</span>,
   refreshonly =&gt; true
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>50. Usage scenario: How do you compare commit messages of two git branches to figure out the difference?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/23166717" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse master~^{tree}
git rev-parse master~2^{tree}
git rev-parse master~3^{tree}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>51. Usage scenario: How do I find the version of Git repo</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/50663742" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>cd /path/to/your/local/cloned/repo
git rev-parse origin/master
git rev-parse FETCH_HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>52. Usage scenario: Extraction of diff hash from GITHub commit url</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/43997626" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse 3db08c3ce067ae92af324b2d8bd6b5e2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>53. Usage scenario: Check if there are new commits since the latest tag</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/61720445" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>      - name: Get Git SHA
        id: gitsha
        run: echo <span class="token string">&quot;::set-output name=gitsha::$(git rev-parse HEAD)&quot;</span>

<span class="token deleted">- uses: actions/checkout@v2</span>
<span class="token deleted">- run: git fetch --depth=1 origin +refs/tags/*:refs/tags/*</span>

      - name: Get yesterdays date
        id: ydate
        run: echo <span class="token string">&quot;::set-output name=ydate::$(date -d &quot;</span>yesterday 13:00<span class="token string">&quot; +'%Y-%m-%d')&quot;</span>
      - uses: actions/checkout@v2
        with:
          ref: refs/tags/${{ steps.ydate.outputs.ydate }}
      - name: Get Yesterdays Git SHA
        id: ygitsha
        run: echo <span class="token string">&quot;::set-output name=ygitsha::$(git rev-parse HEAD)&quot;</span>

if git rev-parse <span class="token string">&quot;$TAG&quot;</span> &gt;/dev/null 2&gt;&amp;1; then
  echo <span class="token string">&quot;tag exists&quot;</span>;
else
  echo <span class="token string">&quot;tag does not exist&quot;</span>
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><strong>54. Usage scenario: Remove a commit and related changes from a branch</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-cherry-pick.html">git cherry-pick</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-reset.html">git reset</a> ]    🌐<a href="https://stackoverflow.com/questions/15904953" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rebase --onto HEAD^^ HEAD $BRANCH

TIP=`git rev-parse HEAD`
git reset --hard HEAD^^
git cherry-pick $TIP
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>55. Usage scenario: Are git tags always based on fixed commits</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/25957536" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse &lt;tag&gt;~0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>56. Usage scenario: Git Branch, Rebase, Merge &amp; Tags</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/14995133" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-parse TAG
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>57. Usage scenario: How to properly get list of remotes files before the pull</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-diff.html">git diff</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/24245706" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>branch_name=`git branch | grep ^\* | awk <span class="token string">'{print $2}'</span>`
old_commit=$(git rev-parse origin/${branch_name})
git fetch
git diff --stat origin/${branch_name}
git update-ref refs/remotes/origin/${branch_name} $old_commit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>58. Usage scenario: How to roll back in git and start again (keeping the history and the merges in between)</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-commit-tree.html">git commit-tree</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/63629898" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>A---B---C &lt;&lt;&lt; master &lt;&lt;&lt; HEAD

git branch backup-before-cleaning
git reset --hard A
git push --force origin HEAD

  B---C &lt;&lt;&lt; backup-before-cleaning
 /
A &lt;&lt;&lt; master &lt;&lt;&lt; HEAD

A---B---C &lt;&lt;&lt; master &lt;&lt;&lt; HEAD

git reset --hard $(git commit-tree -m <span class="token string">&quot;Return to A&quot;</span> -p $(git rev-parse HEAD) $(git rev-parse A^{tree}))

A---B---C---D &lt;&lt;&lt; master &lt;&lt;&lt; HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/./richen/git-rev-list.html" class="prev">
        git rev-list
      </a></span> <span class="next"><a href="/./richen/git-revert.html">
        git revert
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="./assets/js/app.e311b099.js" defer></script><script src="./assets/js/2.48635caf.js" defer></script><script src="./assets/js/119.13f74eae.js" defer></script>
  </body>
</html>
