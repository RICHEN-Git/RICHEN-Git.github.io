<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RICHEN</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="./image/git.png">
    <link rel="stylesheet" href="./css/style.css">
    <meta name="description" content="enRiching GIt doCumentation witH Examples miNed from Stack Overflow">
    
    <link rel="preload" href="./assets/css/0.styles.2ca7c5d3.css" as="style"><link rel="preload" href="./assets/js/app.e311b099.js" as="script"><link rel="preload" href="./assets/js/2.48635caf.js" as="script"><link rel="preload" href="./assets/js/56.d43fb632.js" as="script"><link rel="prefetch" href="./assets/js/10.e1617348.js"><link rel="prefetch" href="./assets/js/100.33cca180.js"><link rel="prefetch" href="./assets/js/101.18976a0a.js"><link rel="prefetch" href="./assets/js/102.8317b37b.js"><link rel="prefetch" href="./assets/js/103.07197de5.js"><link rel="prefetch" href="./assets/js/104.731bc1e4.js"><link rel="prefetch" href="./assets/js/105.c63b5cda.js"><link rel="prefetch" href="./assets/js/106.6d64500a.js"><link rel="prefetch" href="./assets/js/107.41117ce7.js"><link rel="prefetch" href="./assets/js/108.ae1670af.js"><link rel="prefetch" href="./assets/js/109.334fc4b2.js"><link rel="prefetch" href="./assets/js/11.d2acd68b.js"><link rel="prefetch" href="./assets/js/110.a423a716.js"><link rel="prefetch" href="./assets/js/111.ec3f4b9d.js"><link rel="prefetch" href="./assets/js/112.99e97bd6.js"><link rel="prefetch" href="./assets/js/113.dca119e6.js"><link rel="prefetch" href="./assets/js/114.62cf553b.js"><link rel="prefetch" href="./assets/js/115.b3dc05f5.js"><link rel="prefetch" href="./assets/js/116.f1ad5266.js"><link rel="prefetch" href="./assets/js/117.9554ab91.js"><link rel="prefetch" href="./assets/js/118.767812f8.js"><link rel="prefetch" href="./assets/js/119.13f74eae.js"><link rel="prefetch" href="./assets/js/12.03eb7f39.js"><link rel="prefetch" href="./assets/js/120.3616df73.js"><link rel="prefetch" href="./assets/js/121.cdacf559.js"><link rel="prefetch" href="./assets/js/122.e46153a3.js"><link rel="prefetch" href="./assets/js/123.18b06bd9.js"><link rel="prefetch" href="./assets/js/124.028e957c.js"><link rel="prefetch" href="./assets/js/125.1499f786.js"><link rel="prefetch" href="./assets/js/126.6d4256ba.js"><link rel="prefetch" href="./assets/js/127.e0aac155.js"><link rel="prefetch" href="./assets/js/128.e58a9c82.js"><link rel="prefetch" href="./assets/js/129.153a8856.js"><link rel="prefetch" href="./assets/js/13.b3c19674.js"><link rel="prefetch" href="./assets/js/130.a53c0b9a.js"><link rel="prefetch" href="./assets/js/131.7828ecc2.js"><link rel="prefetch" href="./assets/js/132.41634721.js"><link rel="prefetch" href="./assets/js/133.2cb44028.js"><link rel="prefetch" href="./assets/js/134.58581a37.js"><link rel="prefetch" href="./assets/js/135.c9380642.js"><link rel="prefetch" href="./assets/js/136.b6ffd3c7.js"><link rel="prefetch" href="./assets/js/137.1a8edb9d.js"><link rel="prefetch" href="./assets/js/138.5fce928f.js"><link rel="prefetch" href="./assets/js/139.71aa88e1.js"><link rel="prefetch" href="./assets/js/14.babb932e.js"><link rel="prefetch" href="./assets/js/140.7f377bd1.js"><link rel="prefetch" href="./assets/js/141.f49215bb.js"><link rel="prefetch" href="./assets/js/142.130e4ba1.js"><link rel="prefetch" href="./assets/js/143.94c54ada.js"><link rel="prefetch" href="./assets/js/144.6ed9cf6e.js"><link rel="prefetch" href="./assets/js/145.3846d48f.js"><link rel="prefetch" href="./assets/js/146.f245fd88.js"><link rel="prefetch" href="./assets/js/147.f2406a95.js"><link rel="prefetch" href="./assets/js/148.39c0e458.js"><link rel="prefetch" href="./assets/js/149.ffa6fd8a.js"><link rel="prefetch" href="./assets/js/15.07fe9b50.js"><link rel="prefetch" href="./assets/js/150.02bb59b1.js"><link rel="prefetch" href="./assets/js/151.37a6afec.js"><link rel="prefetch" href="./assets/js/152.796eec33.js"><link rel="prefetch" href="./assets/js/153.dc7c378e.js"><link rel="prefetch" href="./assets/js/154.cf710861.js"><link rel="prefetch" href="./assets/js/155.c30753e3.js"><link rel="prefetch" href="./assets/js/156.ddce82b2.js"><link rel="prefetch" href="./assets/js/157.069e9f8f.js"><link rel="prefetch" href="./assets/js/16.ef23c91e.js"><link rel="prefetch" href="./assets/js/17.817c34aa.js"><link rel="prefetch" href="./assets/js/18.c6f6e6ed.js"><link rel="prefetch" href="./assets/js/19.cfc0468d.js"><link rel="prefetch" href="./assets/js/20.3546a4ea.js"><link rel="prefetch" href="./assets/js/21.c290e743.js"><link rel="prefetch" href="./assets/js/22.cc04f442.js"><link rel="prefetch" href="./assets/js/23.1a94bca1.js"><link rel="prefetch" href="./assets/js/24.443e3a00.js"><link rel="prefetch" href="./assets/js/25.1a5ee134.js"><link rel="prefetch" href="./assets/js/26.edd51004.js"><link rel="prefetch" href="./assets/js/27.8d0e855e.js"><link rel="prefetch" href="./assets/js/28.17f95192.js"><link rel="prefetch" href="./assets/js/29.e3219a64.js"><link rel="prefetch" href="./assets/js/3.6bd04ed3.js"><link rel="prefetch" href="./assets/js/30.7ddd3774.js"><link rel="prefetch" href="./assets/js/31.671ee6bc.js"><link rel="prefetch" href="./assets/js/32.14e6e041.js"><link rel="prefetch" href="./assets/js/33.694f0624.js"><link rel="prefetch" href="./assets/js/34.a24cb95a.js"><link rel="prefetch" href="./assets/js/35.b9274172.js"><link rel="prefetch" href="./assets/js/36.90de1eb5.js"><link rel="prefetch" href="./assets/js/37.316285c4.js"><link rel="prefetch" href="./assets/js/38.7666fb89.js"><link rel="prefetch" href="./assets/js/39.d325104f.js"><link rel="prefetch" href="./assets/js/4.e3ec6571.js"><link rel="prefetch" href="./assets/js/40.c69344c4.js"><link rel="prefetch" href="./assets/js/41.255ef83a.js"><link rel="prefetch" href="./assets/js/42.93911f6f.js"><link rel="prefetch" href="./assets/js/43.2d2a661b.js"><link rel="prefetch" href="./assets/js/44.fb24dd71.js"><link rel="prefetch" href="./assets/js/45.deac9add.js"><link rel="prefetch" href="./assets/js/46.ac87e5e7.js"><link rel="prefetch" href="./assets/js/47.addfea2d.js"><link rel="prefetch" href="./assets/js/48.5fefec78.js"><link rel="prefetch" href="./assets/js/49.a328b7d6.js"><link rel="prefetch" href="./assets/js/5.dd8b7ea7.js"><link rel="prefetch" href="./assets/js/50.2cbc41fc.js"><link rel="prefetch" href="./assets/js/51.08ce739c.js"><link rel="prefetch" href="./assets/js/52.59af3778.js"><link rel="prefetch" href="./assets/js/53.9ead31f4.js"><link rel="prefetch" href="./assets/js/54.f24de741.js"><link rel="prefetch" href="./assets/js/55.05aa52da.js"><link rel="prefetch" href="./assets/js/57.7fa6e090.js"><link rel="prefetch" href="./assets/js/58.fb6d6521.js"><link rel="prefetch" href="./assets/js/59.778ade86.js"><link rel="prefetch" href="./assets/js/6.82ef2073.js"><link rel="prefetch" href="./assets/js/60.613c4878.js"><link rel="prefetch" href="./assets/js/61.681c256c.js"><link rel="prefetch" href="./assets/js/62.e943d1b9.js"><link rel="prefetch" href="./assets/js/63.990aaadb.js"><link rel="prefetch" href="./assets/js/64.5759fedf.js"><link rel="prefetch" href="./assets/js/65.f970e42e.js"><link rel="prefetch" href="./assets/js/66.dd24c3d9.js"><link rel="prefetch" href="./assets/js/67.5fb2be90.js"><link rel="prefetch" href="./assets/js/68.ec785420.js"><link rel="prefetch" href="./assets/js/69.1d315c02.js"><link rel="prefetch" href="./assets/js/7.a3b325ca.js"><link rel="prefetch" href="./assets/js/70.d6012aac.js"><link rel="prefetch" href="./assets/js/71.52d01068.js"><link rel="prefetch" href="./assets/js/72.bbe5d2f6.js"><link rel="prefetch" href="./assets/js/73.0d7b6abc.js"><link rel="prefetch" href="./assets/js/74.3b1eeb63.js"><link rel="prefetch" href="./assets/js/75.6afe5c8a.js"><link rel="prefetch" href="./assets/js/76.d9877d60.js"><link rel="prefetch" href="./assets/js/77.5d4a9d5d.js"><link rel="prefetch" href="./assets/js/78.e2ad497a.js"><link rel="prefetch" href="./assets/js/79.697e2354.js"><link rel="prefetch" href="./assets/js/8.e85cc98d.js"><link rel="prefetch" href="./assets/js/80.be1f2dd0.js"><link rel="prefetch" href="./assets/js/81.ce13acd9.js"><link rel="prefetch" href="./assets/js/82.df76b5ac.js"><link rel="prefetch" href="./assets/js/83.3c842d13.js"><link rel="prefetch" href="./assets/js/84.6534a56c.js"><link rel="prefetch" href="./assets/js/85.c0b581a0.js"><link rel="prefetch" href="./assets/js/86.bfbfbed9.js"><link rel="prefetch" href="./assets/js/87.f7e7b93e.js"><link rel="prefetch" href="./assets/js/88.f69371e0.js"><link rel="prefetch" href="./assets/js/89.b970999b.js"><link rel="prefetch" href="./assets/js/9.2cc7c68c.js"><link rel="prefetch" href="./assets/js/90.31b35c49.js"><link rel="prefetch" href="./assets/js/91.8a794555.js"><link rel="prefetch" href="./assets/js/92.4a75f06f.js"><link rel="prefetch" href="./assets/js/93.83c18202.js"><link rel="prefetch" href="./assets/js/94.2d339421.js"><link rel="prefetch" href="./assets/js/95.2dcb1fb2.js"><link rel="prefetch" href="./assets/js/96.8d019eed.js"><link rel="prefetch" href="./assets/js/97.b9ff4345.js"><link rel="prefetch" href="./assets/js/98.316d9923.js"><link rel="prefetch" href="./assets/js/99.0006ac5c.js">
    <link rel="stylesheet" href="./assets/css/0.styles.2ca7c5d3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><!----> <span class="site-name">RICHEN</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./richen/" class="nav-link router-link-active">
  RICHEN
</a></div><div class="nav-item"><a href="https://stackoverflow.com/questions/tagged/git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Stack Overflow
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/./richen/" class="nav-link router-link-active">
  RICHEN
</a></div><div class="nav-item"><a href="https://stackoverflow.com/questions/tagged/git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Stack Overflow
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Enchied Git Documentation</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./richen/git-add.html" class="sidebar-link">git add</a></li><li><a href="/./richen/git-am.html" class="sidebar-link">git am</a></li><li><a href="/./richen/git-annotate.html" class="sidebar-link">git annotate</a></li><li><a href="/./richen/git-apply.html" class="sidebar-link">git apply</a></li><li><a href="/./richen/git-archimport.html" class="sidebar-link">git archimport</a></li><li><a href="/./richen/git-archive.html" class="sidebar-link">git archive</a></li><li><a href="/./richen/git-bisect.html" class="sidebar-link">git bisect</a></li><li><a href="/./richen/git-blame.html" class="sidebar-link">git blame</a></li><li><a href="/./richen/git-branch.html" class="sidebar-link">git branch</a></li><li><a href="/./richen/git-bugreport.html" class="sidebar-link">git bugreport</a></li><li><a href="/./richen/git-bundle.html" class="sidebar-link">git bundle</a></li><li><a href="/./richen/git-cat-file.html" class="sidebar-link">git cat-file</a></li><li><a href="/./richen/git-check-attr.html" class="sidebar-link">git check-attr</a></li><li><a href="/./richen/git-check-ignore.html" class="sidebar-link">git check-ignore</a></li><li><a href="/./richen/git-check-mailmap.html" class="sidebar-link">git check-mailmap</a></li><li><a href="/./richen/git-check-ref-format.html" class="sidebar-link">git check-ref-format</a></li><li><a href="/./richen/git-checkout.html" class="sidebar-link">git checkout</a></li><li><a href="/./richen/git-checkout-index.html" class="sidebar-link">git checkout-index</a></li><li><a href="/./richen/git-cherry.html" class="sidebar-link">git cherry</a></li><li><a href="/./richen/git-cherry-pick.html" class="sidebar-link">git cherry-pick</a></li><li><a href="/./richen/git-citool.html" class="sidebar-link">git citool</a></li><li><a href="/./richen/git-clean.html" class="sidebar-link">git clean</a></li><li><a href="/./richen/git-clone.html" class="sidebar-link">git clone</a></li><li><a href="/./richen/git-column.html" class="sidebar-link">git column</a></li><li><a href="/./richen/git-commit.html" class="sidebar-link">git commit</a></li><li><a href="/./richen/git-commit-graph.html" class="sidebar-link">git commit-graph</a></li><li><a href="/./richen/git-commit-tree.html" class="sidebar-link">git commit-tree</a></li><li><a href="/./richen/git-config.html" class="sidebar-link">git config</a></li><li><a href="/./richen/git-count-objects.html" class="sidebar-link">git count-objects</a></li><li><a href="/./richen/git-credential.html" class="sidebar-link">git credential</a></li><li><a href="/./richen/git-credential-cache.html" class="sidebar-link">git credential-cache</a></li><li><a href="/./richen/git-credential-store.html" class="sidebar-link">git credential-store</a></li><li><a href="/./richen/git-cvsexportcommit.html" class="sidebar-link">git cvsexportcommit</a></li><li><a href="/./richen/git-cvsimport.html" class="sidebar-link">git cvsimport</a></li><li><a href="/./richen/git-cvsserver.html" class="sidebar-link">git cvsserver</a></li><li><a href="/./richen/git-daemon.html" class="sidebar-link">git daemon</a></li><li><a href="/./richen/git-describe.html" class="sidebar-link">git describe</a></li><li><a href="/./richen/git-diff.html" class="sidebar-link">git diff</a></li><li><a href="/./richen/git-diff-files.html" class="sidebar-link">git diff-files</a></li><li><a href="/./richen/git-diff-index.html" class="sidebar-link">git diff-index</a></li><li><a href="/./richen/git-diff-tree.html" class="sidebar-link">git diff-tree</a></li><li><a href="/./richen/git-difftool.html" class="sidebar-link">git difftool</a></li><li><a href="/./richen/git-fast-export.html" class="sidebar-link">git fast-export</a></li><li><a href="/./richen/git-fast-import.html" class="sidebar-link">git fast-import</a></li><li><a href="/./richen/git-fetch.html" class="sidebar-link">git fetch</a></li><li><a href="/./richen/git-fetch-pack.html" class="sidebar-link">git fetch-pack</a></li><li><a href="/./richen/git-filter-branch.html" aria-current="page" class="active sidebar-link">git filter-branch</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#subdirectory-filter" class="sidebar-link">🔹 --subdirectory-filter</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#env-filter" class="sidebar-link">🔹 --env-filter</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#tree-filter" class="sidebar-link">🔹 --tree-filter</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#index-filter" class="sidebar-link">🔹 --index-filter</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#parent-filter" class="sidebar-link">🔹 --parent-filter</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#msg-filter" class="sidebar-link">🔹 --msg-filter</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#commit-filter" class="sidebar-link">🔹 --commit-filter</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#tag-name-filter" class="sidebar-link">🔹 --tag-name-filter</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#prune-empty" class="sidebar-link">🔹 --prune-empty</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#d" class="sidebar-link">🔹 -d</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#f" class="sidebar-link">🔹 -f</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#force" class="sidebar-link">🔹 --force</a></li><li class="sidebar-sub-header"><a href="/./richen/git-filter-branch.html#none" class="sidebar-link">🔹None</a></li></ul></li><li><a href="/./richen/git-fmt-merge-msg.html" class="sidebar-link">git fmt-merge-msg</a></li><li><a href="/./richen/git-for-each-ref.html" class="sidebar-link">git for-each-ref</a></li><li><a href="/./richen/git-for-each-repo.html" class="sidebar-link">git for-each-repo</a></li><li><a href="/./richen/git-format-patch.html" class="sidebar-link">git format-patch</a></li><li><a href="/./richen/git-fsck.html" class="sidebar-link">git fsck</a></li><li><a href="/./richen/git-gc.html" class="sidebar-link">git gc</a></li><li><a href="/./richen/git-get-tar-commit-id.html" class="sidebar-link">git get-tar-commit-id</a></li><li><a href="/./richen/git-grep.html" class="sidebar-link">git grep</a></li><li><a href="/./richen/git-gui.html" class="sidebar-link">git gui</a></li><li><a href="/./richen/git-hash-object.html" class="sidebar-link">git hash-object</a></li><li><a href="/./richen/git-help.html" class="sidebar-link">git help</a></li><li><a href="/./richen/git-http-backend.html" class="sidebar-link">git http-backend</a></li><li><a href="/./richen/git-http-fetch.html" class="sidebar-link">git http-fetch</a></li><li><a href="/./richen/git-http-push.html" class="sidebar-link">git http-push</a></li><li><a href="/./richen/git-imap-send.html" class="sidebar-link">git imap-send</a></li><li><a href="/./richen/git-index-pack.html" class="sidebar-link">git index-pack</a></li><li><a href="/./richen/git-init.html" class="sidebar-link">git init</a></li><li><a href="/./richen/git-instaweb.html" class="sidebar-link">git instaweb</a></li><li><a href="/./richen/git-interpret-trailers.html" class="sidebar-link">git interpret-trailers</a></li><li><a href="/./richen/git-log.html" class="sidebar-link">git log</a></li><li><a href="/./richen/git-ls-files.html" class="sidebar-link">git ls-files</a></li><li><a href="/./richen/git-ls-remote.html" class="sidebar-link">git ls-remote</a></li><li><a href="/./richen/git-ls-tree.html" class="sidebar-link">git ls-tree</a></li><li><a href="/./richen/git-mailinfo.html" class="sidebar-link">git mailinfo</a></li><li><a href="/./richen/git-mailsplit.html" class="sidebar-link">git mailsplit</a></li><li><a href="/./richen/git-maintenance.html" class="sidebar-link">git maintenance</a></li><li><a href="/./richen/git-merge.html" class="sidebar-link">git merge</a></li><li><a href="/./richen/git-merge-base.html" class="sidebar-link">git merge-base</a></li><li><a href="/./richen/git-merge-file.html" class="sidebar-link">git merge-file</a></li><li><a href="/./richen/git-merge-index.html" class="sidebar-link">git merge-index</a></li><li><a href="/./richen/git-merge-one-file.html" class="sidebar-link">git merge-one-file</a></li><li><a href="/./richen/git-merge-tree.html" class="sidebar-link">git merge-tree</a></li><li><a href="/./richen/git-mergetool.html" class="sidebar-link">git mergetool</a></li><li><a href="/./richen/git-mktag.html" class="sidebar-link">git mktag</a></li><li><a href="/./richen/git-mktree.html" class="sidebar-link">git mktree</a></li><li><a href="/./richen/git-multi-pack-index.html" class="sidebar-link">git multi-pack-index</a></li><li><a href="/./richen/git-mv.html" class="sidebar-link">git mv</a></li><li><a href="/./richen/git-name-rev.html" class="sidebar-link">git name-rev</a></li><li><a href="/./richen/git-notes.html" class="sidebar-link">git notes</a></li><li><a href="/./richen/git-p4.html" class="sidebar-link">git p4</a></li><li><a href="/./richen/git-pack-objects.html" class="sidebar-link">git pack-objects</a></li><li><a href="/./richen/git-pack-redundant.html" class="sidebar-link">git pack-redundant</a></li><li><a href="/./richen/git-pack-refs.html" class="sidebar-link">git pack-refs</a></li><li><a href="/./richen/git-patch-id.html" class="sidebar-link">git patch-id</a></li><li><a href="/./richen/git-prune.html" class="sidebar-link">git prune</a></li><li><a href="/./richen/git-prune-packed.html" class="sidebar-link">git prune-packed</a></li><li><a href="/./richen/git-pull.html" class="sidebar-link">git pull</a></li><li><a href="/./richen/git-push.html" class="sidebar-link">git push</a></li><li><a href="/./richen/git-quiltimport.html" class="sidebar-link">git quiltimport</a></li><li><a href="/./richen/git-range-diff.html" class="sidebar-link">git range-diff</a></li><li><a href="/./richen/git-read-tree.html" class="sidebar-link">git read-tree</a></li><li><a href="/./richen/git-rebase.html" class="sidebar-link">git rebase</a></li><li><a href="/./richen/git-receive-pack.html" class="sidebar-link">git receive-pack</a></li><li><a href="/./richen/git-reflog.html" class="sidebar-link">git reflog</a></li><li><a href="/./richen/git-remote.html" class="sidebar-link">git remote</a></li><li><a href="/./richen/git-repack.html" class="sidebar-link">git repack</a></li><li><a href="/./richen/git-replace.html" class="sidebar-link">git replace</a></li><li><a href="/./richen/git-request-pull.html" class="sidebar-link">git request-pull</a></li><li><a href="/./richen/git-rerere.html" class="sidebar-link">git rerere</a></li><li><a href="/./richen/git-reset.html" class="sidebar-link">git reset</a></li><li><a href="/./richen/git-restore.html" class="sidebar-link">git restore</a></li><li><a href="/./richen/git-rev-list.html" class="sidebar-link">git rev-list</a></li><li><a href="/./richen/git-rev-parse.html" class="sidebar-link">git rev-parse</a></li><li><a href="/./richen/git-revert.html" class="sidebar-link">git revert</a></li><li><a href="/./richen/git-rm.html" class="sidebar-link">git rm</a></li><li><a href="/./richen/git-send-email.html" class="sidebar-link">git send-email</a></li><li><a href="/./richen/git-send-pack.html" class="sidebar-link">git send-pack</a></li><li><a href="/./richen/git-sh-i18n.html" class="sidebar-link">git sh-i18n</a></li><li><a href="/./richen/git-sh-setup.html" class="sidebar-link">git sh-setup</a></li><li><a href="/./richen/git-shell.html" class="sidebar-link">git shell</a></li><li><a href="/./richen/git-shortlog.html" class="sidebar-link">git shortlog</a></li><li><a href="/./richen/git-show.html" class="sidebar-link">git show</a></li><li><a href="/./richen/git-show-branch.html" class="sidebar-link">git show-branch</a></li><li><a href="/./richen/git-show-index.html" class="sidebar-link">git show-index</a></li><li><a href="/./richen/git-show-ref.html" class="sidebar-link">git show-ref</a></li><li><a href="/./richen/git-sparse-checkout.html" class="sidebar-link">git sparse-checkout</a></li><li><a href="/./richen/git-stash.html" class="sidebar-link">git stash</a></li><li><a href="/./richen/git-status.html" class="sidebar-link">git status</a></li><li><a href="/./richen/git-stripspace.html" class="sidebar-link">git stripspace</a></li><li><a href="/./richen/git-submodule.html" class="sidebar-link">git submodule</a></li><li><a href="/./richen/git-svn.html" class="sidebar-link">git svn</a></li><li><a href="/./richen/git-switch.html" class="sidebar-link">git switch</a></li><li><a href="/./richen/git-symbolic-ref.html" class="sidebar-link">git symbolic-ref</a></li><li><a href="/./richen/git-tag.html" class="sidebar-link">git tag</a></li><li><a href="/./richen/git-unpack-file.html" class="sidebar-link">git unpack-file</a></li><li><a href="/./richen/git-unpack-objects.html" class="sidebar-link">git unpack-objects</a></li><li><a href="/./richen/git-update-index.html" class="sidebar-link">git update-index</a></li><li><a href="/./richen/git-update-ref.html" class="sidebar-link">git update-ref</a></li><li><a href="/./richen/git-update-server-info.html" class="sidebar-link">git update-server-info</a></li><li><a href="/./richen/git-upload-archive.html" class="sidebar-link">git upload-archive</a></li><li><a href="/./richen/git-upload-pack.html" class="sidebar-link">git upload-pack</a></li><li><a href="/./richen/git-var.html" class="sidebar-link">git var</a></li><li><a href="/./richen/git-verify-commit.html" class="sidebar-link">git verify-commit</a></li><li><a href="/./richen/git-verify-pack.html" class="sidebar-link">git verify-pack</a></li><li><a href="/./richen/git-verify-tag.html" class="sidebar-link">git verify-tag</a></li><li><a href="/./richen/git-version.html" class="sidebar-link">git version</a></li><li><a href="/./richen/git-whatchanged.html" class="sidebar-link">git whatchanged</a></li><li><a href="/./richen/git-worktree.html" class="sidebar-link">git worktree</a></li><li><a href="/./richen/git-write-tree.html" class="sidebar-link">git write-tree</a></li><li><a href="/./richen/gitk.html" class="sidebar-link">gitk</a></li><li><a href="/./richen/gitweb.html" class="sidebar-link">gitweb</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>📖 122 min read    🔡 24340<br></p></div> <h1 id="git-filter-branch-rewrite-branches"><a href="#git-filter-branch-rewrite-branches" class="header-anchor">#</a> 📌 git filter-branch - Rewrite branches</h1> <h2 id="subdirectory-filter"><a href="#subdirectory-filter" class="header-anchor">#</a> 🔹 --subdirectory-filter</h2> <p><strong>1. Usage scenario: Detach (move) subdirectory into separate Git repository</strong></p> <blockquote><p><font size="2">💯Score: 1263    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-gc.html">git gc</a> ]    🌐<a href="https://stackoverflow.com/questions/359759" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone /XYZ /ABC

cd /ABC
for i in branch1 br2 br3; do git branch -t $i origin/$i; done
git remote rm origin

cd /ABC
for i in $(git branch -r | sed <span class="token string">&quot;s/.*origin\///&quot;</span>); do git branch -t $i origin/$i; done
git remote rm origin

git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter ABC -- --all

git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter ABC HEAD

git reset --hard
git for-each-ref --format=<span class="token string">&quot;%(refname)&quot;</span> refs/original/ | xargs -n 1 git update-ref -d
git reflog expire --expire=now --all
git gc --aggressive --prune=now
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>2. Usage scenario: How to remove origin from git repository</strong></p> <blockquote><p><font size="2">💯Score: 622    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a> ]    🌐<a href="https://stackoverflow.com/questions/9224789" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git remote rm origin

git filter-branch --prune-empty --subdirectory-filter path/to/subtree HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>3. Usage scenario: Export subtree in Git with history</strong></p> <blockquote><p><font size="2">💯Score: 104    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/1662787" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --subdirectory-filter foodir -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>4. Usage scenario: How can I move a directory in a Git repo for all commits?</strong></p> <blockquote><p><font size="2">💯Score: 102    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/3142821" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ You can use the subdirectory filter to achieve this
<span class="token command"> $ git filter-branch<span class="token parameter"> --subdirectory</span>-filter blog/ --<span class="token parameter"> --all</span></span>

▲ EDIT 1: If you don't want to effectively make _posts the root, use a tree-filter instead:
<span class="token command"> $ git filter-branch<span class="token parameter"> --tree</span>-filter </span><span class="token string">'mv blog/_posts .'</span> HEAD

▲ EDIT 2: If blog/_posts did not exist in some of the commits, the above will fail. Use this instead:
<span class="token command"> $ git filter-branch<span class="token parameter"> --tree</span>-filter </span><span class="token string">'test -d blog/_posts &amp;&amp; mv blog/_posts . || echo &quot;Nothing to do&quot;'</span> HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>5. Usage scenario: Git create a new branch with only a specified directory and its history then push to new repository</strong></p> <blockquote><p><font size="2">💯Score: 27    🔗Associated commands: [ <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/31160999" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git branch subdir_branch HEAD
git filter-branch --subdirectory-filter dir/to/filter -- subdir_branch
git push git://.../new_repo.git subdir_branch:master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>6. Usage scenario: Git: Conversion of a Subdirectory to a Submodule</strong></p> <blockquote><p><font size="2">💯Score: 23    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/35937708" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git filter-branch<span class="token parameter"> --subdirectory</span>-filter htdocs/typo3_src --<span class="token parameter"> --all</span></span>
Rewrite cbe03e13da071403a2632263f1760b560398cdd3 (1/12) (0 seconds passed, remaining 0 predicted)    004b20fc15023539484c7f5990b99780f54dc0ac
fatal: failed to unpack tree object cbe03e13da071403a2632263f1760b560398cdd3:htdocs/typo3_src
Could not initialize the index

<span class="token command">$ git filter-branch<span class="token parameter"> --subdirectory</span>-filter htdocs/typo3_src/ --<span class="token parameter"> --all</span></span>
Rewrite ec6e3c7212f1080fc052c87b1129335ab5bee524 (5/10) (1 seconds passed, remaining 1 predicted)    
Ref <span class="token string">'refs/heads/master'</span> was rewritten
Ref <span class="token string">'refs/remotes/origin/master'</span> was rewritten
Ref <span class="token string">'refs/remotes/origin/develop'</span> was rewritten
WARNING: Ref <span class="token string">'refs/remotes/origin/master'</span> is unchanged
WARNING: Ref <span class="token string">'refs/tags/0.0.1'</span> is unchanged
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>7. Usage scenario: Git multiple sub projects from sub folders?</strong></p> <blockquote><p><font size="2">💯Score: 16    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/3252064" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git filter-branch<span class="token parameter"> --subdirectory</span>-filter project1 HEAD</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>8. Usage scenario: How to make part of an existing Git repository a submodule</strong></p> <blockquote><p><font size="2">💯Score: 13    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a> ]    🌐<a href="https://stackoverflow.com/questions/1593779" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git filter-branch<span class="token parameter"> --subdirectory</span>-filter ABC HEAD --<span class="token parameter"> --all</span></span>

<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter </span><span class="token string">&quot;git rm -r -f --cached --ignore-unmatch ABC&quot;</span> --prune-empty HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>9. Usage scenario: Split one subfolder from git repository with all branches and history</strong></p> <blockquote><p><font size="2">💯Score: 12    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/47084338" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git clone https://github.com/USERNAME/REPOSITORY-NAME</span>
$ cd REPOSITORY-NAME

$ for i in $(git branch -r | sed <span class="token string">&quot;s/.*origin\///&quot;</span>); do git branch -t $i origin/$i; done

<span class="token command">$ git filter-branch<span class="token parameter"> --prune</span>-empty<span class="token parameter"> --subdirectory</span>-filter FOLDER-NAME --<span class="token parameter"> --all</span></span>

<span class="token command">$ git filter-branch<span class="token parameter"> --prune</span>-empty<span class="token parameter"> --tree</span>-filter </span><span class="token string">'rm -rf FOLDER-NAME'</span> -- --all

<span class="token command">$ git remote<span class="token parameter"> -v</span></span>
origin  https://github.com/USERNAME/REPOSITORY-NAME.git (fetch)
origin  https://github.com/USERNAME/REPOSITORY-NAME.git (push)
<span class="token command">$ git remote set-url origin https://github.com/USERNAME/NEW-REPOSITORY-NAME.git</span>
<span class="token command">$ git remote<span class="token parameter"> -v</span></span>
origin  https://github.com/USERNAME/NEW-REPOSITORY-NAME.git (fetch)
origin  https://github.com/USERNAME/NEW-REPOSITORY-NAME.git (push)

<span class="token command">$ git push<span class="token parameter"> -u</span> origin<span class="token parameter"> --all</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>10. Usage scenario: Detach subdirectory (that was renamed!) into a new repo</strong></p> <blockquote><p><font size="2">💯Score: 9    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-rev-parse.html">git rev-parse</a> ]    🌐<a href="https://stackoverflow.com/questions/6638058" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git branch rename $COMMIT_ID_OF_RENAME 
git branch pre-rename rename~
<span class="token comment">## First filter all commits up to rename, but not rename itself</span>
git filter-branch --subdirectory-filter $OLDNAME pre-rename
<span class="token comment">## Add a graft, so our rename rev comes after the processed pre-rename revs</span>
echo `git rev-parse rename` `git rev-parse pre-rename` &gt;&gt; .git/info/grafts
<span class="token comment">## The first filter-branch left a refs backup directory. Move it away so the</span>
<span class="token comment">## next filter-branch doesn't complain</span>
mv .git/refs/original .git/refs/original0
<span class="token comment">## Now filter the rest</span>
git filter-branch --subdirectory-filter $NEWNAME master ^pre-rename
<span class="token comment">## The graft is now baked into the branch, so we don't need it anymore</span>
rm .git/info/grafts

<span class="token comment">#!/bin/bash</span>

set -u
set -e
set -x

rm -rf .git x y foo

git init
mkdir x
echo initial &gt; x/foo
git add x/foo
git commit -m <span class="token string">'test commit 1'</span>

echo tc2 &gt;&gt; x/foo
git commit -a -m <span class="token string">'test commit 2'</span>

mv x y
git rm x/foo
git add y/foo
git commit -a -m <span class="token string">'test rename'</span>

git branch rename HEAD

echo post rename &gt;&gt; y/foo
git commit -a -m <span class="token string">'test post rename'</span>

git branch pre-rename rename~

git filter-branch --subdirectory-filter x pre-rename
echo `git rev-parse rename` `git rev-parse pre-rename` &gt;&gt; .git/info/grafts

mv .git/refs/original .git/refs/original0

git filter-branch --subdirectory-filter y master ^pre-rename

rm .git/info/grafts

git log -u
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p><strong>11. Usage scenario: Create a git repository from commits of a previous one</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/4755041" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --subdirectory-filter foobar --prune-empty -- --all

git filter-branch --tree-filter <span class="token string">'rm -f filename1 pattern2.*'</span> --prune-empty -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>12. Usage scenario: Git status picking up parent folder's files</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/9813398" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>Making a Subdirectory the New Root

Suppose you’ve done an import from another source control system and have subdirectories
that make no sense (trunk, tags, and so on). If you want to make the trunk subdirectory be 
the new project root for every commit, filter-branch can help you do that, too:

<span class="token command">$ git filter-branch<span class="token parameter"> --subdirectory</span>-filter trunk HEAD</span>

Rewrite 856f0bf61e41a27326cdae8f09fe708d679f596f (12/12)
Ref <span class="token string">'refs/heads/master'</span> was rewritten
Now your new project root is what was in the trunk subdirectory each time. Git will also 
automatically remove commits that did not affect the subdirectory.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>13. Usage scenario: git filter-branch led to a disconnected history: how to get rid of the old commits?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/17973408" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>cvs2git --blobfile=blob --dump=dump /path/to/cvs/base
<span class="token comment"># Module 1</span>
git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter <span class="token string">&quot;path/to/module1&quot;</span> -- --all
<span class="token comment"># Module 2</span>
git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter <span class="token string">&quot;path/to/module2&quot;</span> -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>14. Usage scenario: git push a sub-directory into another main repo</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-push.html">git push</a>, <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/25407830" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone &lt;ORIG_REPO_DIR&gt; &lt;NEW_REPO_DIR&gt;
cd &lt;NEW_REPO_DIR&gt;
git filter-branch --prune-empty --subdirectory-filter &lt;THE_SUBDIR_TO_MAKE_NEW_ROOTDIR&gt; master
git push &lt;MY_NEW_REMOTE_ORIGIN_URL&gt; -f .
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>15. Usage scenario: Checkout a Specific Folder within a Git Repository</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/36142629" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ filter-branch
<span class="token comment"># Filter the master branch to your directory and remove empty commits</span>
git filter-branch --prune-empty --subdirectory-filter YOUR_FOLDER_NAME filter_from_branch

▲ subtree split
git subtree split -P &lt;name-of-folder&gt; -b &lt;name-of-new-branch&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>16. Usage scenario: Create new git repo from already existing repo's subdirectory</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/6687726" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>for branch in $(git for-each-ref --format=<span class="token string">'%(refname:short)'</span> refs/remotes/origin | grep -v HEAD); do
  git checkout -b $(basename $branch) $branch
  git filter-branch -f --subdirectory-filter subdirectory HEAD -- --all
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>17. Usage scenario: How can I split a repository apart into smaller atomic repositories?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/5106626" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>   To rewrite the repository to look as if foodir/ had been its project
   root, and discard all other history:

       git filter-branch --subdirectory-filter foodir -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>18. Usage scenario: Splitting large git repository</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/26455253" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --prune-empty --subdirectory-filter foldername master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>19. Usage scenario: How do I pull just one folder from another Git repository?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-push.html">git push</a>, <a href="/./richen/git-remote.html">git remote</a> ]    🌐<a href="https://stackoverflow.com/questions/58964379" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --subdirectory-filter server -- --all 
git remote add temp git@temporaryrepo....
git push temp master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>20. Usage scenario: How to copy git repository including only one subfolder?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/3448847" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --subdirectory-filter foodir -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="env-filter"><a href="#env-filter" class="header-anchor">#</a> 🔹 --env-filter</h2> <p><strong>1. Usage scenario: How to change the author and committer name and e-mail of multiple commits in Git?</strong></p> <blockquote><p><font size="2">💯Score: 1426    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/750182" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>

git filter-branch --env-filter '
OLD_EMAIL=<span class="token string">&quot;your-old-email@example.com&quot;</span>
CORRECT_NAME=<span class="token string">&quot;Your Correct Name&quot;</span>
CORRECT_EMAIL=<span class="token string">&quot;your-correct-email@example.com&quot;</span>
if [ <span class="token string">&quot;$GIT_COMMITTER_EMAIL&quot;</span> = <span class="token string">&quot;$OLD_EMAIL&quot;</span> ]
then
    export GIT_COMMITTER_NAME=<span class="token string">&quot;$CORRECT_NAME&quot;</span>
    export GIT_COMMITTER_EMAIL=<span class="token string">&quot;$CORRECT_EMAIL&quot;</span>
fi
if [ <span class="token string">&quot;$GIT_AUTHOR_EMAIL&quot;</span> = <span class="token string">&quot;$OLD_EMAIL&quot;</span> ]
then
    export GIT_AUTHOR_NAME=<span class="token string">&quot;$CORRECT_NAME&quot;</span>
    export GIT_AUTHOR_EMAIL=<span class="token string">&quot;$CORRECT_EMAIL&quot;</span>
fi
' --tag-name-filter cat -- --branches --tags
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>2. Usage scenario: How can one change the timestamp of an old commit in Git?</strong></p> <blockquote><p><font size="2">💯Score: 610    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/454750" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter \
    'if [ $GIT_COMMIT = 119f9ecf58069b265ab22f1f97d2b648faf932e0 ]
     then
         export GIT_AUTHOR_DATE=<span class="token string">&quot;Fri Jan 2 21:38:53 2009 -0800&quot;</span>
         export GIT_COMMITTER_DATE=<span class="token string">&quot;Sat May 19 01:01:01 2007 -0700&quot;</span>
     fi'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>3. Usage scenario: Git, rewrite previous commit usernames and emails</strong></p> <blockquote><p><font size="2">💯Score: 316    🔗Associated commands: [ <a href="/./richen/git-config.html">git config</a> ]    🌐<a href="https://stackoverflow.com/questions/11768843" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git config --global alias.change-commits <span class="token string">'!'</span><span class="token string">&quot;f() { VAR=\$1; OLD=\$2; NEW=\$3; shift 3; git filter-branch --env-filter \&quot;if [[ \\\&quot;\$\`echo \$VAR\`\\\&quot; = '\$OLD' ]]; then export \$VAR='\$NEW'; fi\&quot; \$@; }; f&quot;</span>

change-commits=<span class="token string">&quot;!f() { VAR=$1; OLD=$2; NEW=$3; shift 3; git filter-branch --env-filter \&quot;if [[ \\\&quot;$`echo $VAR`\\\&quot; = '$OLD' ]]; then export $VAR='$NEW'; fi\&quot; \$@; }; f&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>4. Usage scenario: How to amend several commits in Git to change author</strong></p> <blockquote><p><font size="2">💯Score: 296    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/4982271" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter 'if [ <span class="token string">&quot;$GIT_AUTHOR_EMAIL&quot;</span> = <span class="token string">&quot;incorrect@email&quot;</span> ]; then
     GIT_AUTHOR_EMAIL=correct@email;
     GIT_AUTHOR_NAME=<span class="token string">&quot;Correct Name&quot;</span>;
     GIT_COMMITTER_EMAIL=$GIT_AUTHOR_EMAIL;
     GIT_COMMITTER_NAME=<span class="token string">&quot;$GIT_AUTHOR_NAME&quot;</span>; fi' -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>5. Usage scenario: Retroactively Correct Authors with Git SVN?</strong></p> <blockquote><p><font size="2">💯Score: 57    🔗Associated commands: [ <a href="/./richen/git-shortlog.html">git shortlog</a> ]    🌐<a href="https://stackoverflow.com/questions/392427" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git shortlog -s

<span class="token comment">#!/bin/sh</span>

git filter-branch --env-filter '

n=$GIT_AUTHOR_NAME
m=$GIT_AUTHOR_EMAIL

case ${GIT_AUTHOR_NAME} in
        user1) n=<span class="token string">&quot;User One&quot;</span> ; m=<span class="token string">&quot;user1@example.com&quot;</span> ;;
        <span class="token string">&quot;User Two&quot;</span>) n=<span class="token string">&quot;User Two&quot;</span> ; m=<span class="token string">&quot;user2@example.com&quot;</span> ;;
esac

export GIT_AUTHOR_NAME=<span class="token string">&quot;$n&quot;</span>
export GIT_AUTHOR_EMAIL=<span class="token string">&quot;$m&quot;</span>
export GIT_COMMITTER_NAME=<span class="token string">&quot;$n&quot;</span>
export GIT_COMMITTER_EMAIL=<span class="token string">&quot;$m&quot;</span>
'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>6. Usage scenario: Remove committer information from git commits</strong></p> <blockquote><p><font size="2">💯Score: 13    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/32944640" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter '
if [ <span class="token string">&quot;$GIT_COMMITTER_EMAIL&quot;</span> != <span class="token string">&quot;$GIT_AUTHOR_EMAIL&quot;</span> ]; then
  export GIT_COMMITTER_NAME=<span class="token string">&quot;$GIT_AUTHOR_NAME&quot;</span>
  export GIT_COMMITTER_EMAIL=<span class="token string">&quot;$GIT_AUTHOR_EMAIL&quot;</span>
  export GIT_COMMITTER_DATE=<span class="token string">&quot;$GIT_AUTHOR_DATE&quot;</span>
fi
' --tag-name-filter cat -- --branches --tags
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>7. Usage scenario: How do I remove an author from a git repository?</strong></p> <blockquote><p><font size="2">💯Score: 11    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/3465700" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter '
    if [ <span class="token string">&quot;$GIT_AUTHOR_NAME&quot;</span> = <span class="token string">&quot;Niko Schwarz&quot;</span> ]; then \
        export GIT_AUTHOR_NAME=<span class="token string">&quot;Jon Doe&quot;</span> GIT_AUTHOR_EMAIL=<span class="token string">&quot;john@bugmenot.com&quot;</span>; \
    fi
    '

$ cd /tmp
$ mkdir filter-branch &amp;&amp; cd filter-branch
<span class="token command">$ git init</span>
Initialized empty Git repository in /private/tmp/filter-branch/.git/
$ 
$ touch hi &amp;&amp; git add . &amp;&amp; git commit -m bla
[master (root-commit) 081f7f5] bla
 0 files changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 hi
$ echo howdi &gt;&gt; hi &amp;&amp; git commit -a -m bla
[master a466a18] bla
 1 files changed, 1 insertions(+), 0 deletions(-)
<span class="token command">$ git log</span>
<span class="token commit-sha1">commit a466a18e4dc48908f7ba52f8a373dab49a6cfee4</span>
Author: Niko Schwarz &lt;niko.schwarz@gmail.com&gt;
Date:   Thu Aug 12 09:43:44 2010 +0200

    bla

<span class="token commit-sha1">commit 081f7f50921edc703b55c04654218fe95d09dc3c</span>
Author: Niko Schwarz &lt;niko.schwarz@gmail.com&gt;
Date:   Thu Aug 12 09:43:34 2010 +0200

    bla
$ 
<span class="token command">$ git filter-branch<span class="token parameter"> --env</span>-filter '</span>
&gt; if [ <span class="token string">&quot;$GIT_AUTHOR_NAME&quot;</span> = <span class="token string">&quot;Niko Schwarz&quot;</span> ]; then \    
&gt; export GIT_AUTHOR_NAME=<span class="token string">&quot;Jon Doe&quot;</span> GIT_AUTHOR_EMAIL=<span class="token string">&quot;john@bugmenot.com&quot;</span>; \
&gt; fi
&gt; '
Rewrite a466a18e4dc48908f7ba52f8a373dab49a6cfee4 (2/2)
Ref <span class="token string">'refs/heads/master'</span> was rewritten
<span class="token command">$ git log</span>
<span class="token commit-sha1">commit 5f0dfc0dc9a325a3f3aaf4575369f15b0fb21fe9</span>
Author: Jon Doe &lt;john@bugmenot.com&gt;
Date:   Thu Aug 12 09:43:44 2010 +0200

    bla

<span class="token commit-sha1">commit 3cf865fa0a43d2343b4fb6c679c12fc23f7c6015</span>
Author: Jon Doe &lt;john@bugmenot.com&gt;
Date:   Thu Aug 12 09:43:34 2010 +0200

    bla
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p><strong>8. Usage scenario: How to update git commit author, but keep original date when amending?</strong></p> <blockquote><p><font size="2">💯Score: 9    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/41303384" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#!/bin/sh</span>

git filter-branch --env-filter '
NEW_NAME=<span class="token string">&quot;MyName&quot;</span>
NEW_EMAIL=<span class="token string">&quot;my-name@my-domain.com&quot;</span>
if [ <span class="token string">&quot;$GIT_COMMIT&quot;</span> = <span class="token string">&quot;afdkjh1231jkh123hk1j23&quot;</span> ] || [ <span class="token string">&quot;$GIT_COMMIT&quot;</span> = <span class="token string">&quot;43hkjwldfpkmsdposdfpsdifn&quot;</span> ]
then
    export GIT_COMMITTER_NAME=<span class="token string">&quot;$NEW_NAME&quot;</span>
    export GIT_COMMITTER_EMAIL=<span class="token string">&quot;$NEW_EMAIL&quot;</span>
    export GIT_AUTHOR_NAME=<span class="token string">&quot;$NEW_NAME&quot;</span>
    export GIT_AUTHOR_EMAIL=<span class="token string">&quot;$NEW_EMAIL&quot;</span>
fi
' --tag-name-filter cat -- --branches --tags
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>9. Usage scenario: How can I update the usernames/emails in Git commits?</strong></p> <blockquote><p><font size="2">💯Score: 8    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/5106251" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>
<span class="token command">$ git filter-branch<span class="token parameter"> --env</span>-filter GIT_AUTHOR_EMAIL=new_address</span>


<span class="token command">$ git filter-branch<span class="token parameter"> --env</span>-filter '</span>
if test <span class="token string">&quot;$GIT_AUTHOR_NAME&quot;</span> = Barry; then
  GIT_AUTHOR_EMAIL=barrys-correct-address
fi'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>10. Usage scenario: how to remove old commits after filter-branch?</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/3223155" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter 'export GIT_AUTHOR_EMAIL=<span class="token string">&quot;fixed-email&quot;</span>;
                                       GIT_AUTHOR_NAME=<span class="token string">&quot;fixed-author&quot;</span>' -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>11. Usage scenario: Git how to edit commit message and preserve old commit date</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/19493602" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter <span class="token string">'GIT_COMMITTER_DATE=$GIT_AUTHOR_DATE; export GIT_COMMITTER_DATE'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>12. Usage scenario: Git interactive rebase (fixup) preserving original date/time stamps on combined commit</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/41210156" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter <span class="token string">'GIT_COMMITTER_DATE=$GIT_AUTHOR_DATE; export GIT_COMMITTER_DATE'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>13. Usage scenario: Shift date for multiple commits</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/39660241" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter '
COMMIT_DATE=$(git log $GIT_COMMIT -n1 --format=%aD);
NEW_DATE=$(date -d <span class="token string">&quot;$COMMIT_DATE+1 day&quot;</span> -R);
GIT_COMMITTER_DATE=<span class="token string">&quot;$NEW_DATE&quot;</span>
export GIT_COMMITTER_DATE
GIT_AUTHOR_DATE=<span class="token string">&quot;$NEW_DATE&quot;</span>
export GIT_AUTHOR_DATE
' SHA..HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>14. Usage scenario: How to remove user commited with user from Pull request?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-rev-parse.html">git rev-parse</a> ]    🌐<a href="https://stackoverflow.com/questions/46362376" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter \
'if test <span class="token string">&quot;$GIT_COMMIT&quot;</span> = <span class="token string">&quot;012345&quot;</span>; then
    export GIT_AUTHOR_NAME=<span class="token string">&quot;Name Here&quot;</span>
    export GIT_COMMITTER_NAME=<span class="token string">&quot;Name Here&quot;</span>
    export GIT_AUTHOR_EMAIL=<span class="token string">&quot;email@here.com&quot;</span>
    export GIT_COMMITTER_EMAIL=<span class="token string">&quot;email@here.com&quot;</span>
fi' &amp;&amp; rm -fr <span class="token string">&quot;$(git rev-parse --git-dir)/refs/original/&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>15. Usage scenario: How to rewrite git history up to a merge commit included</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/59489475" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --env-filter <span class="token string">&quot;......&quot;</span> E^! HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>16. Usage scenario: strip all timestamps from a local git repository</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/21351754" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter '
export GIT_COMMITTER_DATE=2014-01-25T15:00:00
export GIT_AUTHOR_DATE=2014-01-25T15:00:00'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>17. Usage scenario: Export git history, for a file and a subfolder, into another existing git repo?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-cherry-pick.html">git cherry-pick</a>, <a href="/./richen/git-pull.html">git pull</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/56328369" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>cd oldrepo_filt_git
git filter-branch --index-filter <span class="token string">&quot;git rm --cached --ignore-unmatch -r $(bash -O extglob -c 'ls -xd !(a*)')&quot;</span> --prune-empty -- --all

<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter </span><span class="token string">&quot;git rm --cached --ignore-unmatch -r $(bash -O extglob -c 'ls -xd !(a*)')&quot;</span> --prune-empty -- --all
Rewrite 252bf7ff5f385dad880240d5d80e68f24ae09b59 (1/8) (0 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
Rewrite f318d9712cd7aacdb5dd45febbcdbbce6b741e08 (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
Rewrite 00b62e7da8784d45850d7483cbea88fdc4aa844c (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite c618eff47d38412c54a8381a5bacc921bddefe2d (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 2cada8d822d83f37bdc4a37bcfb03047c1cc1ded (5/8) (3 seconds passed, remaining 1 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 7b296b70018f4105f190d06ed4d9c58e3f80532f (5/8) (3 seconds passed, remaining 1 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 18a1ad1d35cd8573c39485d0a29b630325f9727d (7/8) (5 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 2ffbbf03d51363f1ced3aaaf000d5921c9d8b919 (7/8) (5 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>

Ref <span class="token string">'refs/heads/master'</span> was rewritten
Ref <span class="token string">'refs/heads/testbranch'</span> was rewritten

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span><span class="token parameter"> --stat</span></span>
*   31cd8b5 (HEAD -&gt; master) Merge branch <span class="token string">'testbranch'</span>
|\
| * 42b153d (testbranch) change 5 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * ff1be9d change 4 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * 90f050c change 3 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * d2d2136 change 2 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * ab237ac change 1 made
|/
|    a.txt     | 1 +
|    aa/aa.txt | 1 +
|    aa/ab.txt | 1 +
|    3 files changed, 3 insertions(+)
* ea0a32d added a.txt
   a.txt | 1 +
   1 file changed, 1 insertion(+)

git remote add oldrepo ../oldrepo_filt_git/
git pull oldrepo master --allow-unrelated-histories

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span><span class="token parameter"> --stat</span></span>
*   845c81e (HEAD -&gt; master) Merge branch <span class="token string">'master'</span> of ../oldrepo_filt_git
|\
| *   31cd8b5 (oldrepo/master) Merge branch <span class="token string">'testbranch'</span>
| |\
| | * 42b153d (oldrepo/testbranch) change 5 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * ff1be9d change 4 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * 90f050c change 3 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * d2d2136 change 2 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * ab237ac change 1 made
| |/
| |    a.txt     | 1 +
| |    aa/aa.txt | 1 +
| |    aa/ab.txt | 1 +
| |    3 files changed, 3 insertions(+)
| * ea0a32d added a.txt
|    a.txt | 1 +
|    1 file changed, 1 insertion(+)
* 8e99c2d Initial commit by Bob
   README | 1 +
   1 file changed, 1 insertion(+)

<span class="token command">$ git remote add old-repo ../oldrepo_filt_git</span>

<span class="token command">$ git fetch old-repo</span>
warning: no common commits
remote: Enumerating objects: 29, done.
remote: Counting objects: 100% (29/29), done.
remote: Compressing objects: 100% (17/17), done.
remote: Total 29 (delta 2), reused 0 (delta 0)
Unpacking objects: 100% (29/29), done.
From ../oldrepo_filt_git
 * [new branch]      master     -&gt; old-repo/master
 * [new branch]      testbranch -&gt; old-repo/testbranch

<span class="token command">$ git branch oldrepo-head old-repo/master</span>
Branch <span class="token string">'oldrepo-head'</span> set up to track remote branch <span class="token string">'master'</span> from <span class="token string">'old-repo'</span>.

<span class="token command">$ git branch oldrepo-root $(git log oldrepo-head<span class="token parameter"> --reverse</span><span class="token parameter"> --pretty</span>=%H | head<span class="token parameter"> -n</span> 1)</span>

<span class="token command">$ git log<span class="token parameter"> --pretty</span>=</span><span class="token string">'%T %ct'</span> ..oldrepo-head &gt; /tmp/hashlist

<span class="token command">$ git branch<span class="token parameter"> -m</span> master new-master</span>

<span class="token command">$ git cherry-pick<span class="token parameter"> --strategy</span>-option=theirs oldrepo-root</span>
[new-master 427cf77] added a.txt
 Author: tester &lt;tester@example.com&gt;
 Date: Mon May 27 14:31:10 2019 +0200
 1 file changed, 1 insertion(+)
 create mode 100644 a.txt

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span></span>
* 427cf77 (HEAD -&gt; new-master) added a.txt
* 8e99c2d Initial commit by Bob

<span class="token command">$ git rebase<span class="token parameter"> --preserve</span>-merges<span class="token parameter"> --onto</span> new-master<span class="token parameter"> --root</span> oldrepo-head</span>
Successfully rebased and updated refs/heads/oldrepo-head.

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit 61fbe54721a9432e91e48917ed036f55da4105a4 (HEAD -&gt; oldrepo-head)
|\  Merge: 427cf77 f8e8f8a
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:57:00 2019 +0200
| |
| |     Merge branch <span class="token string">'testbranch'</span>
| |
| * commit f8e8f8aedaa7bc999bdfdd49542c9ee04edb770c
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:00 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:58 2019 +0200
| |
| |     change 5 made
| |
| * commit b084029040d6596e0795e7567b2684dc59c02241
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:50 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:56 2019 +0200
| |
| |     change 4 made
| |
| * commit b62dabca3a46efbe76edb10591935db136f74aaa
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:40 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:54 2019 +0200
| |
| |     change 3 made
| |
| * commit 252f3e9697b87b4f59cd0a74681ef25401340fcf
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:30 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:51 2019 +0200
| |
| |     change 2 made
| |
| * commit c382c8a713489ca0e5dc106bed29fdce379952b0
|/  Author:     tester &lt;tester@example.com&gt;
|   AuthorDate: Mon May 27 14:31:20 2019 +0200
|   Commit:     bob &lt;bob@example.com&gt;
|   CommitDate: Tue May 28 12:56:49 2019 +0200
|
|       change 1 made
|
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (new-master)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
|
|     added a.txt
|
* commit 8e99c2d71048b4999d012b33d34386351d6d0fef
  Author:     bob &lt;bob@example.com&gt;
  AuthorDate: Mon May 27 14:31:00 2019 +0200
  Commit:     bob &lt;bob@example.com&gt;
  CommitDate: Mon May 27 14:31:00 2019 +0200

      Initial commit by Bob

<span class="token command">$ git filter-branch<span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(fgrep -m 1 $(git log -1 --pretty=%T $GIT_COMMIT) /tmp/hashlist | cut -d&quot; &quot; -f2)'</span> new-master..oldrepo-head
Rewrite 61fbe54721a9432e91e48917ed036f55da4105a4 (3/6) (1 seconds passed, remaining 1 predicted)
Ref <span class="token string">'refs/heads/oldrepo-head'</span> was rewritten

<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> new-master..oldrepo-head
Rewrite f2b2385d85c74dbf0cbf8fabc02ec30cb50d8f2a (3/6) (1 seconds passed, remaining 1 predicted)
Ref <span class="token string">'refs/heads/oldrepo-head'</span> was rewritten

sd@DESKTOP-RO11QOC MSYS /c/Users/sd/AppData/Local/Temp/newrepo_git
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> 427cf77417a
You must specify a ref to rewrite.

sd@DESKTOP-RO11QOC MSYS /c/Users/sd/AppData/Local/Temp/newrepo_git
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> new-master
Rewrite 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (2/2) (0 seconds passed, remaining 0 predicted)
Ref <span class="token string">'refs/heads/new-master'</span> was rewritten

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit cdaa4b82f3833770a9051a2490487548603e3af8 (HEAD -&gt; oldrepo-head)
|\  Merge: 427cf77 9bfc6cd
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:10 2019 +0200
| |
| |     Merge branch <span class="token string">'testbranch'</span>
| |
...
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (refs/original/refs/heads/new-master)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
|
|     added a.txt
|
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
...

<span class="token command">$ git branch<span class="token parameter"> -m</span> oldrepo-head master</span>
<span class="token command">$ git branch<span class="token parameter"> -D</span> oldrepo-root</span>
Deleted branch oldrepo-root (was ea0a32d).
<span class="token command">$ git branch<span class="token parameter"> -D</span> new-master</span>
Deleted branch new-master (was 4ac225e).
$ rm .git/refs/original/refs/heads/new-master
<span class="token command">$ git remote remove old-repo</span>

<span class="token command">$ git branch tmp 427cf774</span>
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> tmp^..tmp
Rewrite 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (1/1) (0 seconds passed, remaining 0 predicted)
Ref <span class="token string">'refs/heads/tmp'</span> was rewritten
<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller tmp</span>
* commit 4ac225e308e280e3a96be0168c6e9dece44d4979 (tmp)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Mon May 27 14:31:10 2019 +0200
|
|     added a.txt
|
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
|
...
<span class="token command">$ git branch<span class="token parameter"> -D</span> tmp</span>
Deleted branch tmp (was 4ac225e).

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit cdaa4b82f3833770a9051a2490487548603e3af8
|\  Merge: 427cf77 9bfc6cd
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:10 2019 +0200
| | 
| |     Merge branch <span class="token string">'testbranch'</span>
| | 
| * commit 9bfc6cde58be9102102f839e5cc0fe8f25f0f78c
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:00 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:00 2019 +0200
| | 
| |     change 5 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 485ae0f50054610b6a41098fb695e59d194cc856
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:50 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:50 2019 +0200
| | 
| |     change 4 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit b6804b6e8e313b5c4766568a287f0785503e3a11
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:40 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:40 2019 +0200
| | 
| |     change 3 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 8b463423d2a99929a6a248e38ba1368a56d3769d
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:30 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:30 2019 +0200
| | 
| |     change 2 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 3bc0bed30ebea1498a15711825b2ea8347cc374d
|/  Author:     tester &lt;tester@example.com&gt;
|   AuthorDate: Mon May 27 14:31:20 2019 +0200
|   Commit:     bob &lt;bob@example.com&gt;
|   CommitDate: Mon May 27 14:31:20 2019 +0200
|   
|       change 1 made
|   
|    a.txt     | 1 +
|    aa/aa.txt | 1 +
|    aa/ab.txt | 1 +
|    3 files changed, 3 insertions(+)
| 
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
| 
|     added a.txt
| 
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
| 
* commit 8e99c2d71048b4999d012b33d34386351d6d0fef
  Author:     bob &lt;bob@example.com&gt;
  AuthorDate: Mon May 27 14:31:00 2019 +0200
  Commit:     bob &lt;bob@example.com&gt;
  CommitDate: Mon May 27 14:31:00 2019 +0200

      Initial commit by Bob

   README | 1 +
   1 file changed, 1 insertion(+)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br></div></div><p><strong>18. Usage scenario: Git filter branch from HEAD</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/30422785" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter <span class="token string">'GIT_COMMITTER_DATE=$GIT_AUTHOR_DATE; export GIT_COMMITTER_DATE'</span> HEAD~7..HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>19. Usage scenario: How to change author of specific commits based on a predicate</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-show.html">git show</a> ]    🌐<a href="https://stackoverflow.com/questions/69059500" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter '
if git show -s --format=<span class="token string">&quot;%s&quot;</span> $GIT_COMMIT | grep <span class="token string">&quot;My commit message&quot;</span>;
then
    export GIT_AUTHOR_NAME=<span class="token string">&quot;New Name&quot;</span>
    export GIT_AUTHOR_EMAIL=<span class="token string">&quot;new@email.com&quot;</span>
fi
' --tag-name-filter cat -- --branches --tags
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>20. Usage scenario: Git change user's credentials in past commits without changing the history (date of commits)</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/64854924" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --env-filter &quot;
 GIT_AUTHOR_NAME=<span class="token string">'newName'</span>
 GIT_AUTHOR_EMAIL=<span class="token string">'newEmail'</span>
 GIT_COMMITER_NAME=<span class="token string">'newName'</span>
 GIT_COMMITER_EMAIL=<span class="token string">'newEmail'</span>
&quot; HEAD

git filter-branch -f --env-filter &quot;
if test <span class="token string">&quot;$GIT_AUTHOR_EMAIL&quot;</span> = <span class="token string">'currentWrongEmail'</span>
then
    GIT_AUTHOR_EMAIL=<span class="token string">'newEmail'</span>
fi
if test <span class="token string">&quot;$GIT_COMMITTER_EMAIL&quot;</span> = <span class="token string">'currentWrongEmail'</span>
then
    GIT_COMMITTER_EMAIL=<span class="token string">'newEmail'</span>
fi
&quot; HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>21. Usage scenario: Change GIT_AUTHOR_DATE/GIT_COMMITTER_DATE date of a specific previous commit on git</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/43008328" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter \
    [snip actual filter] \
    HEAD ^&lt;hash&gt;

git filter-branch --env-filter \
    [snip actual filter] \
    HEAD ^master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>22. Usage scenario: Importing History from SVN to Git - Change Committer Information</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/1643935" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter '
export GIT_COMMITTER_EMAIL=<span class="token string">&quot;$GIT_AUTHOR_EMAIL&quot;</span>
export GIT_COMMITTER_NAME=<span class="token string">&quot;$GIT_AUTHOR_NAME&quot;</span>
export GIT_COMMITTER_DATE=<span class="token string">&quot;$GIT_AUTHOR_DATE&quot;</span>' -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>23. Usage scenario: How to delete a commit that &quot;hasn't happened yet&quot;?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/53220592" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --env-filter \
    'if [ $GIT_COMMIT = 03...]
     then
         export GIT_AUTHOR_DATE=<span class="token string">&quot;Fri Jan 2 21:38:53 2009 -0800&quot;</span>
         export GIT_COMMITTER_DATE=<span class="token string">&quot;Sat May 19 01:01:01 2007 -0700&quot;</span>
     fi' SHA1..HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>24. Usage scenario: Update Author Name in all Commits in git after particular date</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-cat-file.html">git cat-file</a> ]    🌐<a href="https://stackoverflow.com/questions/43423421" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ How to test dates in git filter-branch
<span class="token command">$ git cat-file<span class="token parameter"> -p</span> HEAD | sed </span><span class="token string">'s/@/ /'</span>
tree 52cbd85298ed8ee95776f93ddb0eede02a36c539
parent 71e38d40e93aa1357dad53f1599c2a1c00b54dc5
author Junio C Hamano &lt;gitster pobox.com&gt; 1491895625 -0700
committer Junio C Hamano &lt;gitster pobox.com&gt; 1491895625 -0700

Eleventh batch for 2.13

Signed-off-by: Junio C Hamano &lt;gitster pobox.com&gt;

author Hiroshi Shirosaki &lt;h.shirosaki gmail.com&gt; 1488779947 +0900
committer Eric Wong &lt;e 80x24.org&gt; 1488922143 +0000

$ date -r 1491000000
Fri Mar 31 15:40:00 PDT 2017

date_exceeds_1491000000() {
    test $1 -ge 1491000000
}

if date_exceeds_1491000000 $GIT_AUTHOR_DATE

git filter-branch ... --since=2017-03-31 ...

...--E--F--G--H--...

...--E<span class="token string">'--G'</span>--...

▲ Summary, plus simplest method of all
git filter-branch --env-filter ...your-filter-here... \
    --tag-name-filter cat -- --branches --tags \
    ^123456789abcdef ^feedbeefdeadc0ffee
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="tree-filter"><a href="#tree-filter" class="header-anchor">#</a> 🔹 --tree-filter</h2> <p><strong>1. Usage scenario: Remove folder and its contents from git/GitHub's history</strong></p> <blockquote><p><font size="2">💯Score: 643    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/17824718" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">&quot;rm -rf node_modules&quot;</span> --prune-empty HEAD
git for-each-ref --format=<span class="token string">&quot;%(refname)&quot;</span> refs/original/ | xargs -n 1 git update-ref -d
echo node_modules/ &gt;&gt; .gitignore
git add .gitignore
git commit -m <span class="token string">'Removing node_modules from git history'</span>
git gc
git push origin master --force
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>2. Usage scenario: How to remove/delete a large file from commit history in the Git repository?</strong></p> <blockquote><p><font size="2">💯Score: 248    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/30274113" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'rm -f DVD-rip'</span> HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>3. Usage scenario: How can I completely remove a file from a git repository?</strong></p> <blockquote><p><font size="2">💯Score: 142    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/3459399" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git filter-branch<span class="token parameter"> --tree</span>-filter </span><span class="token string">'rm -f my_file'</span> HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>4. Usage scenario: How can I move a directory in a Git repo for all commits?</strong></p> <blockquote><p><font size="2">💯Score: 102    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/3142821" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ You can use the subdirectory filter to achieve this
<span class="token command"> $ git filter-branch<span class="token parameter"> --subdirectory</span>-filter blog/ --<span class="token parameter"> --all</span></span>

▲ EDIT 1: If you don't want to effectively make _posts the root, use a tree-filter instead:
<span class="token command"> $ git filter-branch<span class="token parameter"> --tree</span>-filter </span><span class="token string">'mv blog/_posts .'</span> HEAD

▲ EDIT 2: If blog/_posts did not exist in some of the commits, the above will fail. Use this instead:
<span class="token command"> $ git filter-branch<span class="token parameter"> --tree</span>-filter </span><span class="token string">'test -d blog/_posts &amp;&amp; mv blog/_posts . || echo &quot;Nothing to do&quot;'</span> HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>5. Usage scenario: git: change one line in file for the complete history</strong></p> <blockquote><p><font size="2">💯Score: 53    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/7198036" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'sed -i &quot;/sensitive information/ d&quot; filename'</span> -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>6. Usage scenario: How to substitute text from files in git history?</strong></p> <blockquote><p><font size="2">💯Score: 41    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/4114121" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter &quot;find . -name <span class="token string">'*.php'</span> -exec sed -i -e \
    <span class="token string">'s/originalpassword/newpassword/g'</span> {} \;&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>7. Usage scenario: Rename file for all commits in a Git repository</strong></p> <blockquote><p><font size="2">💯Score: 21    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/9458637" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter '
if [ -f &lt;old name&gt; ]; then
  mv &lt;old name&gt; &lt;new name&gt;
fi' --force HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>8. Usage scenario: How do I preserve tags when filtering a repository?</strong></p> <blockquote><p><font size="2">💯Score: 15    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/5574694" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> git filter-branch --tree-filter <span class="token string">'move-to-subdir $subdir'</span> --prune-empty --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>9. Usage scenario: Split one subfolder from git repository with all branches and history</strong></p> <blockquote><p><font size="2">💯Score: 12    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/47084338" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git clone https://github.com/USERNAME/REPOSITORY-NAME</span>
$ cd REPOSITORY-NAME

$ for i in $(git branch -r | sed <span class="token string">&quot;s/.*origin\///&quot;</span>); do git branch -t $i origin/$i; done

<span class="token command">$ git filter-branch<span class="token parameter"> --prune</span>-empty<span class="token parameter"> --subdirectory</span>-filter FOLDER-NAME --<span class="token parameter"> --all</span></span>

<span class="token command">$ git filter-branch<span class="token parameter"> --prune</span>-empty<span class="token parameter"> --tree</span>-filter </span><span class="token string">'rm -rf FOLDER-NAME'</span> -- --all

<span class="token command">$ git remote<span class="token parameter"> -v</span></span>
origin  https://github.com/USERNAME/REPOSITORY-NAME.git (fetch)
origin  https://github.com/USERNAME/REPOSITORY-NAME.git (push)
<span class="token command">$ git remote set-url origin https://github.com/USERNAME/NEW-REPOSITORY-NAME.git</span>
<span class="token command">$ git remote<span class="token parameter"> -v</span></span>
origin  https://github.com/USERNAME/NEW-REPOSITORY-NAME.git (fetch)
origin  https://github.com/USERNAME/NEW-REPOSITORY-NAME.git (push)

<span class="token command">$ git push<span class="token parameter"> -u</span> origin<span class="token parameter"> --all</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>10. Usage scenario: Definitive retroactive .gitignore (how to make Git completely/retroactively forget about a file now in .gitignore)</strong></p> <blockquote><p><font size="2">💯Score: 11    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-ls-files.html">git ls-files</a>, <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/57454176" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#commit up-to-date .gitignore (if not already existing)</span>
<span class="token comment">#these commands must be run on each branch</span>
<span class="token comment">#these commands are not strictly necessary if you don't want/need a .gitignore file.  .git/info/exclude can be used instead</span>

git add .gitignore
git commit -m <span class="token string">&quot;Create .gitignore&quot;</span>

<span class="token comment">#apply standard git ignore behavior only to current index, not working directory (--cached)</span>
<span class="token comment">#if this command returns nothing, ensure /.git/info/exclude AND/OR .gitignore exist</span>
<span class="token comment">#this command must be run on each branch</span>
<span class="token comment">#if using .git/info/exclude, it will need to be modified per branch run, if the branches have differing (per-branch) .gitignore requirements.</span>

git ls-files -z --ignored --exclude-standard | xargs -r0 git rm --cached

<span class="token comment">#Commit to prevent working directory data loss!</span>
<span class="token comment">#this commit will be automatically deleted by the --prune-empty flag in the following command</span>
<span class="token comment">#this command must be run on each branch</span>
<span class="token comment">#optionally use the --amend flag to merge this commit with the previous one instead of creating 2 commits.</span>

git commit -m <span class="token string">&quot;ignored index&quot;</span>

<span class="token comment">#Apply standard git ignore behavior RETROACTIVELY to all commits from all branches (--all)</span>
<span class="token comment">#This step WILL delete ignored files from working directory UNLESS they have been dereferenced from the index by the commit above</span>
<span class="token comment">#This step will also delete any &quot;empty&quot; commits.  If deliberate &quot;empty&quot; commits should be kept, remove --prune-empty and instead run git reset HEAD^ immediately after this command</span>

git filter-branch --tree-filter <span class="token string">'git ls-files -z --ignored --exclude-standard | xargs -r0 git rm -f --ignore-unmatch'</span> --prune-empty --tag-name-filter cat -- --all

<span class="token comment">#List all still-existing files that are now ignored properly</span>
<span class="token comment">#if this command returns nothing, it's time to restore from backup and start over</span>
<span class="token comment">#this command must be run on each branch</span>

git ls-files --other --ignored --exclude-standard

git push origin --force --all
git push origin --force --tags
git for-each-ref --format=<span class="token string">&quot;delete %(refname)&quot;</span> refs/original | git update-ref --stdin
git reflog expire --expire=now --all
git gc --prune=now

<span class="token comment">#fetch modified remote</span>

git fetch --all

<span class="token comment">#&quot;Pull&quot; changes WITHOUT deleting newly-ignored files from working directory</span>
<span class="token comment">#This will overwrite local tracked files with remote - ensure any local modifications are backed-up/stashed</span>

git reset FETCH_HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p><strong>11. Usage scenario: How to move function declaration to another file yet retain Git history?</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/17961452" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter 'if [ -f original.php ]; then 
    echo part1.php part2.php part3.php | xargs -n 1 cp original.php; fi' HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>12. Usage scenario: Splitting many subdirectories into a new, separate Git repository</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/31841516" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> git filter-branch --tree-filter <span class="token string">&quot;mkdir samples &amp;&amp; test -d app1 &amp;&amp; mv app1 samples/|| test -d app2 &amp;&amp; mv app2 samples/ || echo 'nothing to do'&quot;</span> HEAD

git filter-branch -f --subdirectory-filter samples -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>13. Usage scenario: How do you rename a folder in git and hide it with an interactive rebase?</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ <a href="/./richen/git-reset.html">git reset</a> ]    🌐<a href="https://stackoverflow.com/questions/15389910" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git reset --hard HEAD^ # removes the rename commit
git filter-branch --tree-filter <span class="token string">&quot;mv bad good&quot;</span> foo^..HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>14. Usage scenario: How can I extract a portion of a git repository into it's own repo while retaining history and file structure?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-merge.html">git merge</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-read-tree.html">git read-tree</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/25316857" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone initial final
cd final
git filter-branch --tree-filter <span class="token string">'rm -rf &lt;list of folders separated by space&gt;'</span> HEAD

git filter-branch -f --prune-empty 

 git filter-branch –prune-empty –subdirectory-filter A/ master
 git filter-branch –prune-empty –subdirectory-filter B/ master

git clone &lt;remote path&gt; NewRepo
cd NewRepo

<span class="token comment"># add a readme file</span>
touch Readme.md
git add .
git commit -am <span class="token string">&quot;Adding ReadMe file&quot;</span>

<span class="token comment"># Merge Repo A</span>
git remote add -f A &lt;remote path for A&gt;
git merge -s ours --no-commit A/master
git read-tree --prefix=A/ -u A/master
git commit -m <span class="token string">&quot;Merge A into NewRepo&quot;</span>
git remote remove A

<span class="token comment"># Merge Repo B</span>
git remote add -f B &lt;remote path for B&gt;
git merge -s ours --no-commit B/master
git read-tree --prefix=B/ -u B/master
git commit -m <span class="token string">&quot;Merge B into NewRepo&quot;</span>
git remote remove B

git remote add origin &lt;remote path for NewRepo&gt;
git push origin master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p><strong>15. Usage scenario: How to use git-filter-repo to merge one repo as subdirectory into another</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-ls-tree.html">git ls-tree</a> ]    🌐<a href="https://stackoverflow.com/questions/61450995" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --prune-empty --tree-filter '
        mkdir -p <span class="token string">&quot;${REPO_NAME}_tmp&quot;</span>
        git ls-tree --name-only $GIT_COMMIT | xargs -I{} mv {} <span class="token string">&quot;${REPO_NAME}_tmp&quot;</span>
        mv <span class="token string">&quot;${REPO_NAME}_tmp&quot;</span> <span class="token string">&quot;$REPO_NAME&quot;</span>
    '
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>16. Usage scenario: Rename variable in all commits on a given branch</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/39608848" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'sed -i &quot;s/foo/bar/g&quot; $FILES'</span>  D^..H HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>17. Usage scenario: Remove old folder from a public git repo</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/7604807" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">&quot;rm -r vendor/*&quot;</span> HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>18. Usage scenario: efficiently rewriting (rebase -i) a lot of history with git</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/10919879" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --tree-filter <span class="token string">'[[ -f README ]] &amp;&amp; echo &quot;---FOOTER---&quot; &gt;&gt; README'</span> HEAD

git filter-branch -d /dev/shm/git --tree-filter \
<span class="token string">'perl /path/to/find-add-license.pl'</span> --prune-empty HEAD

git filter-branch -d /dev/shm/git --tree-filter \
<span class="token string">'find . -name &quot;*.[chS]&quot; -exec perl /path/to/just-add-license.pl \{\} \;'</span> \
<span class="token deleted">--prune-empty HEAD</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>19. Usage scenario: Git subtree split two directories</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/25575441" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git filter-branch<span class="token parameter"> --tree</span>-filter </span><span class="token string">'rm -rf tests/http src/http'</span> --prune-empty HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>20. Usage scenario: Splitting each commit by file?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-rebase.html">git rebase</a> ]    🌐<a href="https://stackoverflow.com/questions/34556655" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ git rebase -i aka: squash (manual procedure)
// Manipulate any commit by editing it and commitign again
git rebase -i HEAD~X

▲ git filter-branch
▲ sample
// Remove any given file from commits 
// Now you can commit it again into a new commit

git filter-branch --tree-filter 'rm -f &lt;file name&gt; HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>21. Usage scenario: How to replace a string in a whole Git history?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/47158332" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ censorStringsInWholeGitHistory.sh:
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#arguments are strings to censore</span>

for string in <span class="token string">&quot;$@&quot;</span>
do
  echo <span class="token string">&quot;&quot;</span>
  echo <span class="token string">&quot;================ Censoring string &quot;</span>$string<span class="token string">&quot;: ================&quot;</span>
  ~/replaceStringInWholeGitHistory.sh <span class="token string">&quot;$string&quot;</span> <span class="token string">&quot;********&quot;</span>
done

~/censorStringsInWholeGitHistory.sh <span class="token string">&quot;my_password1&quot;</span> <span class="token string">&quot;my_password2&quot;</span> <span class="token string">&quot;some_f_word&quot;</span>

▲ replaceStringInWholeGitHistory.sh:
<span class="token comment">#!/bin/bash</span>
<span class="token comment"># $1 - string to find</span>
<span class="token comment"># $2 - string to replace with</span>

for branch in $(git branch | cut -c 3-); do
  echo <span class="token string">&quot;&quot;</span>
  echo <span class="token string">&quot;&gt;&gt;&gt; Replacing strings in branch $branch:&quot;</span>
  echo <span class="token string">&quot;&quot;</span>
  ~/replaceStringInBranch.sh <span class="token string">&quot;$branch&quot;</span> <span class="token string">&quot;$1&quot;</span> <span class="token string">&quot;$2&quot;</span>
done

~/replaceStringInWholeGitHistory.sh <span class="token string">&quot;my_password&quot;</span> <span class="token string">&quot;********&quot;</span>

▲ replaceStringInBranch.sh:
<span class="token comment">#!/bin/bash</span>
<span class="token comment"># $1 - branch</span>
<span class="token comment"># $2 - string to find</span>
<span class="token comment"># $3 - string to replace with</span>

git checkout $1
for file in $(~/findFilesContainingStringInBranch.sh <span class="token string">&quot;$2&quot;</span>); do
  echo <span class="token string">&quot;          Filtering file $file:&quot;</span>
  ~/changeStringsInFileInCurrentBranch.sh <span class="token string">&quot;$file&quot;</span> <span class="token string">&quot;$2&quot;</span> <span class="token string">&quot;$3&quot;</span>
done

~/replaceStringInBranch.sh master <span class="token string">&quot;my_password&quot;</span> <span class="token string">&quot;********&quot;</span>

▲ findFilesContainingStringInBranch.sh:
<span class="token comment">#!/bin/bash</span>

<span class="token comment"># $1 - string to find</span>
<span class="token comment"># $2 - branch name or nothing (current branch in that case)</span>

git log -S <span class="token string">&quot;$1&quot;</span> $2 --name-only --pretty=format: -- | sort -u

~/findFilesContainingStringInBranch.sh <span class="token string">&quot;my_password&quot;</span> master

▲ changeStringsInFileInCurrentBranch.sh:
<span class="token comment">#!/bin/bash</span>

<span class="token comment"># $1 - file name</span>
<span class="token comment"># $2 - string to find</span>
<span class="token comment"># $3 - string to replace</span>

git filter-branch -f --tree-filter <span class="token string">&quot;if [ -f $1 ];then sed -i s/$2/$3/g $1;fi&quot;</span>

~/changeStringsInFileInCurrentBranch.sh <span class="token string">&quot;abc.txt&quot;</span> <span class="token string">&quot;my_password&quot;</span> <span class="token string">&quot;********&quot;</span>

git push &lt;remote&gt; -f --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><p><strong>22. Usage scenario: In Git, how to squash all commits related to a file or folder?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/28960267" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'rm -rf FOLDERNAME'</span> HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>23. Usage scenario: Rename directory throughout Git commit history</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/26642892" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --force --tree-filter \
    <span class="token string">'mkdir -p foo/bar; mv baz foo/bar/ || true'</span> \
    --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>24. Usage scenario: Split file into separate repository, preserving history</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/43004729" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'find -type f -not -path ./foo/bar -delete'</span> --prune-empty
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>25. Usage scenario: How to rebase git submodule preserving references to submodule commits from git repository containing the submodule?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-for-each-ref.html">git for-each-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/40199538" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> cd /submodule/repo/just/rewritten/
 # the old history is still available in refs/original
 git -C /path/to/rewritten/repo for-each-ref --format=<span class="token string">&quot;%(refname)&quot;</span> refs/original

 cd /main/repo
git for-each-ref --contains &lt;SHA1&gt; # SHA being a SHA1 from the old submodule history

git filter-branch --prune-empty --tree-filter <span class="token string">'change_gitlink'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>26. Usage scenario: How do I merge git repositories with related branches</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-merge.html">git merge</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/16843402" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>
git clone --mirror path/repo0 repo0
git filter-branch --tree-filter <span class="token string">&quot;(mkdir -p proj0 ; find * -maxdepth 0 ! -iname proj0 -exec mv {} proj0/ \;)&quot;</span> -- --all

git clone --mirror path/repo1 repo1
git filter-branch --tree-filter <span class="token string">&quot;(mkdir -p proj1 ; find * -maxdepth 0 ! -iname proj1 -exec mv {} proj1/ \;)&quot;</span> -- --all


git init new
git remote add proj0 path/repo0
git remote add proj1 path/repo1

git fetch --all


git checkout -b dummy remotes/proj0/BranchE
git checkout -b start `git log --topo-order --reverse | head -n 1 | sed s/<span class="token string">&quot;commit \(.*\)&quot;</span>/<span class="token string">&quot;\1&quot;</span>/`
git checkout -b merge start

git merge -m <span class="token string">&quot;merge&quot;</span> remotes/proj1/BranchE
git rebase --onto start start merge

git branch -D start
git branch -D dummy
git branch -m merge BranchE


git checkout BranchE
git rebase `git log --oneline | grep <span class="token string">&quot;commit comment of last common commit B'&quot;</span> | sed -r s/<span class="token string">&quot;(^[a-f0-9]+) .*&quot;</span>/<span class="token string">&quot;\1&quot;</span>/` BranchH
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p><strong>27. Usage scenario: Removing all deleted files from git repo history w search command</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/37759578" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git log --all --pretty=format: --name-only --diff-filter=D | sort -u | while read -r line; do git filter-branch -f --tree-filter <span class="token string">&quot;rm -rf { $line }&quot;</span> HEAD; done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>28. Usage scenario: How to remove some files accidentally added in the first commit?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/20808429" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'rm fileToRemove'</span> --prune-empty --force HEAD

git filter-branch --tree-filter <span class="token string">'rm -fR dirToRemove'</span> --prune-empty --force HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>29. Usage scenario: Rebase or Merge Git branch but Keep Deleted Files</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-diff.html">git diff</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-merge-base.html">git merge-base</a> ]    🌐<a href="https://stackoverflow.com/questions/45110449" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ If my_branch is as linear as you depict - no merge commits on the branch - then you could probably get by with an interactive rebase.
git rebase --interactive master my_branch

git diff --diff-filter D --no-renames --name-only HEAD^

git checkout HEAD^ -- path/and/filename

git add .
git commit --amend

▲ The above rebase command will also complete the rebasing of your work onto the tip of master.  If you don't want that - e.g. if you want to merge the work into master instead - you could do something like
git rebase --interactive `git merge-base my_branch master` my_branch

git checkout `git merge-base master my_branch`
cp all/the/files/that/were/deleted some/path/where/I/can/find/them/later

git filter-branch --tree-filter <span class="token string">'cp some/path/where/I/can/find/them/later all/the/files/that/were/deleted'</span> -- my_branch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>30. Usage scenario: Apply change to all commits</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/66122950" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">&quot;sed -i 's/import my.wrong.package/import my.right.package;/g' target_file&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>31. Usage scenario: How to keep the git commit history of a nested subdirectory when creating a submodule?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/34664914" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone https://github.com/my-repo/ProjectA.git
cd ProjectA
git remote rm origin

git filter-branch -f --tree-filter <span class="token string">'shopt -s dotglob nullglob; test -d FrameworkB &amp;&amp; mv FrameworkB/* . || :'</span> HEAD

git filter-branch -f --tree-filter <span class="token string">'shopt -s dotglob nullglob; test -d FrameworkB/FrameworkB &amp;&amp; mv FrameworkB/FrameworkB/* FrameworkB/. || :'</span> HEAD

rm -r -f ProjectA/
rm -r -f ProjectA.xcodeproj
git commit -a -m <span class="token string">&quot;Remove the project files not associated with the shared framework.&quot;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>32. Usage scenario: git surgery - splitting a repository and modifying the directory structure</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/4675317" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'mv bar baz foo; rm *'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>33. Usage scenario: Move history from git repo to subtree</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-pull.html">git pull</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-remote.html">git remote</a> ]    🌐<a href="https://stackoverflow.com/questions/32291121" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone &lt;git repository A url&gt;
cd &lt;git repository A directory&gt;
git remote rm origin
git filter-branch --subdirectory-filter &lt;directory 1&gt; --

git clone &lt;git repository B url&gt;
cd &lt;git repository B directory&gt;
git remote add repo-A-branch &lt;git repository A directory&gt;
git pull repo-A-branch master
git remote rm repo-A-branch

git filter-branch --tree-filter <span class="token string">'rm -rf &lt;bad subdirectory&gt;'</span> --prune-empty HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>34. Usage scenario: git rebase squash messes up branches history</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-diff.html">git diff</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-apply.html">git apply</a> ]    🌐<a href="https://stackoverflow.com/questions/56113281" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git diff 971f217200f7e485308b861033b5b31b7ae69d1a \
         081792ccf9b4714ab4bce23e4e7b126647eeead8 \
         &gt;patch.txt
git filter-branch --tree-filter '\
   if [ <span class="token string">&quot;$GIT_COMMIT&quot;</span> == <span class="token string">&quot;971f217200f7e485308b861033b5b31b7ae69d1a&quot;</span> ]
   then
       git apply /localdirectory/patch.txt
   fi' \
   --prune-empty -- --all

git update-ref -d refs/original/refs/heads/master

git log --graph --all

*   commit e905116fed7f4d52c65da46ab6172ae7a08e824a (HEAD -&gt; master)
|\  Merge: 77cc483 584a037
| | Author: 
| | Date:   
| | 
| |     Merge branch <span class="token string">'test'</span>
| | 
| * commit 584a03768822ebd92d4feee20ebe238fffd89c25
| | Author: 
| | Date:   
| | 
| |     test3
| | 
| * commit 7a2ad09b5c39e5076cd22fa957c2d539e37c0861
| | Author: 
| | Date:   
| | 
| |     test2
| | 
| * commit 11ef4fea5ba207a637a85d8e8456f48d0c7bd7ab
| | Author: 
| | Date:   
| | 
| |     test1
| | 
* | commit 77cc4833cf5aac84aca9737945fd79a7632019ac
|/  Author: 
|   Date:   
|   
|       4
| 
* commit 971f217200f7e485308b861033b5b31b7ae69d1a
| Author: 
| Date:  
| 
|     2
| 
* commit cef186ae9ad0e316d82c62c2082381747f25a443
  Author: 
  Date:  

      1

git filter-branch --msg-filter <span class="token string">'sed &quot;s/^2/2 and 3 together/&quot;'</span> -- --all
git update-ref -d refs/original/refs/heads/master

git update-ref -d refs/original/refs/heads/test
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br></div></div><p><strong>35. Usage scenario: Rename folder in Git. All branches and all revisions</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/43742418" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter '
if [ -d <span class="token string">&quot;61571_delivery &quot;</span> ]; then
  mv <span class="token string">&quot;61571_delivery &quot;</span> <span class="token string">&quot;61571_delivery&quot;</span>
fi' --force HEAD

git filter-branch --tree-filter '
if [ -d <span class="token string">&quot;raisesoft/61571_delivery &quot;</span> ]; then
  mv <span class="token string">&quot;raisesoft/61571_delivery &quot;</span> <span class="token string">&quot;raisesoft/61571_delivery&quot;</span>
fi' --force HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>36. Usage scenario: Need to safely remove corrupted file from GitLab</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a> ]    🌐<a href="https://stackoverflow.com/questions/35638035" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'mv &quot;&lt;div class=\&quot;contain pr\&quot;&gt;&quot; some_safe_name ||:'</span> &lt;all branches where the problematic files exists&gt;

git filter-branch --index-filter <span class="token string">'git rm --cached &quot;&lt;div class=\&quot;contain pr\&quot;&gt;&quot;  ||:'</span> master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>37. Usage scenario: Accidentally committed dev database to Git</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/2603701" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>  git filter-branch --tree-filter ´rm filename´ HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="index-filter"><a href="#index-filter" class="header-anchor">#</a> 🔹 --index-filter</h2> <p><strong>1. Usage scenario: How to remove file from Git history?</strong></p> <blockquote><p><font size="2">💯Score: 231    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a> ]    🌐<a href="https://stackoverflow.com/questions/52643437" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --index-filter <span class="token string">&quot;git rm -rf --cached --ignore-unmatch path_to_file&quot;</span> HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>2. Usage scenario: Split large Git repository into many smaller ones</strong></p> <blockquote><p><font size="2">💯Score: 81    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/3910697" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone MyHugeRepo/ MyABRepo.tmp/
cd MyABRepo.tmp
git filter-branch --prune-empty --index-filter <span class="token string">'git rm --cached --ignore-unmatch DIR_1/* DIR_2/*'</span> HEAD 

cd ..
git clone MyABRepo.tmp MyABRepo

git clone MyHugeRepo/ MyABRepo.tmp/
cd MyABRepo.tmp
git filter-branch -d /tmp/git-rewrite.tmp --prune-empty --index-filter <span class="token string">'git rm --cached --ignore-unmatch DIR_1/* DIR_2/*'</span> HEAD 
cd ..
git clone MyABRepo.tmp MyABRepo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>3. Usage scenario: New repo with copied history of only currently tracked files</strong></p> <blockquote><p><font size="2">💯Score: 45    🔗Associated commands: [ <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-ls-files.html">git ls-files</a>, <a href="/./richen/git-gc.html">git gc</a> ]    🌐<a href="https://stackoverflow.com/questions/17909526" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Delete everything and restore what you want
<span class="token comment"># for unix</span>

<span class="token command">$ git checkout master</span>
<span class="token command">$ git ls-files &gt; keep-these.txt</span>
<span class="token command">$ git filter-branch<span class="token parameter"> --force</span><span class="token parameter"> --index</span>-filter \</span>
  &quot;git rm  --ignore-unmatch --cached -qr . ; \
  cat $PWD/keep-these.txt | tr <span class="token string">'\n'</span> <span class="token string">'\0'</span> | xargs -d <span class="token string">'\0'</span> git reset -q \$GIT_COMMIT --&quot; \
  --prune-empty --tag-name-filter cat -- --all

<span class="token comment"># for macOS</span>

<span class="token command">$ git checkout master</span>
<span class="token command">$ git ls-files &gt; keep-these.txt</span>
<span class="token command">$ git filter-branch<span class="token parameter"> --force</span><span class="token parameter"> --index</span>-filter \</span>
  &quot;git rm  --ignore-unmatch --cached -qr . ; \
  cat $PWD/keep-these.txt | tr <span class="token string">'\n'</span> <span class="token string">'\0'</span> | xargs -0 git reset -q \$GIT_COMMIT --&quot; \
  --prune-empty --tag-name-filter cat -- --all

▲ Cleanup steps
$ rm -rf .git/refs/original/
<span class="token command">$ git reflog expire<span class="token parameter"> --expire</span>=now<span class="token parameter"> --all</span></span>
<span class="token command">$ git gc<span class="token parameter"> --prune</span>=now</span>

<span class="token comment"># optional extra gc. Slow and may not further-reduce the repo size</span>
<span class="token command">$ git gc<span class="token parameter"> --aggressive</span><span class="token parameter"> --prune</span>=now</span>

▲ $GIT_COMMIT?
<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter </span><span class="token string">&quot;echo current commit is \$GIT_COMMIT&quot;</span>
Rewrite d832800a85be9ef4ee6fda2fe4b3b6715c8bb860 (1/xxxxx)current commit is d832800a85be9ef4ee6fda2fe4b3b6715c8bb860
Rewrite cd86555549ac17aeaa28abecaf450b49ce5ae663 (2/xxxxx)current commit is cd86555549ac17aeaa28abecaf450b49ce5ae663
...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p><strong>4. Usage scenario: How to delete the old history after running git filter-branch?</strong></p> <blockquote><p><font size="2">💯Score: 40    🔗Associated commands: [ <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/5985276" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ After importing a Subversion repository with multiple years of history, I ran into a similar problem with bloat from lots of binary assets. In git: shrinking Subversion import, I describe trimming my git repo from 4.5 GiB to around 100 MiB.
<span class="token command">$ git filter-branch<span class="token parameter"> -d</span> /dev/shm/git<span class="token parameter"> --index</span>-filter \</span>
  &quot;git rm --cached -f --ignore-unmatch media/Optika.1.3.?.*; \
   git rm --cached -f --ignore-unmatch media/lens.svg; \
   git rm --cached -f --ignore-unmatch media/lens_simulation.swf; \
   git rm --cached -f --ignore-unmatch media/v.html&quot; \
  --tag-name-filter cat --prune-empty -- --all
▲ If you're happy with the newly rewritten history, then delete the backup copies.
<span class="token command">$ git for-each-ref<span class="token parameter"> --format</span>=</span><span class="token string">&quot;%(refname)&quot;</span> refs/original/ | \
  xargs -n 1 git update-ref -d
<span class="token command">$ git reflog expire<span class="token parameter"> --verbose</span><span class="token parameter"> --expire</span>=0<span class="token parameter"> --all</span></span>
<span class="token command">$ git gc<span class="token parameter"> --prune</span>=0</span>
<span class="token command">$ git push<span class="token parameter"> -f</span> origin master</span>
<span class="token command">$ git push<span class="token parameter"> -f</span> origin origin/issue5:issue5</span>
▲ If all your local branches match their respective commits on the GitHub side (i.e., no unpushed commits), then you can perform a bulk update.
<span class="token command">$ git for-each-ref<span class="token parameter"> --format</span>=</span><span class="token string">&quot;%(refname)&quot;</span> refs/remotes/origin/ | \
  grep -v <span class="token string">'HEAD$'</span> | perl -pe <span class="token string">'s,^refs/remotes/origin/,,'</span> | \
  xargs -n 1 -I <span class="token string">'{}'</span> git push -f origin <span class="token string">'refs/remotes/origin/{}:{}'</span>
<span class="token command">$ git for-each-ref<span class="token parameter"> --format</span>=</span><span class="token string">&quot;%(refname)&quot;</span> refs/remotes/origin/
refs/remotes/origin/HEAD
refs/remotes/origin/issue2
refs/remotes/origin/issue3
refs/remotes/origin/issue5
refs/remotes/origin/master
refs/remotes/origin/section_merge
refs/remotes/origin/side-media-icons
refs/remotes/origin/side-pane-splitter
refs/remotes/origin/side-popup
refs/remotes/origin/v2
<span class="token command">$ git push<span class="token parameter"> -f</span> origin refs/remotes/origin/BRANCH:BRANCH</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p><strong>5. Usage scenario: How to split a git repository and follow directory renames?</strong></p> <blockquote><p><font size="2">💯Score: 18    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-update-index.html">git update-index</a>, <a href="/./richen/git-ls-files.html">git ls-files</a> ]    🌐<a href="https://stackoverflow.com/questions/14764368" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --prune-empty --index-filter '
    # Delete files which are NOT needed
    git ls-files -z | egrep -zv  <span class="token string">&quot;^(NAME1|NAME2|NAME3)&quot;</span> | 
        xargs -0 -r git rm --cached -q             
    # Move files to root directory
    git ls-files -s | sed -e <span class="token string">&quot;s-\t\(NAME1\|NAME2\|NAME3\)/-\t-&quot;</span> |
        GIT_INDEX_FILE=$GIT_INDEX_FILE.new \
        git update-index --index-info &amp;&amp;
        ( test ! -f <span class="token string">&quot;$GIT_INDEX_FILE.new&quot;</span> \
            || mv -f <span class="token string">&quot;$GIT_INDEX_FILE.new&quot;</span> <span class="token string">&quot;$GIT_INDEX_FILE&quot;</span> )
'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>6. Usage scenario: How do I change a file's path in git's history?</strong></p> <blockquote><p><font size="2">💯Score: 13    🔗Associated commands: [ <a href="/./richen/git-update-index.html">git update-index</a>, <a href="/./richen/git-ls-files.html">git ls-files</a> ]    🌐<a href="https://stackoverflow.com/questions/3063008" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --index-filter '
  git ls-files -s |
  sed <span class="token string">&quot;s-\t\&quot;*-&amp;subproj1/-&quot;</span> |
  GIT_INDEX_FILE=$GIT_INDEX_FILE.new git update-index --index-info &amp;&amp;
  mv $GIT_INDEX_FILE.new $GIT_INDEX_FILE
' HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>7. Usage scenario: How to reduce the size of a repo on Github</strong></p> <blockquote><p><font size="2">💯Score: 11    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/1596747" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ If the commit were still on the tip, you could reset to the commit before it:
git reset --hard HEAD^

git rm test.wav
git commit --amend

git rebase -i &lt;commit-before-mistake&gt;

git push -f origin

▲ 
* If you<span class="token string">'ve subsequently committed modifications to these files, you'</span>ll get issues as you continue on in the rebase. They should be straightforward to deal with, since you just want the files gone. Of course, if there<span class="token string">'ve been a hundred commits since then that'</span>ll all cause conflicts, you could have a look at git-filter-branch. The relevant example from the man page is:
git filter-branch --index-filter ’git rm --cached --ignore-unmatch filename’ HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>8. Usage scenario: Remove files from a bare Git Repository Globally</strong></p> <blockquote><p><font size="2">💯Score: 9    🔗Associated commands: [ <a href="/./richen/git-repack.html">git repack</a>, <a href="/./richen/git-update-index.html">git update-index</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-ls-tree.html">git ls-tree</a>, <a href="/./richen/git-ls-files.html">git ls-files</a>, <a href="/./richen/git-prune.html">git prune</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-fsck.html">git fsck</a> ]    🌐<a href="https://stackoverflow.com/questions/22649532" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter \</span>
               <span class="token string">'git rm --cached --ignore-unmatch junk/bigfile'</span> -- --all

<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter \</span>
               <span class="token string">'git rm --cached --ignore-unmatch -r junk/'</span> -- --all

<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter \</span>
      'mv $GIT_INDEX_FILE /tmp/index;
       GIT_INDEX_FILE=/tmp/index git ls-files -s|
       grep -v FILENAME|git update-index --index-info' -- --all

<span class="token command">$ git ls-tree<span class="token parameter"> -r</span> &lt;commit&gt; | grep SOMEFILE</span>
100644 blob 4cbedad5b4ab88f700bf27ae5a32bdb3627fa632    SOMEFILE
<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter \</span>
      'mv $GIT_INDEX_FILE /tmp/index;
       GIT_INDEX_FILE=/tmp/index git ls-files -s|
       grep -v 4cbedad5b4ab88f700bf27ae5a32bdb3627fa632|
       git update-index --index-info'  -- --all

$ rm -rf refs/original
<span class="token command">$ git fsck</span>
<span class="token command">$ git prune</span>
<span class="token command">$ git gc</span>
<span class="token command">$ git repack<span class="token parameter"> -a</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>9. Usage scenario: Development Log file exceeds GitHub's file size limit, even after deleting file</strong></p> <blockquote><p><font size="2">💯Score: 8    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-commit.html">git commit</a> ]    🌐<a href="https://stackoverflow.com/questions/19082812" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rm log/development.log
git commit -m <span class="token string">&quot;removed log file&quot;</span>

git rm -r --cached log
git commit -m <span class="token string">&quot;removed log file&quot;</span>

git filter-branch --index-filter <span class="token string">'git rm --cached --ignore-unmatch log/development.log'</span> --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>10. Usage scenario: Clean Git Repository using gitignore</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-ls-files.html">git ls-files</a> ]    🌐<a href="https://stackoverflow.com/questions/30359405" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Only the last commit
git rm --cached -r .
git add .

▲ All commits (entire history)
git ls-files --exclude-standard --others --directory --ignored

<span class="token comment">#!/bin/bash</span>
for f in `git ls-files --exclude-standard --others --directory --ignored`
do
    git filter-branch --force --index-filter <span class="token string">&quot;git rm --cached --ignore-unmatch '$f'&quot;</span> --prune-empty --tag-name-filter cat -- --all
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>11. Usage scenario: How can I find and remove an unknown giant object from my git repo?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-verify-pack.html">git verify-pack</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-gc.html">git gc</a> ]    🌐<a href="https://stackoverflow.com/questions/10391515" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git gc</span>

<span class="token comment"># In the following command, replace the pack*.idx filename</span>
<span class="token comment"># with whatever filename you find in the .git/objects/pack</span>
<span class="token comment"># directory:</span>
<span class="token command">$ git verify-pack<span class="token parameter"> -v</span> .git/objects/pack/pack-3f8c0...bb.idx | sort<span class="token parameter"> -k</span> 3<span class="token parameter"> -n</span> | tail<span class="token parameter"> -3</span></span>
e3f094f522629ae358806b17daf78246c27c007b blob   1486 734 4667
05408d195263d853f09dca71d55116663690c27c blob   12908 3478 1189
7a9eb2fba2b1811321254ac360970fc169ba2330 blob   2056716 2056872 5401

<span class="token command">$ git rev-list<span class="token parameter"> --objects</span><span class="token parameter"> --all</span> | grep 7a9eb2fb</span>
7a9eb2fba2b1811321254ac360970fc169ba2330 git.tbz2

<span class="token command">$ git log<span class="token parameter"> --pretty</span>=oneline -- git.tbz2</span>
da3f30d019005479c99eb4c3406225613985a1db oops - removed large tarball
6df764092f3e7c8f5f94cbe08ee5cf42e92a0289 added git tarball

<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter \</span>
   <span class="token string">'git rm --cached --ignore-unmatch git.tbz2'</span> -- 6df7640^..
Rewrite 6df764092f3e7c8f5f94cbe08ee5cf42e92a0289 (1/2)rm <span class="token string">'git.tbz2'</span>
Rewrite da3f30d019005479c99eb4c3406225613985a1db (2/2)
Ref <span class="token string">'refs/heads/master'</span> was rewritten

$ rm -Rf .git/refs/original
$ rm -Rf .git/logs/
<span class="token command">$ git gc</span>
Counting objects: 19, done.
Delta compression using 2 threads.
Compressing objects: 100% (14/14), done.
Writing objects: 100% (19/19), done.
Total 19 (delta 3), reused 16 (delta 1)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p><strong>12. Usage scenario: How to permanently delete a commit from Git's history?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/18014262" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Delete the file from a checkout
<span class="token command">$ git filter-branch<span class="token parameter"> --force</span><span class="token parameter"> --index</span>-filter \</span>
  <span class="token string">'git rm --cached --ignore-unmatch 200MB-filename'</span> \
  --prune-empty --tag-name-filter cat -- --all
<span class="token command">$ git push<span class="token parameter"> --all</span><span class="token parameter"> -f</span></span>

$ rm -rf .git/refs/original/
<span class="token command">$ git reflog expire<span class="token parameter"> --expire</span>=now<span class="token parameter"> --all</span></span>
<span class="token command">$ git gc<span class="token parameter"> --prune</span>=now</span>

▲ Recovering space on the git server
$ ssh git server
$ cd /my/project/repo.git
<span class="token command">$ git gc<span class="token parameter"> --prune</span>=now</span>

▲ Teammates
▲ User has no local commits
<span class="token command">$ git fetch</span>
<span class="token command">$ git reset origin/master<span class="token parameter"> -hard</span></span>

▲ User does have local commits
<span class="token command">$ git fetch</span>
<span class="token command">$ git rebase<span class="token parameter"> -i</span> origin/master</span>

▲ User cleanup
$ rm -rf .git/refs/original/
<span class="token command">$ git reflog expire<span class="token parameter"> --expire</span>=now<span class="token parameter"> --all</span></span>
<span class="token command">$ git gc<span class="token parameter"> --prune</span>=now</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p><strong>13. Usage scenario: Remove history of a file from just a single branch, not the entire repo</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/19001052" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git checkout topic-branch</span>
<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter </span><span class="token string">'git checkout master -- myfile'</span> master..HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>14. Usage scenario: git: How to split off library from project? filter-branch, subtree?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-pull.html">git pull</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/22259131" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git subtree split -P src/de/fencing_game -b temp-br
git checkout temp-br

<span class="token comment"># -or-, if you really want to keep the full path:</span>

git checkout -b temp-br
cd src/de/fencing_game

git filter-branch --tag-name-filter cat --prune-empty --index-filter <span class="token string">'git rm -rf --cached --ignore-unmatch client server otherstuff'</span> HEAD

<span class="token comment"># also clear out stuff from the sub dir</span>
cd transport 
git filter-branch --tag-name-filter cat --prune-empty --index-filter <span class="token string">'git rm -rf --cached --ignore-unmatch fencing client server'</span> HEAD

git update-ref -d refs/original/refs/heads/temp-br

cd &lt;new-lib-repo&gt;
git init
git pull &lt;original-repo&gt; temp-br
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>15. Usage scenario: Export git history, for a file and a subfolder, into another existing git repo?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-cherry-pick.html">git cherry-pick</a>, <a href="/./richen/git-pull.html">git pull</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/56328369" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>cd oldrepo_filt_git
git filter-branch --index-filter <span class="token string">&quot;git rm --cached --ignore-unmatch -r $(bash -O extglob -c 'ls -xd !(a*)')&quot;</span> --prune-empty -- --all

<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter </span><span class="token string">&quot;git rm --cached --ignore-unmatch -r $(bash -O extglob -c 'ls -xd !(a*)')&quot;</span> --prune-empty -- --all
Rewrite 252bf7ff5f385dad880240d5d80e68f24ae09b59 (1/8) (0 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
Rewrite f318d9712cd7aacdb5dd45febbcdbbce6b741e08 (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
Rewrite 00b62e7da8784d45850d7483cbea88fdc4aa844c (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite c618eff47d38412c54a8381a5bacc921bddefe2d (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 2cada8d822d83f37bdc4a37bcfb03047c1cc1ded (5/8) (3 seconds passed, remaining 1 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 7b296b70018f4105f190d06ed4d9c58e3f80532f (5/8) (3 seconds passed, remaining 1 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 18a1ad1d35cd8573c39485d0a29b630325f9727d (7/8) (5 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 2ffbbf03d51363f1ced3aaaf000d5921c9d8b919 (7/8) (5 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>

Ref <span class="token string">'refs/heads/master'</span> was rewritten
Ref <span class="token string">'refs/heads/testbranch'</span> was rewritten

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span><span class="token parameter"> --stat</span></span>
*   31cd8b5 (HEAD -&gt; master) Merge branch <span class="token string">'testbranch'</span>
|\
| * 42b153d (testbranch) change 5 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * ff1be9d change 4 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * 90f050c change 3 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * d2d2136 change 2 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * ab237ac change 1 made
|/
|    a.txt     | 1 +
|    aa/aa.txt | 1 +
|    aa/ab.txt | 1 +
|    3 files changed, 3 insertions(+)
* ea0a32d added a.txt
   a.txt | 1 +
   1 file changed, 1 insertion(+)

git remote add oldrepo ../oldrepo_filt_git/
git pull oldrepo master --allow-unrelated-histories

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span><span class="token parameter"> --stat</span></span>
*   845c81e (HEAD -&gt; master) Merge branch <span class="token string">'master'</span> of ../oldrepo_filt_git
|\
| *   31cd8b5 (oldrepo/master) Merge branch <span class="token string">'testbranch'</span>
| |\
| | * 42b153d (oldrepo/testbranch) change 5 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * ff1be9d change 4 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * 90f050c change 3 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * d2d2136 change 2 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * ab237ac change 1 made
| |/
| |    a.txt     | 1 +
| |    aa/aa.txt | 1 +
| |    aa/ab.txt | 1 +
| |    3 files changed, 3 insertions(+)
| * ea0a32d added a.txt
|    a.txt | 1 +
|    1 file changed, 1 insertion(+)
* 8e99c2d Initial commit by Bob
   README | 1 +
   1 file changed, 1 insertion(+)

<span class="token command">$ git remote add old-repo ../oldrepo_filt_git</span>

<span class="token command">$ git fetch old-repo</span>
warning: no common commits
remote: Enumerating objects: 29, done.
remote: Counting objects: 100% (29/29), done.
remote: Compressing objects: 100% (17/17), done.
remote: Total 29 (delta 2), reused 0 (delta 0)
Unpacking objects: 100% (29/29), done.
From ../oldrepo_filt_git
 * [new branch]      master     -&gt; old-repo/master
 * [new branch]      testbranch -&gt; old-repo/testbranch

<span class="token command">$ git branch oldrepo-head old-repo/master</span>
Branch <span class="token string">'oldrepo-head'</span> set up to track remote branch <span class="token string">'master'</span> from <span class="token string">'old-repo'</span>.

<span class="token command">$ git branch oldrepo-root $(git log oldrepo-head<span class="token parameter"> --reverse</span><span class="token parameter"> --pretty</span>=%H | head<span class="token parameter"> -n</span> 1)</span>

<span class="token command">$ git log<span class="token parameter"> --pretty</span>=</span><span class="token string">'%T %ct'</span> ..oldrepo-head &gt; /tmp/hashlist

<span class="token command">$ git branch<span class="token parameter"> -m</span> master new-master</span>

<span class="token command">$ git cherry-pick<span class="token parameter"> --strategy</span>-option=theirs oldrepo-root</span>
[new-master 427cf77] added a.txt
 Author: tester &lt;tester@example.com&gt;
 Date: Mon May 27 14:31:10 2019 +0200
 1 file changed, 1 insertion(+)
 create mode 100644 a.txt

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span></span>
* 427cf77 (HEAD -&gt; new-master) added a.txt
* 8e99c2d Initial commit by Bob

<span class="token command">$ git rebase<span class="token parameter"> --preserve</span>-merges<span class="token parameter"> --onto</span> new-master<span class="token parameter"> --root</span> oldrepo-head</span>
Successfully rebased and updated refs/heads/oldrepo-head.

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit 61fbe54721a9432e91e48917ed036f55da4105a4 (HEAD -&gt; oldrepo-head)
|\  Merge: 427cf77 f8e8f8a
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:57:00 2019 +0200
| |
| |     Merge branch <span class="token string">'testbranch'</span>
| |
| * commit f8e8f8aedaa7bc999bdfdd49542c9ee04edb770c
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:00 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:58 2019 +0200
| |
| |     change 5 made
| |
| * commit b084029040d6596e0795e7567b2684dc59c02241
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:50 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:56 2019 +0200
| |
| |     change 4 made
| |
| * commit b62dabca3a46efbe76edb10591935db136f74aaa
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:40 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:54 2019 +0200
| |
| |     change 3 made
| |
| * commit 252f3e9697b87b4f59cd0a74681ef25401340fcf
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:30 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:51 2019 +0200
| |
| |     change 2 made
| |
| * commit c382c8a713489ca0e5dc106bed29fdce379952b0
|/  Author:     tester &lt;tester@example.com&gt;
|   AuthorDate: Mon May 27 14:31:20 2019 +0200
|   Commit:     bob &lt;bob@example.com&gt;
|   CommitDate: Tue May 28 12:56:49 2019 +0200
|
|       change 1 made
|
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (new-master)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
|
|     added a.txt
|
* commit 8e99c2d71048b4999d012b33d34386351d6d0fef
  Author:     bob &lt;bob@example.com&gt;
  AuthorDate: Mon May 27 14:31:00 2019 +0200
  Commit:     bob &lt;bob@example.com&gt;
  CommitDate: Mon May 27 14:31:00 2019 +0200

      Initial commit by Bob

<span class="token command">$ git filter-branch<span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(fgrep -m 1 $(git log -1 --pretty=%T $GIT_COMMIT) /tmp/hashlist | cut -d&quot; &quot; -f2)'</span> new-master..oldrepo-head
Rewrite 61fbe54721a9432e91e48917ed036f55da4105a4 (3/6) (1 seconds passed, remaining 1 predicted)
Ref <span class="token string">'refs/heads/oldrepo-head'</span> was rewritten

<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> new-master..oldrepo-head
Rewrite f2b2385d85c74dbf0cbf8fabc02ec30cb50d8f2a (3/6) (1 seconds passed, remaining 1 predicted)
Ref <span class="token string">'refs/heads/oldrepo-head'</span> was rewritten

sd@DESKTOP-RO11QOC MSYS /c/Users/sd/AppData/Local/Temp/newrepo_git
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> 427cf77417a
You must specify a ref to rewrite.

sd@DESKTOP-RO11QOC MSYS /c/Users/sd/AppData/Local/Temp/newrepo_git
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> new-master
Rewrite 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (2/2) (0 seconds passed, remaining 0 predicted)
Ref <span class="token string">'refs/heads/new-master'</span> was rewritten

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit cdaa4b82f3833770a9051a2490487548603e3af8 (HEAD -&gt; oldrepo-head)
|\  Merge: 427cf77 9bfc6cd
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:10 2019 +0200
| |
| |     Merge branch <span class="token string">'testbranch'</span>
| |
...
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (refs/original/refs/heads/new-master)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
|
|     added a.txt
|
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
...

<span class="token command">$ git branch<span class="token parameter"> -m</span> oldrepo-head master</span>
<span class="token command">$ git branch<span class="token parameter"> -D</span> oldrepo-root</span>
Deleted branch oldrepo-root (was ea0a32d).
<span class="token command">$ git branch<span class="token parameter"> -D</span> new-master</span>
Deleted branch new-master (was 4ac225e).
$ rm .git/refs/original/refs/heads/new-master
<span class="token command">$ git remote remove old-repo</span>

<span class="token command">$ git branch tmp 427cf774</span>
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> tmp^..tmp
Rewrite 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (1/1) (0 seconds passed, remaining 0 predicted)
Ref <span class="token string">'refs/heads/tmp'</span> was rewritten
<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller tmp</span>
* commit 4ac225e308e280e3a96be0168c6e9dece44d4979 (tmp)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Mon May 27 14:31:10 2019 +0200
|
|     added a.txt
|
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
|
...
<span class="token command">$ git branch<span class="token parameter"> -D</span> tmp</span>
Deleted branch tmp (was 4ac225e).

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit cdaa4b82f3833770a9051a2490487548603e3af8
|\  Merge: 427cf77 9bfc6cd
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:10 2019 +0200
| | 
| |     Merge branch <span class="token string">'testbranch'</span>
| | 
| * commit 9bfc6cde58be9102102f839e5cc0fe8f25f0f78c
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:00 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:00 2019 +0200
| | 
| |     change 5 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 485ae0f50054610b6a41098fb695e59d194cc856
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:50 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:50 2019 +0200
| | 
| |     change 4 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit b6804b6e8e313b5c4766568a287f0785503e3a11
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:40 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:40 2019 +0200
| | 
| |     change 3 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 8b463423d2a99929a6a248e38ba1368a56d3769d
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:30 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:30 2019 +0200
| | 
| |     change 2 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 3bc0bed30ebea1498a15711825b2ea8347cc374d
|/  Author:     tester &lt;tester@example.com&gt;
|   AuthorDate: Mon May 27 14:31:20 2019 +0200
|   Commit:     bob &lt;bob@example.com&gt;
|   CommitDate: Mon May 27 14:31:20 2019 +0200
|   
|       change 1 made
|   
|    a.txt     | 1 +
|    aa/aa.txt | 1 +
|    aa/ab.txt | 1 +
|    3 files changed, 3 insertions(+)
| 
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
| 
|     added a.txt
| 
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
| 
* commit 8e99c2d71048b4999d012b33d34386351d6d0fef
  Author:     bob &lt;bob@example.com&gt;
  AuthorDate: Mon May 27 14:31:00 2019 +0200
  Commit:     bob &lt;bob@example.com&gt;
  CommitDate: Mon May 27 14:31:00 2019 +0200

      Initial commit by Bob

   README | 1 +
   1 file changed, 1 insertion(+)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br></div></div><p><strong>16. Usage scenario: How to add back the original project history when the whole project was committed with a &quot;first commit&quot; to a brand new repo</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-replace.html">git replace</a> ]    🌐<a href="https://stackoverflow.com/questions/66874523" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ You can <span class="token string">&quot;stitch&quot;</span> the histories back together using git replace.
git remote add history https://github.com/some/repo
git fetch history

git replace sha1-local sha1-history

▲ For example, if feature is a branch in that repository, you can run :
git checkout -b feature history/feature
git rebase master

▲ If you want to rewrite all the commits in your local repository and make that replacement permanent, call git filter-branch or git filter-repo :
<span class="token comment"># to rewrite only your local master branch :</span>
git filter-branch --index-filter true -- master

<span class="token comment"># to rewrite all your local branches :</span>
git filter-branch --index-filter true -- --branches
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>17. Usage scenario: Git filter-branch: keep only commits in subdir</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-reset.html">git reset</a> ]    🌐<a href="https://stackoverflow.com/questions/51542139" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment"># 1 Remove everything from root-tree (from the new revision)</span>
git rm --ignore-unmatch --cached -qr -- .

<span class="token comment"># 2 Restore challenge_gpsr sub-tree (from original revision)</span>
git reset -q \$GIT_COMMIT -- challenge_gpsr    

git filter-branch -f --index-filter &quot; \
    git reset -q 189bd987 -- . &amp;&amp; \
    git reset -q \$GIT_COMMIT -- challenge_gpsr \
<span class="token string">&quot; --prune-empty -- &quot;</span>robocup&quot; 189bd987..HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>18. Usage scenario: How can I reduce the size of my git repo?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-verify-pack.html">git verify-pack</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/34327110" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-list --objects --all | sort -k 2 &gt; allfileshas.txt

git gc &amp;&amp; git verify-pack -v .git/objects/pack/pack-*.idx | egrep <span class="token string">&quot;^\w+ blob\W+[0-9]+ [0-9]+ [0-9]+$&quot;</span> | sort -k 3 -n -r &gt; bigobjects.txt

git filter-branch --prune-empty --index-filter <span class="token string">'git rm -rf --cached --ignore-unmatch MY-BIG-DIRECTORY-OR-FILE'</span> --tag-name-filter cat -- --all

git clone --no-hardlinks file:///Users/yourUser/your/full/repo/path repo-clone-name

git push --force
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>19. Usage scenario: git subtree changes the package directory</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-reset.html">git reset</a> ]    🌐<a href="https://stackoverflow.com/questions/19748453" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git checkout<span class="token parameter"> -b</span> moved_package_branch</span>
<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter </span><span class="token string">'git rm --cached -qr -- . &amp;&amp; git reset -q $GIT_COMMIT -- src/main/java/com/company/package'</span> --prune-empty
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="parent-filter"><a href="#parent-filter" class="header-anchor">#</a> 🔹 --parent-filter</h2> <p><strong>1. Usage scenario: How can I delete all commits before a given date in Git history?</strong></p> <blockquote><p><font size="2">💯Score: 24    🔗Associated commands: [ <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-reflog.html">git reflog</a> ]    🌐<a href="https://stackoverflow.com/questions/29043295" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --parent-filter '
    read parent
    if [ <span class="token string">&quot;$parent&quot;</span> = <span class="token string">&quot;-p 5bdd44e5919cb0a95a9924817529cd7c980f88b5&quot;</span> ]
    then
        echo
    else
        echo <span class="token string">&quot;$parent&quot;</span>
    fi'

git update-ref -d refs/original/refs/heads/master

git reflog expire --expire-unreachable=all --all
git gc --prune=all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>2. Usage scenario: How can I combine Git repositories into a linear history?</strong></p> <blockquote><p><font size="2">💯Score: 15    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-rev-parse.html">git rev-parse</a> ]    🌐<a href="https://stackoverflow.com/questions/15802324" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Using git filter-branch
git init repo
cd repo
git remote add R1 /vol/R1.git
git fetch R1
git remote add R2 /vol/R2.git
git fetch R2

git reset --hard R2/master

git filter-branch --parent-filter <span class="token string">'sed &quot;s_^\$_-p R1/master_&quot;'</span> HEAD

A---B---C---D---K---L---M---N

▲ Merging more than two repositories together with filter-branch
PARENT_REPO=R1
for CHILD_REPO in R2 R3 R4 R5; do
    git reset --hard $CHILD_REPO/master
    git filter-branch --parent-filter <span class="token string">'sed &quot;s_^\$_-p '</span>$PARENT_REPO/master<span class="token string">'&quot;'</span> HEAD
    PARENT_REPO=$CHILD_REPO
done

▲ Using grafts
git reset --hard R2/master

ROOT_OF_R2=$(git rev-list R2/master | tail -n 1)
TIP_OF_R1=$(git rev-parse R1/master)
echo $ROOT_OF_R2 $TIP_OF_R1 &gt;&gt; .git/info/grafts

git filter-branch

rm .git/info/grafts

▲ Merging more than two repositories together with grafts
git reset --hard R5/master

PARENT_REPO=R1
for CHILD_REPO in R2 R3 R4 R5; do
    ROOT_OF_CHILD=$(git rev-list $CHILD_REPO/master | tail -n 1)
    TIP_OF_PARENT=$(git rev-parse $PARENT_REPO/master)
    echo <span class="token string">&quot;$ROOT_OF_CHILD&quot;</span> <span class="token string">&quot;$TIP_OF_PARENT&quot;</span> &gt;&gt; .git/info/grafts
    PARENT_REPO=$CHILD_REPO
done

▲ What about git rebase?
A---B---C---D---K<span class="token string">'---L'</span>---M<span class="token string">'---N'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p><strong>3. Usage scenario: Merge two repositories (original project and changed project WITHOUT HISTORY)</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/11298335" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git fetch /path/to/original/gephi

git filter-branch -f --parent-filter <span class="token string">'test $GIT_COMMIT = &lt;V&gt; &amp;&amp; echo &quot;-p &lt;E&gt;&quot; || cat'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>4. Usage scenario: Git branches not merged after switching from svn</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/13805856" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --parent-filter \
<span class="token string">'test $GIT_COMMIT = 73653d1 &amp;&amp; echo &quot;-p 2ec9e8c -p 5c237f9&quot; || cat'</span> master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>5. Usage scenario: How to remove unwanted extra root commit in git repository?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/1989275" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git filter-branch<span class="token parameter"> --parent</span>-filter \</span>
    <span class="token string">'test $GIT_COMMIT = G &amp;&amp; echo &quot;-p F&quot; || cat'</span> HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>6. Usage scenario: Remove oldest commits from git repository</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-rev-parse.html">git rev-parse</a>, <a href="/./richen/git-fsck.html">git fsck</a> ]    🌐<a href="https://stackoverflow.com/questions/9783293" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>$ cd /tmp
$ mkdir rmcommits
$ cd rmcommits
<span class="token command">$ git init</span>
Initialized empty Git repository in /tmp/rmcommits/.git/
$ cp /tmp/example/xy.c .
<span class="token command">$ git add xy.c</span>
<span class="token command">$ git commit<span class="token parameter"> -m</span> </span><span class="token string">'initial commit'</span>
[master (root-commit) 8d5b88c] initial commit
 1 files changed, 273 insertions(+), 0 deletions(-)
 create mode 100644 xy.c
$ echo <span class="token string">'more stuff'</span> &gt; morestuff.txt
<span class="token command">$ git add morestuff.txt; git commit<span class="token parameter"> -m</span> </span><span class="token string">'add some stuff'</span>
[master f971ae5] add some stuff
 1 files changed, 1 insertions(+), 0 deletions(-)
 create mode 100644 morestuff.txt
$ echo <span class="token string">'and still more'</span> &gt;&gt; morestuff.txt 
<span class="token command">$ git add morestuff.txt; git commit<span class="token parameter"> -m</span> </span><span class="token string">'add more stuff'</span>
[master bea9192] add more stuff
 1 files changed, 1 insertions(+), 0 deletions(-)

<span class="token command">$ git rev-parse HEAD^</span>
f971ae5b4225aca364223a44be8be84268385ff3

<span class="token command">$ git filter-branch<span class="token parameter"> --parent</span>-filter </span><span class="token string">'test $GIT_COMMIT == f971ae5b4225aca364223a44be8be84268385ff3 &amp;&amp; echo &quot;&quot; || cat'</span> HEAD
Rewrite bea9192a53a5aeb7532aa1e174f7f642363396de (3/3)
Ref <span class="token string">'refs/heads/master'</span> was rewritten
<span class="token command">$ git log<span class="token parameter"> --pretty</span>=oneline</span>
65a246b8320382a64550d2c4b650c942d7bfba70 add more stuff
7892ab45aa33cd5ebdc3090ce2622081059fdd79 add some stuff

<span class="token command">$ git log original/refs/heads/master<span class="token parameter"> --pretty</span>=oneline</span>
bea9192a53a5aeb7532aa1e174f7f642363396de add more stuff
f971ae5b4225aca364223a44be8be84268385ff3 add some stuff
8d5b88c468f75750d5a01ab40bfae160c654ac66 initial commit

<span class="token command">$ git update-ref<span class="token parameter"> -d</span> refs/original/refs/heads/master</span>
<span class="token command">$ git reflog expire<span class="token parameter"> --expire</span>=now<span class="token parameter"> --all</span></span>
<span class="token command">$ git gc<span class="token parameter"> --prune</span>=now</span>
<span class="token command">$ git fsck<span class="token parameter"> --unreachable</span></span>
$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p><strong>7. Usage scenario: How do I edit the initial commit in a github repository?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/2066034" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git filter-branch<span class="token parameter"> --parent</span>-filter \</span>
  <span class="token string">'test $GIT_COMMIT = SECOND &amp;&amp; echo &quot;&quot; || cat'</span> \
  --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>8. Usage scenario: Rebasing merged trees in Git</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/21897610" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --parent-filter &lt;somescript&gt; --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>9. Usage scenario: correctly rebase a merge</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/11236533" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --parent-filter <span class="token string">'test $GIT_COMMIT = &lt;a2&gt; &amp;&amp; echo &quot;-p &lt;c1&gt;&quot; || cat'</span>
git filter-branch -f --parent-filter <span class="token string">'test $GIT_COMMIT = &lt;new head&gt; &amp;&amp; echo &quot;-p &lt;c2&gt;&quot; || cat'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="msg-filter"><a href="#msg-filter" class="header-anchor">#</a> 🔹 --msg-filter</h2> <p><strong>1. Usage scenario: How to rename last N commits messages in git?</strong></p> <blockquote><p><font size="2">💯Score: 32    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/14201492" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --msg-filter &lt;command&gt;

git filter-branch -f --msg-filter '
    echo <span class="token string">&quot;Bug XXXXXXX: \c&quot;</span>
    &amp;&amp; cat
    ' HEAD~&lt;N&gt;..HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>2. Usage scenario: git: changing an old commit message without creating conflicts</strong></p> <blockquote><p><font size="2">💯Score: 16    🔗Associated commands: [ <a href="/./richen/git-config.html">git config</a>, <a href="/./richen/git-rev-parse.html">git rev-parse</a> ]    🌐<a href="https://stackoverflow.com/questions/27699824" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#! /bin/bash</span>
REV=$1
MESSAGE=$2
FILTER=<span class="token string">&quot;test $(echo '$GIT_COMMIT') = $(git rev-parse $REV) &amp;&amp; echo $MESSAGE || cat&quot;</span>
git filter-branch --msg-filter <span class="token string">&quot;$FILTER&quot;</span> -- --all

git config alias.undo-filter-branch <span class="token string">'! DIR=$(git rev-parse --git-dir); cp -r $DIR/refs/original/refs/ .git/; rm -r $DIR/refs/original/'</span>
git config alias.confirm-filter-branch <span class="token string">'! DIR=$(git rev-parse --git-dir); rm -r $DIR/refs/original/'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>3. Usage scenario: Rebasing a git history with empty commit messages</strong></p> <blockquote><p><font size="2">💯Score: 13    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/8542434" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --msg-filter '
read msg
if [ -n <span class="token string">&quot;$msg&quot;</span> ] ; then
    echo <span class="token string">&quot;$msg&quot;</span>
else
    echo <span class="token string">&quot;The commit message was empty&quot;</span>
fi'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>4. Usage scenario: Rewriting Git History: How do I remove a sign-off?</strong></p> <blockquote><p><font size="2">💯Score: 13    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/3690063" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --msg-filter <span class="token string">&quot;sed /^Signed-off-by:/d&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>5. Usage scenario: How can I edit an old git commit message programmatically?</strong></p> <blockquote><p><font size="2">💯Score: 8    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/50633163" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --msg-filter <span class="token string">&quot;perl -ple 's{color}{colour}g'&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>6. Usage scenario: How to change the specific string throughout all git message commits?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-push.html">git push</a>, <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/15874218" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --msg-filter <span class="token string">'sed &quot;s/git-svn.*$//g&quot;'</span> -- --all

<span class="token command">$ git clone<span class="token parameter"> --mirror</span> git://example.com/my-repo.git</span>

git filter-branch -f --msg-filter <span class="token string">'sed &quot;s/git-svn.*$//g&quot;'</span> -- --all

<span class="token command">$ git push</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>7. Usage scenario: How to edit multiple commit messages at once during rebase?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/19931564" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --msg-filter <span class="token string">'sed &quot;1a\\\\&quot;'</span> from..
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>8. Usage scenario: Censoring commit history</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/61315902" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --msg-filter <span class="token string">'sed &quot;s/word/&lt;redacted&gt;/g&quot;'</span> -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>9. Usage scenario: How to copy a repo and filter out all commit descriptions</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/47599464" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git filter-branch<span class="token parameter"> --msg</span>-filter </span><span class="token string">'head -1'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>10. Usage scenario: How can I see more log lines in the git-rebase TODO editor session?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-config.html">git config</a> ]    🌐<a href="https://stackoverflow.com/questions/65983306" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git config rebase.instructionFormat <span class="token string">&quot;...&quot;</span>

git filter-branch --msg-filter <span class="token string">&quot;xargs echo&quot;</span>

git filter-branch --msg-filter <span class="token string">&quot;cat | $(pwd)/script.sh&quot;</span>

<span class="token comment">#!/bin/bash</span>
for commit in $(git rev-list $1..HEAD | tac)
do
    git log -n 1 $commit --format=<span class="token string">&quot;pick %h %B&quot;</span> | xargs echo
done;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="commit-filter"><a href="#commit-filter" class="header-anchor">#</a> 🔹 --commit-filter</h2> <p><strong>1. Usage scenario: How can I rebase a commit made by another author without adding myself as the committer?</strong></p> <blockquote><p><font size="2">💯Score: 31    🔗Associated commands: [ <a href="/./richen/git-commit-tree.html">git commit-tree</a> ]    🌐<a href="https://stackoverflow.com/questions/5520650" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --commit-filter <span class="token string">'export GIT_COMMITTER_NAME=&quot;$GIT_AUTHOR_NAME&quot;; export GIT_COMMITTER_EMAIL=&quot;$GIT_AUTHOR_EMAIL&quot;; export GIT_COMMITTER_DATE=&quot;$GIT_AUTHOR_DATE&quot;; git commit-tree &quot;$@&quot;'</span> -- basecommit..HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>2. Usage scenario: how to abandon commits of certain characteristic when using git?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-commit-tree.html">git commit-tree</a>, <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/29942720" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --commit-filter '
    MSG=$(git log --format=%B -n 1 $GIT_COMMIT)
    if [ <span class="token string">&quot;$MSG&quot;</span> = <span class="token string">&quot;temp commit&quot;</span> ];
    then
        skip_commit <span class="token string">&quot;$@&quot;</span>;
    else
        git commit-tree <span class="token string">&quot;$@&quot;</span>;
    fi' HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="tag-name-filter"><a href="#tag-name-filter" class="header-anchor">#</a> 🔹 --tag-name-filter</h2> <p><strong>1. Usage scenario: Detach (move) subdirectory into separate Git repository</strong></p> <blockquote><p><font size="2">💯Score: 1263    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-gc.html">git gc</a> ]    🌐<a href="https://stackoverflow.com/questions/359759" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone /XYZ /ABC

cd /ABC
for i in branch1 br2 br3; do git branch -t $i origin/$i; done
git remote rm origin

cd /ABC
for i in $(git branch -r | sed <span class="token string">&quot;s/.*origin\///&quot;</span>); do git branch -t $i origin/$i; done
git remote rm origin

git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter ABC -- --all

git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter ABC HEAD

git reset --hard
git for-each-ref --format=<span class="token string">&quot;%(refname)&quot;</span> refs/original/ | xargs -n 1 git update-ref -d
git reflog expire --expire=now --all
git gc --aggressive --prune=now
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>2. Usage scenario: Remove empty commits in git</strong></p> <blockquote><p><font size="2">💯Score: 43    🔗Associated commands: [ <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/28313729" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>$ ... create repository ...
$ cd some-tmp-dir; git clone --mirror file://path-to-original

<span class="token command">$ git filter-branch<span class="token parameter"> --prune</span>-empty<span class="token parameter"> --tag</span>-name-filter cat --<span class="token parameter"> --all</span></span>

<span class="token command">$ git for-each-ref<span class="token parameter"> --format</span>=</span><span class="token string">&quot;%(refname)&quot;</span> refs/original/ | xargs -n 1 git update-ref -d

$ cd third-tmp-dir; git clone --mirror file://path-to-filtered-tmp

<span class="token command">$ git log     # and other commands to inspect</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>3. Usage scenario: How to prepend the past to a git repository?</strong></p> <blockquote><p><font size="2">💯Score: 27    🔗Associated commands: [ <a href="/./richen/git-cat-file.html">git cat-file</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-hash-object.html">git hash-object</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-push.html">git push</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-replace.html">git replace</a>, <a href="/./richen/git-rev-parse.html">git rev-parse</a> ]    🌐<a href="https://stackoverflow.com/questions/3148117" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ For importing the old snapshots, you find some of the tools in Git's contrib/fast-import directory useful. Or, if you  already have each old snapshot in a directory, you might do something like this:
<span class="token comment"># Assumes the v* glob will sort in the right order</span>
<span class="token comment"># (i.e. zero padded, fixed width numeric fields)</span>
<span class="token comment"># For v1, v2, v10, v11, ... you might try:</span>
<span class="token comment">#     v{1..23}     (1 through 23)</span>
<span class="token comment">#     v?{,?}       (v+one character, then v+two characters)</span>
<span class="token comment">#     v?{,?{,?}}   (v+{one,two,three} characters)</span>
<span class="token comment">#     $(ls -v v*)  (GNU ls has &quot;version sorting&quot;)</span>
<span class="token comment"># Or, just list them directly: ``for d in foo bar baz quux; do''</span>
(git init import)
for d in v*; do
    if mv import/.git <span class="token string">&quot;$d/&quot;</span>; then
        (cd <span class="token string">&quot;$d&quot;</span> &amp;&amp; git add --all &amp;&amp; git commit -m<span class="token string">&quot;pre-Git snapshot $d&quot;</span>)
        mv <span class="token string">&quot;$d/.git&quot;</span> import/
    fi
done
(cd import &amp;&amp; git checkout HEAD -- .)

cd work &amp;&amp; git fetch ../import master:old-history

INITIAL_SHA1=$(git rev-list --reverse master | head -1)
TIP_OF_OLD_HISTORY_SHA1=$(git rev-parse old-history)
echo $INITIAL_SHA1 $TIP_OF_OLD_HISTORY_SHA1 &gt;&gt; .git/info/grafts

▲ The main problem with grafts is that they are limited to your repository. But, if you decide that they should be a permanent part of the history, you can use git filter-branch to make them so (make a tar/zip backup of your .git dir first; git filter-branch will save original refs, but sometime it is just easier to use a plain backup).
git filter-branch --tag-name-filter cat -- --all
rm .git/info/grafts

<span class="token comment"># the last commit of old history branch</span>
oldhead=$(git rev-parse --verify old-history)
<span class="token comment"># the initial commit of current branch</span>
newinit=$(git rev-list master | tail -n 1)
<span class="token comment"># create a fake commit based on $newinit, but with a parent</span>
<span class="token comment"># (note: at this point, $oldhead must be a full commit ID)</span>
newfake=$(git cat-file commit <span class="token string">&quot;$newinit&quot;</span> \
        | sed <span class="token string">&quot;/^tree [0-9a-f]\+\$/aparent $oldhead&quot;</span> \
        | git hash-object -t commit -w --stdin)
<span class="token comment"># replace the initial commit with the fake one</span>
git replace -f <span class="token string">&quot;$newinit&quot;</span> <span class="token string">&quot;$newfake&quot;</span>

git push some-remote <span class="token string">'refs/replace/*'</span>

▲ If you decide to make the replacement permanent, use git filter-branch (same as with grafts; make a tar/zip backup of your .git directory first):
git filter-branch --tag-name-filter cat -- --all
git replace -d $INITIAL_SHA1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p><strong>4. Usage scenario: How do I preserve tags when filtering a repository?</strong></p> <blockquote><p><font size="2">💯Score: 15    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/5574694" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> git filter-branch --tree-filter <span class="token string">'move-to-subdir $subdir'</span> --prune-empty --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>5. Usage scenario: Definitive retroactive .gitignore (how to make Git completely/retroactively forget about a file now in .gitignore)</strong></p> <blockquote><p><font size="2">💯Score: 11    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-ls-files.html">git ls-files</a>, <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/57454176" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#commit up-to-date .gitignore (if not already existing)</span>
<span class="token comment">#these commands must be run on each branch</span>
<span class="token comment">#these commands are not strictly necessary if you don't want/need a .gitignore file.  .git/info/exclude can be used instead</span>

git add .gitignore
git commit -m <span class="token string">&quot;Create .gitignore&quot;</span>

<span class="token comment">#apply standard git ignore behavior only to current index, not working directory (--cached)</span>
<span class="token comment">#if this command returns nothing, ensure /.git/info/exclude AND/OR .gitignore exist</span>
<span class="token comment">#this command must be run on each branch</span>
<span class="token comment">#if using .git/info/exclude, it will need to be modified per branch run, if the branches have differing (per-branch) .gitignore requirements.</span>

git ls-files -z --ignored --exclude-standard | xargs -r0 git rm --cached

<span class="token comment">#Commit to prevent working directory data loss!</span>
<span class="token comment">#this commit will be automatically deleted by the --prune-empty flag in the following command</span>
<span class="token comment">#this command must be run on each branch</span>
<span class="token comment">#optionally use the --amend flag to merge this commit with the previous one instead of creating 2 commits.</span>

git commit -m <span class="token string">&quot;ignored index&quot;</span>

<span class="token comment">#Apply standard git ignore behavior RETROACTIVELY to all commits from all branches (--all)</span>
<span class="token comment">#This step WILL delete ignored files from working directory UNLESS they have been dereferenced from the index by the commit above</span>
<span class="token comment">#This step will also delete any &quot;empty&quot; commits.  If deliberate &quot;empty&quot; commits should be kept, remove --prune-empty and instead run git reset HEAD^ immediately after this command</span>

git filter-branch --tree-filter <span class="token string">'git ls-files -z --ignored --exclude-standard | xargs -r0 git rm -f --ignore-unmatch'</span> --prune-empty --tag-name-filter cat -- --all

<span class="token comment">#List all still-existing files that are now ignored properly</span>
<span class="token comment">#if this command returns nothing, it's time to restore from backup and start over</span>
<span class="token comment">#this command must be run on each branch</span>

git ls-files --other --ignored --exclude-standard

git push origin --force --all
git push origin --force --tags
git for-each-ref --format=<span class="token string">&quot;delete %(refname)&quot;</span> refs/original | git update-ref --stdin
git reflog expire --expire=now --all
git gc --prune=now

<span class="token comment">#fetch modified remote</span>

git fetch --all

<span class="token comment">#&quot;Pull&quot; changes WITHOUT deleting newly-ignored files from working directory</span>
<span class="token comment">#This will overwrite local tracked files with remote - ensure any local modifications are backed-up/stashed</span>

git reset FETCH_HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p><strong>6. Usage scenario: Development Log file exceeds GitHub's file size limit, even after deleting file</strong></p> <blockquote><p><font size="2">💯Score: 8    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-commit.html">git commit</a> ]    🌐<a href="https://stackoverflow.com/questions/19082812" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rm log/development.log
git commit -m <span class="token string">&quot;removed log file&quot;</span>

git rm -r --cached log
git commit -m <span class="token string">&quot;removed log file&quot;</span>

git filter-branch --index-filter <span class="token string">'git rm --cached --ignore-unmatch log/development.log'</span> --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>7. Usage scenario: Git - Squash All Commits in History Before Specific Commit</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ <a href="/./richen/git-replace.html">git replace</a> ]    🌐<a href="https://stackoverflow.com/questions/53589816" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git replace --graft &lt;hash-of-*&gt;

git filter-branch --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>8. Usage scenario: Clean Git Repository using gitignore</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-ls-files.html">git ls-files</a> ]    🌐<a href="https://stackoverflow.com/questions/30359405" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Only the last commit
git rm --cached -r .
git add .

▲ All commits (entire history)
git ls-files --exclude-standard --others --directory --ignored

<span class="token comment">#!/bin/bash</span>
for f in `git ls-files --exclude-standard --others --directory --ignored`
do
    git filter-branch --force --index-filter <span class="token string">&quot;git rm --cached --ignore-unmatch '$f'&quot;</span> --prune-empty --tag-name-filter cat -- --all
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>9. Usage scenario: git filter-branch led to a disconnected history: how to get rid of the old commits?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/17973408" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>cvs2git --blobfile=blob --dump=dump /path/to/cvs/base
<span class="token comment"># Module 1</span>
git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter <span class="token string">&quot;path/to/module1&quot;</span> -- --all
<span class="token comment"># Module 2</span>
git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter <span class="token string">&quot;path/to/module2&quot;</span> -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>10. Usage scenario: combine old git history into initial commit</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/18825907" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch \
  --parent-filter <span class="token string">'test $GIT_COMMIT = &lt;initial-commit-id&gt; &amp;&amp; echo &quot;&quot; || cat'</span> \
  --tag-name-filter cat -- --all

echo <span class="token string">&quot;&lt;initial-commit-id&gt; &quot;</span> &gt;&gt; info/grafts  # .git/info/grafts in non-bare repo
git filter-branch --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>11. Usage scenario: Rebasing merged trees in Git</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/21897610" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --parent-filter &lt;somescript&gt; --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>12. Usage scenario: Moving a file in git history</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/50533809" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ TL;DR
git filter-branch --tree-filter &lt;fill this in&gt; --tag-name-filter cat -- --all

▲ Long
mv old-relative-path new-relative-path
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>13. Usage scenario: git surgery - splitting out a single repository into many repositories</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-pull.html">git pull</a>, <a href="/./richen/git-branch.html">git branch</a> ]    🌐<a href="https://stackoverflow.com/questions/4670814" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>$ cd /path/to/global-repo

<span class="token command">$ git branch work-foo master</span>
<span class="token command">$ git filter-branch<span class="token parameter"> --tag</span>-name-filter cat<span class="token parameter"> --subdirectory</span>-filter foo \</span>
      --prune-empty work-foo

$ cd /path/to
$ mkdir foo-repo
$ cd foo-repo
<span class="token command">$ git init</span>
<span class="token command">$ git pull /path/to/global-repo work-foo</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>14. Usage scenario: Remove commits which aren't in subtree nor in original repository</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/21292754" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tag-name-filter cat --prune-empty
    --subdirectory-filter main -- --all --not --remotes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>15. Usage scenario: git rebase with branches (whole tree)</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-show-ref.html">git show-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/17107452" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>$ echo `git rev-list [E] -1` `git rev-list master1 -1` &gt; .git/info/grafts
<span class="token command">$ git filter-branch<span class="token parameter"> --tag</span>-name-filter cat master2 [other branches]</span>

<span class="token command">$ git filter-branch<span class="token parameter"> --tag</span>-name-filter cat `git show-ref<span class="token parameter"> --heads</span> | awk </span><span class="token string">'{print $2}'</span>`
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>16. Usage scenario: How can I reduce the size of my git repo?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-verify-pack.html">git verify-pack</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/34327110" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-list --objects --all | sort -k 2 &gt; allfileshas.txt

git gc &amp;&amp; git verify-pack -v .git/objects/pack/pack-*.idx | egrep <span class="token string">&quot;^\w+ blob\W+[0-9]+ [0-9]+ [0-9]+$&quot;</span> | sort -k 3 -n -r &gt; bigobjects.txt

git filter-branch --prune-empty --index-filter <span class="token string">'git rm -rf --cached --ignore-unmatch MY-BIG-DIRECTORY-OR-FILE'</span> --tag-name-filter cat -- --all

git clone --no-hardlinks file:///Users/yourUser/your/full/repo/path repo-clone-name

git push --force
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="prune-empty"><a href="#prune-empty" class="header-anchor">#</a> 🔹 --prune-empty</h2> <p><strong>1. Usage scenario: Detach (move) subdirectory into separate Git repository</strong></p> <blockquote><p><font size="2">💯Score: 1263    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-gc.html">git gc</a> ]    🌐<a href="https://stackoverflow.com/questions/359759" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone /XYZ /ABC

cd /ABC
for i in branch1 br2 br3; do git branch -t $i origin/$i; done
git remote rm origin

cd /ABC
for i in $(git branch -r | sed <span class="token string">&quot;s/.*origin\///&quot;</span>); do git branch -t $i origin/$i; done
git remote rm origin

git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter ABC -- --all

git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter ABC HEAD

git reset --hard
git for-each-ref --format=<span class="token string">&quot;%(refname)&quot;</span> refs/original/ | xargs -n 1 git update-ref -d
git reflog expire --expire=now --all
git gc --aggressive --prune=now
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>2. Usage scenario: Remove folder and its contents from git/GitHub's history</strong></p> <blockquote><p><font size="2">💯Score: 643    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/17824718" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">&quot;rm -rf node_modules&quot;</span> --prune-empty HEAD
git for-each-ref --format=<span class="token string">&quot;%(refname)&quot;</span> refs/original/ | xargs -n 1 git update-ref -d
echo node_modules/ &gt;&gt; .gitignore
git add .gitignore
git commit -m <span class="token string">'Removing node_modules from git history'</span>
git gc
git push origin master --force
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>3. Usage scenario: How to remove origin from git repository</strong></p> <blockquote><p><font size="2">💯Score: 622    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a> ]    🌐<a href="https://stackoverflow.com/questions/9224789" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git remote rm origin

git filter-branch --prune-empty --subdirectory-filter path/to/subtree HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>4. Usage scenario: Split large Git repository into many smaller ones</strong></p> <blockquote><p><font size="2">💯Score: 81    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/3910697" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone MyHugeRepo/ MyABRepo.tmp/
cd MyABRepo.tmp
git filter-branch --prune-empty --index-filter <span class="token string">'git rm --cached --ignore-unmatch DIR_1/* DIR_2/*'</span> HEAD 

cd ..
git clone MyABRepo.tmp MyABRepo

git clone MyHugeRepo/ MyABRepo.tmp/
cd MyABRepo.tmp
git filter-branch -d /tmp/git-rewrite.tmp --prune-empty --index-filter <span class="token string">'git rm --cached --ignore-unmatch DIR_1/* DIR_2/*'</span> HEAD 
cd ..
git clone MyABRepo.tmp MyABRepo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>5. Usage scenario: Remove empty commits in git</strong></p> <blockquote><p><font size="2">💯Score: 43    🔗Associated commands: [ <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/28313729" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>$ ... create repository ...
$ cd some-tmp-dir; git clone --mirror file://path-to-original

<span class="token command">$ git filter-branch<span class="token parameter"> --prune</span>-empty<span class="token parameter"> --tag</span>-name-filter cat --<span class="token parameter"> --all</span></span>

<span class="token command">$ git for-each-ref<span class="token parameter"> --format</span>=</span><span class="token string">&quot;%(refname)&quot;</span> refs/original/ | xargs -n 1 git update-ref -d

$ cd third-tmp-dir; git clone --mirror file://path-to-filtered-tmp

<span class="token command">$ git log     # and other commands to inspect</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>6. Usage scenario: Extract part of a git repository?</strong></p> <blockquote><p><font size="2">💯Score: 37    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/2538259" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --subdirectory-filter Project/SubProject-0 --prune-empty -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>7. Usage scenario: How to move a file from one git repository to another while preserving history</strong></p> <blockquote><p><font size="2">💯Score: 37    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-ls-files.html">git ls-files</a>, <a href="/./richen/git-prune.html">git prune</a>, <a href="/./richen/git-gc.html">git gc</a> ]    🌐<a href="https://stackoverflow.com/questions/10524661" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>~$ cd neu
<span class="token command">~/neu$ git filter-branch<span class="token parameter"> --subdirectory</span>-filter FooBar HEAD</span>
<span class="token command">~/neu$ git reset<span class="token parameter"> --hard</span></span>
<span class="token command">~/neu$ git remote rm origin</span>
~/neu$ rm -r .git/refs/original/
<span class="token command">~/neu$ git reflog expire<span class="token parameter"> --expire</span>=now<span class="token parameter"> --all</span></span>
<span class="token command">~/neu$ git gc<span class="token parameter"> --aggressive</span></span>
<span class="token command">~/neu$ git prune</span>
<span class="token command">~/neu$ git remote add origin git://github.com/FooBar/neu.git</span>

 git filter-branch --prune-empty --subdirectory-filter myDirectory -- --all

 git filter-branch -f --prune-empty --index-filter <span class="token string">&quot;git rm --cached --ignore-unmatch $(git ls-files | grep -v 'keepthisfile.txt')&quot;</span>

 git reset --hard
 git gc --aggressive
 git prune
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>8. Usage scenario: How to remove previously added git subtree and its history</strong></p> <blockquote><p><font size="2">💯Score: 30    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a> ]    🌐<a href="https://stackoverflow.com/questions/26245982" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --index-filter <span class="token string">'git rm --cached --ignore-unmatch -rf dir1 dir2 dirN file1 file2 fileN'</span> --prune-empty -f HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>9. Usage scenario: How to split a git repository and follow directory renames?</strong></p> <blockquote><p><font size="2">💯Score: 18    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-update-index.html">git update-index</a>, <a href="/./richen/git-ls-files.html">git ls-files</a> ]    🌐<a href="https://stackoverflow.com/questions/14764368" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --prune-empty --index-filter '
    # Delete files which are NOT needed
    git ls-files -z | egrep -zv  <span class="token string">&quot;^(NAME1|NAME2|NAME3)&quot;</span> | 
        xargs -0 -r git rm --cached -q             
    # Move files to root directory
    git ls-files -s | sed -e <span class="token string">&quot;s-\t\(NAME1\|NAME2\|NAME3\)/-\t-&quot;</span> |
        GIT_INDEX_FILE=$GIT_INDEX_FILE.new \
        git update-index --index-info &amp;&amp;
        ( test ! -f <span class="token string">&quot;$GIT_INDEX_FILE.new&quot;</span> \
            || mv -f <span class="token string">&quot;$GIT_INDEX_FILE.new&quot;</span> <span class="token string">&quot;$GIT_INDEX_FILE&quot;</span> )
'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>10. Usage scenario: How do I preserve tags when filtering a repository?</strong></p> <blockquote><p><font size="2">💯Score: 15    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/5574694" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> git filter-branch --tree-filter <span class="token string">'move-to-subdir $subdir'</span> --prune-empty --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>11. Usage scenario: Split one subfolder from git repository with all branches and history</strong></p> <blockquote><p><font size="2">💯Score: 12    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/47084338" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git clone https://github.com/USERNAME/REPOSITORY-NAME</span>
$ cd REPOSITORY-NAME

$ for i in $(git branch -r | sed <span class="token string">&quot;s/.*origin\///&quot;</span>); do git branch -t $i origin/$i; done

<span class="token command">$ git filter-branch<span class="token parameter"> --prune</span>-empty<span class="token parameter"> --subdirectory</span>-filter FOLDER-NAME --<span class="token parameter"> --all</span></span>

<span class="token command">$ git filter-branch<span class="token parameter"> --prune</span>-empty<span class="token parameter"> --tree</span>-filter </span><span class="token string">'rm -rf FOLDER-NAME'</span> -- --all

<span class="token command">$ git remote<span class="token parameter"> -v</span></span>
origin  https://github.com/USERNAME/REPOSITORY-NAME.git (fetch)
origin  https://github.com/USERNAME/REPOSITORY-NAME.git (push)
<span class="token command">$ git remote set-url origin https://github.com/USERNAME/NEW-REPOSITORY-NAME.git</span>
<span class="token command">$ git remote<span class="token parameter"> -v</span></span>
origin  https://github.com/USERNAME/NEW-REPOSITORY-NAME.git (fetch)
origin  https://github.com/USERNAME/NEW-REPOSITORY-NAME.git (push)

<span class="token command">$ git push<span class="token parameter"> -u</span> origin<span class="token parameter"> --all</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>12. Usage scenario: Can I do a subtree merge from a subdirectory?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/16603719" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git remote add b &lt;URL_TO_B&gt;
git fetch b
git checkout -b b_master b/master

git filter-branch --prune-empty --subdirectory-filter foo b_master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>13. Usage scenario: How can I extract a portion of a git repository into it's own repo while retaining history and file structure?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-merge.html">git merge</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-read-tree.html">git read-tree</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/25316857" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone initial final
cd final
git filter-branch --tree-filter <span class="token string">'rm -rf &lt;list of folders separated by space&gt;'</span> HEAD

git filter-branch -f --prune-empty 

 git filter-branch –prune-empty –subdirectory-filter A/ master
 git filter-branch –prune-empty –subdirectory-filter B/ master

git clone &lt;remote path&gt; NewRepo
cd NewRepo

<span class="token comment"># add a readme file</span>
touch Readme.md
git add .
git commit -am <span class="token string">&quot;Adding ReadMe file&quot;</span>

<span class="token comment"># Merge Repo A</span>
git remote add -f A &lt;remote path for A&gt;
git merge -s ours --no-commit A/master
git read-tree --prefix=A/ -u A/master
git commit -m <span class="token string">&quot;Merge A into NewRepo&quot;</span>
git remote remove A

<span class="token comment"># Merge Repo B</span>
git remote add -f B &lt;remote path for B&gt;
git merge -s ours --no-commit B/master
git read-tree --prefix=B/ -u B/master
git commit -m <span class="token string">&quot;Merge B into NewRepo&quot;</span>
git remote remove B

git remote add origin &lt;remote path for NewRepo&gt;
git push origin master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p><strong>14. Usage scenario: git filter-branch led to a disconnected history: how to get rid of the old commits?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/17973408" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>cvs2git --blobfile=blob --dump=dump /path/to/cvs/base
<span class="token comment"># Module 1</span>
git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter <span class="token string">&quot;path/to/module1&quot;</span> -- --all
<span class="token comment"># Module 2</span>
git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter <span class="token string">&quot;path/to/module2&quot;</span> -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>15. Usage scenario: git push a sub-directory into another main repo</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-push.html">git push</a>, <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/25407830" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone &lt;ORIG_REPO_DIR&gt; &lt;NEW_REPO_DIR&gt;
cd &lt;NEW_REPO_DIR&gt;
git filter-branch --prune-empty --subdirectory-filter &lt;THE_SUBDIR_TO_MAKE_NEW_ROOTDIR&gt; master
git push &lt;MY_NEW_REMOTE_ORIGIN_URL&gt; -f .
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>16. Usage scenario: Checkout a Specific Folder within a Git Repository</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/36142629" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ filter-branch
<span class="token comment"># Filter the master branch to your directory and remove empty commits</span>
git filter-branch --prune-empty --subdirectory-filter YOUR_FOLDER_NAME filter_from_branch

▲ subtree split
git subtree split -P &lt;name-of-folder&gt; -b &lt;name-of-new-branch&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>17. Usage scenario: git: How to split off library from project? filter-branch, subtree?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-pull.html">git pull</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-checkout.html">git checkout</a> ]    🌐<a href="https://stackoverflow.com/questions/22259131" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git subtree split -P src/de/fencing_game -b temp-br
git checkout temp-br

<span class="token comment"># -or-, if you really want to keep the full path:</span>

git checkout -b temp-br
cd src/de/fencing_game

git filter-branch --tag-name-filter cat --prune-empty --index-filter <span class="token string">'git rm -rf --cached --ignore-unmatch client server otherstuff'</span> HEAD

<span class="token comment"># also clear out stuff from the sub dir</span>
cd transport 
git filter-branch --tag-name-filter cat --prune-empty --index-filter <span class="token string">'git rm -rf --cached --ignore-unmatch fencing client server'</span> HEAD

git update-ref -d refs/original/refs/heads/temp-br

cd &lt;new-lib-repo&gt;
git init
git pull &lt;original-repo&gt; temp-br
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>18. Usage scenario: Split file into separate repository, preserving history</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/43004729" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'find -type f -not -path ./foo/bar -delete'</span> --prune-empty
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>19. Usage scenario: How to rebase git submodule preserving references to submodule commits from git repository containing the submodule?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-for-each-ref.html">git for-each-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/40199538" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> cd /submodule/repo/just/rewritten/
 # the old history is still available in refs/original
 git -C /path/to/rewritten/repo for-each-ref --format=<span class="token string">&quot;%(refname)&quot;</span> refs/original

 cd /main/repo
git for-each-ref --contains &lt;SHA1&gt; # SHA being a SHA1 from the old submodule history

git filter-branch --prune-empty --tree-filter <span class="token string">'change_gitlink'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>20. Usage scenario: Remove a file from a older commit without affecting any other commits in gitlab</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-commit.html">git commit</a> ]    🌐<a href="https://stackoverflow.com/questions/57473979" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">(master)$ git rm path/to/filetoremove</span>
<span class="token command">(master)$ git commit<span class="token parameter"> -m</span> </span><span class="token string">&quot;Commit removing filetoremove&quot;</span>
(master)$ java -jar ~/Downloads/bfg.jar --delete-files filetoremove

<span class="token command">(master)$ git filter-branch<span class="token parameter"> --force</span><span class="token parameter"> --index</span>-filter </span><span class="token string">'git rm --cached --ignore-unmatch filepattern'</span> --prune-empty --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>21. Usage scenario: Export git history, for a file and a subfolder, into another existing git repo?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-cherry-pick.html">git cherry-pick</a>, <a href="/./richen/git-pull.html">git pull</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/56328369" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>cd oldrepo_filt_git
git filter-branch --index-filter <span class="token string">&quot;git rm --cached --ignore-unmatch -r $(bash -O extglob -c 'ls -xd !(a*)')&quot;</span> --prune-empty -- --all

<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter </span><span class="token string">&quot;git rm --cached --ignore-unmatch -r $(bash -O extglob -c 'ls -xd !(a*)')&quot;</span> --prune-empty -- --all
Rewrite 252bf7ff5f385dad880240d5d80e68f24ae09b59 (1/8) (0 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
Rewrite f318d9712cd7aacdb5dd45febbcdbbce6b741e08 (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
Rewrite 00b62e7da8784d45850d7483cbea88fdc4aa844c (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite c618eff47d38412c54a8381a5bacc921bddefe2d (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 2cada8d822d83f37bdc4a37bcfb03047c1cc1ded (5/8) (3 seconds passed, remaining 1 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 7b296b70018f4105f190d06ed4d9c58e3f80532f (5/8) (3 seconds passed, remaining 1 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 18a1ad1d35cd8573c39485d0a29b630325f9727d (7/8) (5 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 2ffbbf03d51363f1ced3aaaf000d5921c9d8b919 (7/8) (5 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>

Ref <span class="token string">'refs/heads/master'</span> was rewritten
Ref <span class="token string">'refs/heads/testbranch'</span> was rewritten

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span><span class="token parameter"> --stat</span></span>
*   31cd8b5 (HEAD -&gt; master) Merge branch <span class="token string">'testbranch'</span>
|\
| * 42b153d (testbranch) change 5 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * ff1be9d change 4 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * 90f050c change 3 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * d2d2136 change 2 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * ab237ac change 1 made
|/
|    a.txt     | 1 +
|    aa/aa.txt | 1 +
|    aa/ab.txt | 1 +
|    3 files changed, 3 insertions(+)
* ea0a32d added a.txt
   a.txt | 1 +
   1 file changed, 1 insertion(+)

git remote add oldrepo ../oldrepo_filt_git/
git pull oldrepo master --allow-unrelated-histories

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span><span class="token parameter"> --stat</span></span>
*   845c81e (HEAD -&gt; master) Merge branch <span class="token string">'master'</span> of ../oldrepo_filt_git
|\
| *   31cd8b5 (oldrepo/master) Merge branch <span class="token string">'testbranch'</span>
| |\
| | * 42b153d (oldrepo/testbranch) change 5 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * ff1be9d change 4 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * 90f050c change 3 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * d2d2136 change 2 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * ab237ac change 1 made
| |/
| |    a.txt     | 1 +
| |    aa/aa.txt | 1 +
| |    aa/ab.txt | 1 +
| |    3 files changed, 3 insertions(+)
| * ea0a32d added a.txt
|    a.txt | 1 +
|    1 file changed, 1 insertion(+)
* 8e99c2d Initial commit by Bob
   README | 1 +
   1 file changed, 1 insertion(+)

<span class="token command">$ git remote add old-repo ../oldrepo_filt_git</span>

<span class="token command">$ git fetch old-repo</span>
warning: no common commits
remote: Enumerating objects: 29, done.
remote: Counting objects: 100% (29/29), done.
remote: Compressing objects: 100% (17/17), done.
remote: Total 29 (delta 2), reused 0 (delta 0)
Unpacking objects: 100% (29/29), done.
From ../oldrepo_filt_git
 * [new branch]      master     -&gt; old-repo/master
 * [new branch]      testbranch -&gt; old-repo/testbranch

<span class="token command">$ git branch oldrepo-head old-repo/master</span>
Branch <span class="token string">'oldrepo-head'</span> set up to track remote branch <span class="token string">'master'</span> from <span class="token string">'old-repo'</span>.

<span class="token command">$ git branch oldrepo-root $(git log oldrepo-head<span class="token parameter"> --reverse</span><span class="token parameter"> --pretty</span>=%H | head<span class="token parameter"> -n</span> 1)</span>

<span class="token command">$ git log<span class="token parameter"> --pretty</span>=</span><span class="token string">'%T %ct'</span> ..oldrepo-head &gt; /tmp/hashlist

<span class="token command">$ git branch<span class="token parameter"> -m</span> master new-master</span>

<span class="token command">$ git cherry-pick<span class="token parameter"> --strategy</span>-option=theirs oldrepo-root</span>
[new-master 427cf77] added a.txt
 Author: tester &lt;tester@example.com&gt;
 Date: Mon May 27 14:31:10 2019 +0200
 1 file changed, 1 insertion(+)
 create mode 100644 a.txt

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span></span>
* 427cf77 (HEAD -&gt; new-master) added a.txt
* 8e99c2d Initial commit by Bob

<span class="token command">$ git rebase<span class="token parameter"> --preserve</span>-merges<span class="token parameter"> --onto</span> new-master<span class="token parameter"> --root</span> oldrepo-head</span>
Successfully rebased and updated refs/heads/oldrepo-head.

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit 61fbe54721a9432e91e48917ed036f55da4105a4 (HEAD -&gt; oldrepo-head)
|\  Merge: 427cf77 f8e8f8a
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:57:00 2019 +0200
| |
| |     Merge branch <span class="token string">'testbranch'</span>
| |
| * commit f8e8f8aedaa7bc999bdfdd49542c9ee04edb770c
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:00 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:58 2019 +0200
| |
| |     change 5 made
| |
| * commit b084029040d6596e0795e7567b2684dc59c02241
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:50 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:56 2019 +0200
| |
| |     change 4 made
| |
| * commit b62dabca3a46efbe76edb10591935db136f74aaa
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:40 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:54 2019 +0200
| |
| |     change 3 made
| |
| * commit 252f3e9697b87b4f59cd0a74681ef25401340fcf
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:30 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:51 2019 +0200
| |
| |     change 2 made
| |
| * commit c382c8a713489ca0e5dc106bed29fdce379952b0
|/  Author:     tester &lt;tester@example.com&gt;
|   AuthorDate: Mon May 27 14:31:20 2019 +0200
|   Commit:     bob &lt;bob@example.com&gt;
|   CommitDate: Tue May 28 12:56:49 2019 +0200
|
|       change 1 made
|
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (new-master)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
|
|     added a.txt
|
* commit 8e99c2d71048b4999d012b33d34386351d6d0fef
  Author:     bob &lt;bob@example.com&gt;
  AuthorDate: Mon May 27 14:31:00 2019 +0200
  Commit:     bob &lt;bob@example.com&gt;
  CommitDate: Mon May 27 14:31:00 2019 +0200

      Initial commit by Bob

<span class="token command">$ git filter-branch<span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(fgrep -m 1 $(git log -1 --pretty=%T $GIT_COMMIT) /tmp/hashlist | cut -d&quot; &quot; -f2)'</span> new-master..oldrepo-head
Rewrite 61fbe54721a9432e91e48917ed036f55da4105a4 (3/6) (1 seconds passed, remaining 1 predicted)
Ref <span class="token string">'refs/heads/oldrepo-head'</span> was rewritten

<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> new-master..oldrepo-head
Rewrite f2b2385d85c74dbf0cbf8fabc02ec30cb50d8f2a (3/6) (1 seconds passed, remaining 1 predicted)
Ref <span class="token string">'refs/heads/oldrepo-head'</span> was rewritten

sd@DESKTOP-RO11QOC MSYS /c/Users/sd/AppData/Local/Temp/newrepo_git
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> 427cf77417a
You must specify a ref to rewrite.

sd@DESKTOP-RO11QOC MSYS /c/Users/sd/AppData/Local/Temp/newrepo_git
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> new-master
Rewrite 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (2/2) (0 seconds passed, remaining 0 predicted)
Ref <span class="token string">'refs/heads/new-master'</span> was rewritten

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit cdaa4b82f3833770a9051a2490487548603e3af8 (HEAD -&gt; oldrepo-head)
|\  Merge: 427cf77 9bfc6cd
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:10 2019 +0200
| |
| |     Merge branch <span class="token string">'testbranch'</span>
| |
...
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (refs/original/refs/heads/new-master)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
|
|     added a.txt
|
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
...

<span class="token command">$ git branch<span class="token parameter"> -m</span> oldrepo-head master</span>
<span class="token command">$ git branch<span class="token parameter"> -D</span> oldrepo-root</span>
Deleted branch oldrepo-root (was ea0a32d).
<span class="token command">$ git branch<span class="token parameter"> -D</span> new-master</span>
Deleted branch new-master (was 4ac225e).
$ rm .git/refs/original/refs/heads/new-master
<span class="token command">$ git remote remove old-repo</span>

<span class="token command">$ git branch tmp 427cf774</span>
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> tmp^..tmp
Rewrite 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (1/1) (0 seconds passed, remaining 0 predicted)
Ref <span class="token string">'refs/heads/tmp'</span> was rewritten
<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller tmp</span>
* commit 4ac225e308e280e3a96be0168c6e9dece44d4979 (tmp)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Mon May 27 14:31:10 2019 +0200
|
|     added a.txt
|
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
|
...
<span class="token command">$ git branch<span class="token parameter"> -D</span> tmp</span>
Deleted branch tmp (was 4ac225e).

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit cdaa4b82f3833770a9051a2490487548603e3af8
|\  Merge: 427cf77 9bfc6cd
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:10 2019 +0200
| | 
| |     Merge branch <span class="token string">'testbranch'</span>
| | 
| * commit 9bfc6cde58be9102102f839e5cc0fe8f25f0f78c
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:00 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:00 2019 +0200
| | 
| |     change 5 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 485ae0f50054610b6a41098fb695e59d194cc856
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:50 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:50 2019 +0200
| | 
| |     change 4 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit b6804b6e8e313b5c4766568a287f0785503e3a11
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:40 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:40 2019 +0200
| | 
| |     change 3 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 8b463423d2a99929a6a248e38ba1368a56d3769d
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:30 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:30 2019 +0200
| | 
| |     change 2 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 3bc0bed30ebea1498a15711825b2ea8347cc374d
|/  Author:     tester &lt;tester@example.com&gt;
|   AuthorDate: Mon May 27 14:31:20 2019 +0200
|   Commit:     bob &lt;bob@example.com&gt;
|   CommitDate: Mon May 27 14:31:20 2019 +0200
|   
|       change 1 made
|   
|    a.txt     | 1 +
|    aa/aa.txt | 1 +
|    aa/ab.txt | 1 +
|    3 files changed, 3 insertions(+)
| 
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
| 
|     added a.txt
| 
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
| 
* commit 8e99c2d71048b4999d012b33d34386351d6d0fef
  Author:     bob &lt;bob@example.com&gt;
  AuthorDate: Mon May 27 14:31:00 2019 +0200
  Commit:     bob &lt;bob@example.com&gt;
  CommitDate: Mon May 27 14:31:00 2019 +0200

      Initial commit by Bob

   README | 1 +
   1 file changed, 1 insertion(+)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br></div></div><p><strong>22. Usage scenario: How to remove some files accidentally added in the first commit?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/20808429" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'rm fileToRemove'</span> --prune-empty --force HEAD

git filter-branch --tree-filter <span class="token string">'rm -fR dirToRemove'</span> --prune-empty --force HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>23. Usage scenario: Remove commits which aren't in subtree nor in original repository</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/21292754" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tag-name-filter cat --prune-empty
    --subdirectory-filter main -- --all --not --remotes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>24. Usage scenario: How can I reduce the size of my git repo?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-verify-pack.html">git verify-pack</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/34327110" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git rev-list --objects --all | sort -k 2 &gt; allfileshas.txt

git gc &amp;&amp; git verify-pack -v .git/objects/pack/pack-*.idx | egrep <span class="token string">&quot;^\w+ blob\W+[0-9]+ [0-9]+ [0-9]+$&quot;</span> | sort -k 3 -n -r &gt; bigobjects.txt

git filter-branch --prune-empty --index-filter <span class="token string">'git rm -rf --cached --ignore-unmatch MY-BIG-DIRECTORY-OR-FILE'</span> --tag-name-filter cat -- --all

git clone --no-hardlinks file:///Users/yourUser/your/full/repo/path repo-clone-name

git push --force
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>25. Usage scenario: New git repo from selected files in existing repo</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/26903814" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --prune-empty --subdirectory-filter YOUR_FOLDER_NAME master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>26. Usage scenario: Move history from git repo to subtree</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-pull.html">git pull</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-remote.html">git remote</a> ]    🌐<a href="https://stackoverflow.com/questions/32291121" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone &lt;git repository A url&gt;
cd &lt;git repository A directory&gt;
git remote rm origin
git filter-branch --subdirectory-filter &lt;directory 1&gt; --

git clone &lt;git repository B url&gt;
cd &lt;git repository B directory&gt;
git remote add repo-A-branch &lt;git repository A directory&gt;
git pull repo-A-branch master
git remote rm repo-A-branch

git filter-branch --tree-filter <span class="token string">'rm -rf &lt;bad subdirectory&gt;'</span> --prune-empty HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>27. Usage scenario: git subtree changes the package directory</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-reset.html">git reset</a> ]    🌐<a href="https://stackoverflow.com/questions/19748453" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git checkout<span class="token parameter"> -b</span> moved_package_branch</span>
<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter </span><span class="token string">'git rm --cached -qr -- . &amp;&amp; git reset -q $GIT_COMMIT -- src/main/java/com/company/package'</span> --prune-empty
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="d"><a href="#d" class="header-anchor">#</a> 🔹 -d</h2> <p><strong>1. Usage scenario: How can I move a directory in a Git repo for all commits?</strong></p> <blockquote><p><font size="2">💯Score: 102    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/3142821" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ You can use the subdirectory filter to achieve this
<span class="token command"> $ git filter-branch<span class="token parameter"> --subdirectory</span>-filter blog/ --<span class="token parameter"> --all</span></span>

▲ EDIT 1: If you don't want to effectively make _posts the root, use a tree-filter instead:
<span class="token command"> $ git filter-branch<span class="token parameter"> --tree</span>-filter </span><span class="token string">'mv blog/_posts .'</span> HEAD

▲ EDIT 2: If blog/_posts did not exist in some of the commits, the above will fail. Use this instead:
<span class="token command"> $ git filter-branch<span class="token parameter"> --tree</span>-filter </span><span class="token string">'test -d blog/_posts &amp;&amp; mv blog/_posts . || echo &quot;Nothing to do&quot;'</span> HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>2. Usage scenario: Split large Git repository into many smaller ones</strong></p> <blockquote><p><font size="2">💯Score: 81    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/3910697" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone MyHugeRepo/ MyABRepo.tmp/
cd MyABRepo.tmp
git filter-branch --prune-empty --index-filter <span class="token string">'git rm --cached --ignore-unmatch DIR_1/* DIR_2/*'</span> HEAD 

cd ..
git clone MyABRepo.tmp MyABRepo

git clone MyHugeRepo/ MyABRepo.tmp/
cd MyABRepo.tmp
git filter-branch -d /tmp/git-rewrite.tmp --prune-empty --index-filter <span class="token string">'git rm --cached --ignore-unmatch DIR_1/* DIR_2/*'</span> HEAD 
cd ..
git clone MyABRepo.tmp MyABRepo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>3. Usage scenario: Splitting many subdirectories into a new, separate Git repository</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/31841516" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> git filter-branch --tree-filter <span class="token string">&quot;mkdir samples &amp;&amp; test -d app1 &amp;&amp; mv app1 samples/|| test -d app2 &amp;&amp; mv app2 samples/ || echo 'nothing to do'&quot;</span> HEAD

git filter-branch -f --subdirectory-filter samples -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>4. Usage scenario: efficiently rewriting (rebase -i) a lot of history with git</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/10919879" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --tree-filter <span class="token string">'[[ -f README ]] &amp;&amp; echo &quot;---FOOTER---&quot; &gt;&gt; README'</span> HEAD

git filter-branch -d /dev/shm/git --tree-filter \
<span class="token string">'perl /path/to/find-add-license.pl'</span> --prune-empty HEAD

git filter-branch -d /dev/shm/git --tree-filter \
<span class="token string">'find . -name &quot;*.[chS]&quot; -exec perl /path/to/just-add-license.pl \{\} \;'</span> \
<span class="token deleted">--prune-empty HEAD</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="f"><a href="#f" class="header-anchor">#</a> 🔹 -f</h2> <p><strong>1. Usage scenario: How to remove/delete a large file from commit history in the Git repository?</strong></p> <blockquote><p><font size="2">💯Score: 248    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/30274113" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'rm -f DVD-rip'</span> HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>2. Usage scenario: How to move a file from one git repository to another while preserving history</strong></p> <blockquote><p><font size="2">💯Score: 37    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-ls-files.html">git ls-files</a>, <a href="/./richen/git-prune.html">git prune</a>, <a href="/./richen/git-gc.html">git gc</a> ]    🌐<a href="https://stackoverflow.com/questions/10524661" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>~$ cd neu
<span class="token command">~/neu$ git filter-branch<span class="token parameter"> --subdirectory</span>-filter FooBar HEAD</span>
<span class="token command">~/neu$ git reset<span class="token parameter"> --hard</span></span>
<span class="token command">~/neu$ git remote rm origin</span>
~/neu$ rm -r .git/refs/original/
<span class="token command">~/neu$ git reflog expire<span class="token parameter"> --expire</span>=now<span class="token parameter"> --all</span></span>
<span class="token command">~/neu$ git gc<span class="token parameter"> --aggressive</span></span>
<span class="token command">~/neu$ git prune</span>
<span class="token command">~/neu$ git remote add origin git://github.com/FooBar/neu.git</span>

 git filter-branch --prune-empty --subdirectory-filter myDirectory -- --all

 git filter-branch -f --prune-empty --index-filter <span class="token string">&quot;git rm --cached --ignore-unmatch $(git ls-files | grep -v 'keepthisfile.txt')&quot;</span>

 git reset --hard
 git gc --aggressive
 git prune
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>3. Usage scenario: How to rename last N commits messages in git?</strong></p> <blockquote><p><font size="2">💯Score: 32    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/14201492" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --msg-filter &lt;command&gt;

git filter-branch -f --msg-filter '
    echo <span class="token string">&quot;Bug XXXXXXX: \c&quot;</span>
    &amp;&amp; cat
    ' HEAD~&lt;N&gt;..HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>4. Usage scenario: How to remove previously added git subtree and its history</strong></p> <blockquote><p><font size="2">💯Score: 30    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a> ]    🌐<a href="https://stackoverflow.com/questions/26245982" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --index-filter <span class="token string">'git rm --cached --ignore-unmatch -rf dir1 dir2 dirN file1 file2 fileN'</span> --prune-empty -f HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>5. Usage scenario: Rebasing a git history with empty commit messages</strong></p> <blockquote><p><font size="2">💯Score: 13    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/8542434" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --msg-filter '
read msg
if [ -n <span class="token string">&quot;$msg&quot;</span> ] ; then
    echo <span class="token string">&quot;$msg&quot;</span>
else
    echo <span class="token string">&quot;The commit message was empty&quot;</span>
fi'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>6. Usage scenario: Definitive retroactive .gitignore (how to make Git completely/retroactively forget about a file now in .gitignore)</strong></p> <blockquote><p><font size="2">💯Score: 11    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-ls-files.html">git ls-files</a>, <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/57454176" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment">#commit up-to-date .gitignore (if not already existing)</span>
<span class="token comment">#these commands must be run on each branch</span>
<span class="token comment">#these commands are not strictly necessary if you don't want/need a .gitignore file.  .git/info/exclude can be used instead</span>

git add .gitignore
git commit -m <span class="token string">&quot;Create .gitignore&quot;</span>

<span class="token comment">#apply standard git ignore behavior only to current index, not working directory (--cached)</span>
<span class="token comment">#if this command returns nothing, ensure /.git/info/exclude AND/OR .gitignore exist</span>
<span class="token comment">#this command must be run on each branch</span>
<span class="token comment">#if using .git/info/exclude, it will need to be modified per branch run, if the branches have differing (per-branch) .gitignore requirements.</span>

git ls-files -z --ignored --exclude-standard | xargs -r0 git rm --cached

<span class="token comment">#Commit to prevent working directory data loss!</span>
<span class="token comment">#this commit will be automatically deleted by the --prune-empty flag in the following command</span>
<span class="token comment">#this command must be run on each branch</span>
<span class="token comment">#optionally use the --amend flag to merge this commit with the previous one instead of creating 2 commits.</span>

git commit -m <span class="token string">&quot;ignored index&quot;</span>

<span class="token comment">#Apply standard git ignore behavior RETROACTIVELY to all commits from all branches (--all)</span>
<span class="token comment">#This step WILL delete ignored files from working directory UNLESS they have been dereferenced from the index by the commit above</span>
<span class="token comment">#This step will also delete any &quot;empty&quot; commits.  If deliberate &quot;empty&quot; commits should be kept, remove --prune-empty and instead run git reset HEAD^ immediately after this command</span>

git filter-branch --tree-filter <span class="token string">'git ls-files -z --ignored --exclude-standard | xargs -r0 git rm -f --ignore-unmatch'</span> --prune-empty --tag-name-filter cat -- --all

<span class="token comment">#List all still-existing files that are now ignored properly</span>
<span class="token comment">#if this command returns nothing, it's time to restore from backup and start over</span>
<span class="token comment">#this command must be run on each branch</span>

git ls-files --other --ignored --exclude-standard

git push origin --force --all
git push origin --force --tags
git for-each-ref --format=<span class="token string">&quot;delete %(refname)&quot;</span> refs/original | git update-ref --stdin
git reflog expire --expire=now --all
git gc --prune=now

<span class="token comment">#fetch modified remote</span>

git fetch --all

<span class="token comment">#&quot;Pull&quot; changes WITHOUT deleting newly-ignored files from working directory</span>
<span class="token comment">#This will overwrite local tracked files with remote - ensure any local modifications are backed-up/stashed</span>

git reset FETCH_HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p><strong>7. Usage scenario: Create a git repository from commits of a previous one</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/4755041" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --subdirectory-filter foobar --prune-empty -- --all

git filter-branch --tree-filter <span class="token string">'rm -f filename1 pattern2.*'</span> --prune-empty -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>8. Usage scenario: How to move function declaration to another file yet retain Git history?</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/17961452" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter 'if [ -f original.php ]; then 
    echo part1.php part2.php part3.php | xargs -n 1 cp original.php; fi' HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>9. Usage scenario: Splitting many subdirectories into a new, separate Git repository</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/31841516" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code> git filter-branch --tree-filter <span class="token string">&quot;mkdir samples &amp;&amp; test -d app1 &amp;&amp; mv app1 samples/|| test -d app2 &amp;&amp; mv app2 samples/ || echo 'nothing to do'&quot;</span> HEAD

git filter-branch -f --subdirectory-filter samples -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>10. Usage scenario: How can I extract a portion of a git repository into it's own repo while retaining history and file structure?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-merge.html">git merge</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-read-tree.html">git read-tree</a>, <a href="/./richen/git-clone.html">git clone</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/25316857" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone initial final
cd final
git filter-branch --tree-filter <span class="token string">'rm -rf &lt;list of folders separated by space&gt;'</span> HEAD

git filter-branch -f --prune-empty 

 git filter-branch –prune-empty –subdirectory-filter A/ master
 git filter-branch –prune-empty –subdirectory-filter B/ master

git clone &lt;remote path&gt; NewRepo
cd NewRepo

<span class="token comment"># add a readme file</span>
touch Readme.md
git add .
git commit -am <span class="token string">&quot;Adding ReadMe file&quot;</span>

<span class="token comment"># Merge Repo A</span>
git remote add -f A &lt;remote path for A&gt;
git merge -s ours --no-commit A/master
git read-tree --prefix=A/ -u A/master
git commit -m <span class="token string">&quot;Merge A into NewRepo&quot;</span>
git remote remove A

<span class="token comment"># Merge Repo B</span>
git remote add -f B &lt;remote path for B&gt;
git merge -s ours --no-commit B/master
git read-tree --prefix=B/ -u B/master
git commit -m <span class="token string">&quot;Merge B into NewRepo&quot;</span>
git remote remove B

git remote add origin &lt;remote path for NewRepo&gt;
git push origin master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p><strong>11. Usage scenario: Merge two repositories (original project and changed project WITHOUT HISTORY)</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/11298335" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git fetch /path/to/original/gephi

git filter-branch -f --parent-filter <span class="token string">'test $GIT_COMMIT = &lt;V&gt; &amp;&amp; echo &quot;-p &lt;E&gt;&quot; || cat'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>12. Usage scenario: efficiently rewriting (rebase -i) a lot of history with git</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/10919879" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --tree-filter <span class="token string">'[[ -f README ]] &amp;&amp; echo &quot;---FOOTER---&quot; &gt;&gt; README'</span> HEAD

git filter-branch -d /dev/shm/git --tree-filter \
<span class="token string">'perl /path/to/find-add-license.pl'</span> --prune-empty HEAD

git filter-branch -d /dev/shm/git --tree-filter \
<span class="token string">'find . -name &quot;*.[chS]&quot; -exec perl /path/to/just-add-license.pl \{\} \;'</span> \
<span class="token deleted">--prune-empty HEAD</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>13. Usage scenario: How to change the specific string throughout all git message commits?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-push.html">git push</a>, <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/15874218" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --msg-filter <span class="token string">'sed &quot;s/git-svn.*$//g&quot;'</span> -- --all

<span class="token command">$ git clone<span class="token parameter"> --mirror</span> git://example.com/my-repo.git</span>

git filter-branch -f --msg-filter <span class="token string">'sed &quot;s/git-svn.*$//g&quot;'</span> -- --all

<span class="token command">$ git push</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>14. Usage scenario: Splitting each commit by file?</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-rebase.html">git rebase</a> ]    🌐<a href="https://stackoverflow.com/questions/34556655" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ git rebase -i aka: squash (manual procedure)
// Manipulate any commit by editing it and commitign again
git rebase -i HEAD~X

▲ git filter-branch
▲ sample
// Remove any given file from commits 
// Now you can commit it again into a new commit

git filter-branch --tree-filter 'rm -f &lt;file name&gt; HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>15. Usage scenario: Create new git repo from already existing repo's subdirectory</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/6687726" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>for branch in $(git for-each-ref --format=<span class="token string">'%(refname:short)'</span> refs/remotes/origin | grep -v HEAD); do
  git checkout -b $(basename $branch) $branch
  git filter-branch -f --subdirectory-filter subdirectory HEAD -- --all
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>16. Usage scenario: correctly rebase a merge</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/11236533" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --parent-filter <span class="token string">'test $GIT_COMMIT = &lt;a2&gt; &amp;&amp; echo &quot;-p &lt;c1&gt;&quot; || cat'</span>
git filter-branch -f --parent-filter <span class="token string">'test $GIT_COMMIT = &lt;new head&gt; &amp;&amp; echo &quot;-p &lt;c2&gt;&quot; || cat'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>17. Usage scenario: How to replace a string in a whole Git history?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/47158332" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ censorStringsInWholeGitHistory.sh:
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#arguments are strings to censore</span>

for string in <span class="token string">&quot;$@&quot;</span>
do
  echo <span class="token string">&quot;&quot;</span>
  echo <span class="token string">&quot;================ Censoring string &quot;</span>$string<span class="token string">&quot;: ================&quot;</span>
  ~/replaceStringInWholeGitHistory.sh <span class="token string">&quot;$string&quot;</span> <span class="token string">&quot;********&quot;</span>
done

~/censorStringsInWholeGitHistory.sh <span class="token string">&quot;my_password1&quot;</span> <span class="token string">&quot;my_password2&quot;</span> <span class="token string">&quot;some_f_word&quot;</span>

▲ replaceStringInWholeGitHistory.sh:
<span class="token comment">#!/bin/bash</span>
<span class="token comment"># $1 - string to find</span>
<span class="token comment"># $2 - string to replace with</span>

for branch in $(git branch | cut -c 3-); do
  echo <span class="token string">&quot;&quot;</span>
  echo <span class="token string">&quot;&gt;&gt;&gt; Replacing strings in branch $branch:&quot;</span>
  echo <span class="token string">&quot;&quot;</span>
  ~/replaceStringInBranch.sh <span class="token string">&quot;$branch&quot;</span> <span class="token string">&quot;$1&quot;</span> <span class="token string">&quot;$2&quot;</span>
done

~/replaceStringInWholeGitHistory.sh <span class="token string">&quot;my_password&quot;</span> <span class="token string">&quot;********&quot;</span>

▲ replaceStringInBranch.sh:
<span class="token comment">#!/bin/bash</span>
<span class="token comment"># $1 - branch</span>
<span class="token comment"># $2 - string to find</span>
<span class="token comment"># $3 - string to replace with</span>

git checkout $1
for file in $(~/findFilesContainingStringInBranch.sh <span class="token string">&quot;$2&quot;</span>); do
  echo <span class="token string">&quot;          Filtering file $file:&quot;</span>
  ~/changeStringsInFileInCurrentBranch.sh <span class="token string">&quot;$file&quot;</span> <span class="token string">&quot;$2&quot;</span> <span class="token string">&quot;$3&quot;</span>
done

~/replaceStringInBranch.sh master <span class="token string">&quot;my_password&quot;</span> <span class="token string">&quot;********&quot;</span>

▲ findFilesContainingStringInBranch.sh:
<span class="token comment">#!/bin/bash</span>

<span class="token comment"># $1 - string to find</span>
<span class="token comment"># $2 - branch name or nothing (current branch in that case)</span>

git log -S <span class="token string">&quot;$1&quot;</span> $2 --name-only --pretty=format: -- | sort -u

~/findFilesContainingStringInBranch.sh <span class="token string">&quot;my_password&quot;</span> master

▲ changeStringsInFileInCurrentBranch.sh:
<span class="token comment">#!/bin/bash</span>

<span class="token comment"># $1 - file name</span>
<span class="token comment"># $2 - string to find</span>
<span class="token comment"># $3 - string to replace</span>

git filter-branch -f --tree-filter <span class="token string">&quot;if [ -f $1 ];then sed -i s/$2/$3/g $1;fi&quot;</span>

~/changeStringsInFileInCurrentBranch.sh <span class="token string">&quot;abc.txt&quot;</span> <span class="token string">&quot;my_password&quot;</span> <span class="token string">&quot;********&quot;</span>

git push &lt;remote&gt; -f --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><p><strong>18. Usage scenario: Splitting a Git repository based on arbitrary file paths</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a> ]    🌐<a href="https://stackoverflow.com/questions/7479926" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token command">$ git filter-branch<span class="token parameter"> --tree</span>-filter </span><span class="token string">&quot;rm -f b-main.js tests/b-tests.js&quot;</span> \
                  --prune-empty HEAD

<span class="token command">$ git remote rm origin</span>
<span class="token command">$ git remote add origin git@github.com:username/reponame.git</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>19. Usage scenario: How to rewrite git history up to a merge commit included</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/59489475" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --env-filter <span class="token string">&quot;......&quot;</span> E^! HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>20. Usage scenario: Removing all deleted files from git repo history w search command</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-log.html">git log</a> ]    🌐<a href="https://stackoverflow.com/questions/37759578" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git log --all --pretty=format: --name-only --diff-filter=D | sort -u | while read -r line; do git filter-branch -f --tree-filter <span class="token string">&quot;rm -rf { $line }&quot;</span> HEAD; done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>21. Usage scenario: Export git history, for a file and a subfolder, into another existing git repo?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-cherry-pick.html">git cherry-pick</a>, <a href="/./richen/git-pull.html">git pull</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-fetch.html">git fetch</a> ]    🌐<a href="https://stackoverflow.com/questions/56328369" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>cd oldrepo_filt_git
git filter-branch --index-filter <span class="token string">&quot;git rm --cached --ignore-unmatch -r $(bash -O extglob -c 'ls -xd !(a*)')&quot;</span> --prune-empty -- --all

<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter </span><span class="token string">&quot;git rm --cached --ignore-unmatch -r $(bash -O extglob -c 'ls -xd !(a*)')&quot;</span> --prune-empty -- --all
Rewrite 252bf7ff5f385dad880240d5d80e68f24ae09b59 (1/8) (0 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
Rewrite f318d9712cd7aacdb5dd45febbcdbbce6b741e08 (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
Rewrite 00b62e7da8784d45850d7483cbea88fdc4aa844c (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite c618eff47d38412c54a8381a5bacc921bddefe2d (2/8) (1 seconds passed, remaining 3 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 2cada8d822d83f37bdc4a37bcfb03047c1cc1ded (5/8) (3 seconds passed, remaining 1 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 7b296b70018f4105f190d06ed4d9c58e3f80532f (5/8) (3 seconds passed, remaining 1 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 18a1ad1d35cd8573c39485d0a29b630325f9727d (7/8) (5 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>
Rewrite 2ffbbf03d51363f1ced3aaaf000d5921c9d8b919 (7/8) (5 seconds passed, remaining 0 predicted)    rm <span class="token string">'README'</span>
rm <span class="token string">'b.txt'</span>
rm <span class="token string">'bb/bb.txt'</span>

Ref <span class="token string">'refs/heads/master'</span> was rewritten
Ref <span class="token string">'refs/heads/testbranch'</span> was rewritten

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span><span class="token parameter"> --stat</span></span>
*   31cd8b5 (HEAD -&gt; master) Merge branch <span class="token string">'testbranch'</span>
|\
| * 42b153d (testbranch) change 5 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * ff1be9d change 4 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * 90f050c change 3 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * d2d2136 change 2 made
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| * ab237ac change 1 made
|/
|    a.txt     | 1 +
|    aa/aa.txt | 1 +
|    aa/ab.txt | 1 +
|    3 files changed, 3 insertions(+)
* ea0a32d added a.txt
   a.txt | 1 +
   1 file changed, 1 insertion(+)

git remote add oldrepo ../oldrepo_filt_git/
git pull oldrepo master --allow-unrelated-histories

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span><span class="token parameter"> --stat</span></span>
*   845c81e (HEAD -&gt; master) Merge branch <span class="token string">'master'</span> of ../oldrepo_filt_git
|\
| *   31cd8b5 (oldrepo/master) Merge branch <span class="token string">'testbranch'</span>
| |\
| | * 42b153d (oldrepo/testbranch) change 5 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * ff1be9d change 4 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * 90f050c change 3 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * d2d2136 change 2 made
| | |  a.txt     | 1 +
| | |  aa/aa.txt | 1 +
| | |  aa/ab.txt | 1 +
| | |  3 files changed, 3 insertions(+)
| | * ab237ac change 1 made
| |/
| |    a.txt     | 1 +
| |    aa/aa.txt | 1 +
| |    aa/ab.txt | 1 +
| |    3 files changed, 3 insertions(+)
| * ea0a32d added a.txt
|    a.txt | 1 +
|    1 file changed, 1 insertion(+)
* 8e99c2d Initial commit by Bob
   README | 1 +
   1 file changed, 1 insertion(+)

<span class="token command">$ git remote add old-repo ../oldrepo_filt_git</span>

<span class="token command">$ git fetch old-repo</span>
warning: no common commits
remote: Enumerating objects: 29, done.
remote: Counting objects: 100% (29/29), done.
remote: Compressing objects: 100% (17/17), done.
remote: Total 29 (delta 2), reused 0 (delta 0)
Unpacking objects: 100% (29/29), done.
From ../oldrepo_filt_git
 * [new branch]      master     -&gt; old-repo/master
 * [new branch]      testbranch -&gt; old-repo/testbranch

<span class="token command">$ git branch oldrepo-head old-repo/master</span>
Branch <span class="token string">'oldrepo-head'</span> set up to track remote branch <span class="token string">'master'</span> from <span class="token string">'old-repo'</span>.

<span class="token command">$ git branch oldrepo-root $(git log oldrepo-head<span class="token parameter"> --reverse</span><span class="token parameter"> --pretty</span>=%H | head<span class="token parameter"> -n</span> 1)</span>

<span class="token command">$ git log<span class="token parameter"> --pretty</span>=</span><span class="token string">'%T %ct'</span> ..oldrepo-head &gt; /tmp/hashlist

<span class="token command">$ git branch<span class="token parameter"> -m</span> master new-master</span>

<span class="token command">$ git cherry-pick<span class="token parameter"> --strategy</span>-option=theirs oldrepo-root</span>
[new-master 427cf77] added a.txt
 Author: tester &lt;tester@example.com&gt;
 Date: Mon May 27 14:31:10 2019 +0200
 1 file changed, 1 insertion(+)
 create mode 100644 a.txt

<span class="token command">$ git log<span class="token parameter"> --oneline</span><span class="token parameter"> --graph</span></span>
* 427cf77 (HEAD -&gt; new-master) added a.txt
* 8e99c2d Initial commit by Bob

<span class="token command">$ git rebase<span class="token parameter"> --preserve</span>-merges<span class="token parameter"> --onto</span> new-master<span class="token parameter"> --root</span> oldrepo-head</span>
Successfully rebased and updated refs/heads/oldrepo-head.

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit 61fbe54721a9432e91e48917ed036f55da4105a4 (HEAD -&gt; oldrepo-head)
|\  Merge: 427cf77 f8e8f8a
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:57:00 2019 +0200
| |
| |     Merge branch <span class="token string">'testbranch'</span>
| |
| * commit f8e8f8aedaa7bc999bdfdd49542c9ee04edb770c
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:00 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:58 2019 +0200
| |
| |     change 5 made
| |
| * commit b084029040d6596e0795e7567b2684dc59c02241
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:50 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:56 2019 +0200
| |
| |     change 4 made
| |
| * commit b62dabca3a46efbe76edb10591935db136f74aaa
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:40 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:54 2019 +0200
| |
| |     change 3 made
| |
| * commit 252f3e9697b87b4f59cd0a74681ef25401340fcf
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:30 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Tue May 28 12:56:51 2019 +0200
| |
| |     change 2 made
| |
| * commit c382c8a713489ca0e5dc106bed29fdce379952b0
|/  Author:     tester &lt;tester@example.com&gt;
|   AuthorDate: Mon May 27 14:31:20 2019 +0200
|   Commit:     bob &lt;bob@example.com&gt;
|   CommitDate: Tue May 28 12:56:49 2019 +0200
|
|       change 1 made
|
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (new-master)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
|
|     added a.txt
|
* commit 8e99c2d71048b4999d012b33d34386351d6d0fef
  Author:     bob &lt;bob@example.com&gt;
  AuthorDate: Mon May 27 14:31:00 2019 +0200
  Commit:     bob &lt;bob@example.com&gt;
  CommitDate: Mon May 27 14:31:00 2019 +0200

      Initial commit by Bob

<span class="token command">$ git filter-branch<span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(fgrep -m 1 $(git log -1 --pretty=%T $GIT_COMMIT) /tmp/hashlist | cut -d&quot; &quot; -f2)'</span> new-master..oldrepo-head
Rewrite 61fbe54721a9432e91e48917ed036f55da4105a4 (3/6) (1 seconds passed, remaining 1 predicted)
Ref <span class="token string">'refs/heads/oldrepo-head'</span> was rewritten

<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> new-master..oldrepo-head
Rewrite f2b2385d85c74dbf0cbf8fabc02ec30cb50d8f2a (3/6) (1 seconds passed, remaining 1 predicted)
Ref <span class="token string">'refs/heads/oldrepo-head'</span> was rewritten

sd@DESKTOP-RO11QOC MSYS /c/Users/sd/AppData/Local/Temp/newrepo_git
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> 427cf77417a
You must specify a ref to rewrite.

sd@DESKTOP-RO11QOC MSYS /c/Users/sd/AppData/Local/Temp/newrepo_git
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> new-master
Rewrite 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (2/2) (0 seconds passed, remaining 0 predicted)
Ref <span class="token string">'refs/heads/new-master'</span> was rewritten

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit cdaa4b82f3833770a9051a2490487548603e3af8 (HEAD -&gt; oldrepo-head)
|\  Merge: 427cf77 9bfc6cd
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:10 2019 +0200
| |
| |     Merge branch <span class="token string">'testbranch'</span>
| |
...
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (refs/original/refs/heads/new-master)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
|
|     added a.txt
|
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
...

<span class="token command">$ git branch<span class="token parameter"> -m</span> oldrepo-head master</span>
<span class="token command">$ git branch<span class="token parameter"> -D</span> oldrepo-root</span>
Deleted branch oldrepo-root (was ea0a32d).
<span class="token command">$ git branch<span class="token parameter"> -D</span> new-master</span>
Deleted branch new-master (was 4ac225e).
$ rm .git/refs/original/refs/heads/new-master
<span class="token command">$ git remote remove old-repo</span>

<span class="token command">$ git branch tmp 427cf774</span>
<span class="token command">$ git filter-branch<span class="token parameter"> -f</span><span class="token parameter"> --env</span>-filter </span><span class="token string">'export GIT_COMMITTER_DATE=$(git log -1 --pretty=%at $GIT_COMMIT)'</span> tmp^..tmp
Rewrite 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1 (1/1) (0 seconds passed, remaining 0 predicted)
Ref <span class="token string">'refs/heads/tmp'</span> was rewritten
<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller tmp</span>
* commit 4ac225e308e280e3a96be0168c6e9dece44d4979 (tmp)
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Mon May 27 14:31:10 2019 +0200
|
|     added a.txt
|
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
|
...
<span class="token command">$ git branch<span class="token parameter"> -D</span> tmp</span>
Deleted branch tmp (was 4ac225e).

<span class="token command">$ git log<span class="token parameter"> --graph</span><span class="token parameter"> --stat</span><span class="token parameter"> --pretty</span>=fuller</span>
*   commit cdaa4b82f3833770a9051a2490487548603e3af8
|\  Merge: 427cf77 9bfc6cd
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:10 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:10 2019 +0200
| | 
| |     Merge branch <span class="token string">'testbranch'</span>
| | 
| * commit 9bfc6cde58be9102102f839e5cc0fe8f25f0f78c
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:32:00 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:32:00 2019 +0200
| | 
| |     change 5 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 485ae0f50054610b6a41098fb695e59d194cc856
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:50 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:50 2019 +0200
| | 
| |     change 4 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit b6804b6e8e313b5c4766568a287f0785503e3a11
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:40 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:40 2019 +0200
| | 
| |     change 3 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 8b463423d2a99929a6a248e38ba1368a56d3769d
| | Author:     tester &lt;tester@example.com&gt;
| | AuthorDate: Mon May 27 14:31:30 2019 +0200
| | Commit:     bob &lt;bob@example.com&gt;
| | CommitDate: Mon May 27 14:31:30 2019 +0200
| | 
| |     change 2 made
| | 
| |  a.txt     | 1 +
| |  aa/aa.txt | 1 +
| |  aa/ab.txt | 1 +
| |  3 files changed, 3 insertions(+)
| | 
| * commit 3bc0bed30ebea1498a15711825b2ea8347cc374d
|/  Author:     tester &lt;tester@example.com&gt;
|   AuthorDate: Mon May 27 14:31:20 2019 +0200
|   Commit:     bob &lt;bob@example.com&gt;
|   CommitDate: Mon May 27 14:31:20 2019 +0200
|   
|       change 1 made
|   
|    a.txt     | 1 +
|    aa/aa.txt | 1 +
|    aa/ab.txt | 1 +
|    3 files changed, 3 insertions(+)
| 
* commit 427cf77417a2406db5dd6a0e9bd4fb60542f2ee1
| Author:     tester &lt;tester@example.com&gt;
| AuthorDate: Mon May 27 14:31:10 2019 +0200
| Commit:     bob &lt;bob@example.com&gt;
| CommitDate: Tue May 28 12:55:43 2019 +0200
| 
|     added a.txt
| 
|  a.txt | 1 +
|  1 file changed, 1 insertion(+)
| 
* commit 8e99c2d71048b4999d012b33d34386351d6d0fef
  Author:     bob &lt;bob@example.com&gt;
  AuthorDate: Mon May 27 14:31:00 2019 +0200
  Commit:     bob &lt;bob@example.com&gt;
  CommitDate: Mon May 27 14:31:00 2019 +0200

      Initial commit by Bob

   README | 1 +
   1 file changed, 1 insertion(+)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br></div></div><p><strong>22. Usage scenario: How do I change the date of all commits in a branch to now?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/52028045" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --env-filter <span class="token string">'GIT_COMMITTER_DATE=&quot;`date`&quot;; GIT_AUTHOR_DATE=&quot;`date`&quot;'</span>
git push -f origin master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>23. Usage scenario: Running git filter-branch subdirectory-filter to also remove get rid of other subdirectories history</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-update-ref.html">git update-ref</a>, <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-for-each-ref.html">git for-each-ref</a> ]    🌐<a href="https://stackoverflow.com/questions/39980849" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>path=android/
git for-each-ref --format=<span class="token string">'%(refname)'</span> |
while read ref; do
  if test <span class="token string">&quot;$(git rev-list --count &quot;</span>$ref<span class="token string">&quot; -- &quot;</span>$path<span class="token string">&quot;)&quot;</span> = 0; then
    echo <span class="token string">&quot;delete $ref&quot;</span>
  fi
done | git update-ref --stdin

git filter-branch -f --prune-empty --tag-name-filter cat --subdirectory-filter android -- --all

git for-each-ref --format=<span class="token string">&quot;%(refname)&quot;</span> refs/original/ | xargs -n 1 git update-ref -d
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>24. Usage scenario: Git filter-branch: keep only commits in subdir</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-reset.html">git reset</a> ]    🌐<a href="https://stackoverflow.com/questions/51542139" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment"># 1 Remove everything from root-tree (from the new revision)</span>
git rm --ignore-unmatch --cached -qr -- .

<span class="token comment"># 2 Restore challenge_gpsr sub-tree (from original revision)</span>
git reset -q \$GIT_COMMIT -- challenge_gpsr    

git filter-branch -f --index-filter &quot; \
    git reset -q 189bd987 -- . &amp;&amp; \
    git reset -q \$GIT_COMMIT -- challenge_gpsr \
<span class="token string">&quot; --prune-empty -- &quot;</span>robocup&quot; 189bd987..HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>25. Usage scenario: Two remote repositories, different forlders</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/38088147" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git checkout -b nameOfPublicBranch
// Create a new branch where you want to start to filter

git filter-branch -f --subdirectory-filter public
// This filters your branch down to commits that modified public (and below)

git push repoB nameOfPublicBranch
// now export to repoB just this stuff that you wanted on your branch nameOfPublicBranch

git checkout &lt;yourOldBranchName&gt;
// get back to your old branch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>26. Usage scenario: Git change user's credentials in past commits without changing the history (date of commits)</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/64854924" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch -f --env-filter &quot;
 GIT_AUTHOR_NAME=<span class="token string">'newName'</span>
 GIT_AUTHOR_EMAIL=<span class="token string">'newEmail'</span>
 GIT_COMMITER_NAME=<span class="token string">'newName'</span>
 GIT_COMMITER_EMAIL=<span class="token string">'newEmail'</span>
&quot; HEAD

git filter-branch -f --env-filter &quot;
if test <span class="token string">&quot;$GIT_AUTHOR_EMAIL&quot;</span> = <span class="token string">'currentWrongEmail'</span>
then
    GIT_AUTHOR_EMAIL=<span class="token string">'newEmail'</span>
fi
if test <span class="token string">&quot;$GIT_COMMITTER_EMAIL&quot;</span> = <span class="token string">'currentWrongEmail'</span>
then
    GIT_COMMITTER_EMAIL=<span class="token string">'newEmail'</span>
fi
&quot; HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>27. Usage scenario: How to keep the git commit history of a nested subdirectory when creating a submodule?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-clone.html">git clone</a> ]    🌐<a href="https://stackoverflow.com/questions/34664914" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git clone https://github.com/my-repo/ProjectA.git
cd ProjectA
git remote rm origin

git filter-branch -f --tree-filter <span class="token string">'shopt -s dotglob nullglob; test -d FrameworkB &amp;&amp; mv FrameworkB/* . || :'</span> HEAD

git filter-branch -f --tree-filter <span class="token string">'shopt -s dotglob nullglob; test -d FrameworkB/FrameworkB &amp;&amp; mv FrameworkB/FrameworkB/* FrameworkB/. || :'</span> HEAD

rm -r -f ProjectA/
rm -r -f ProjectA.xcodeproj
git commit -a -m <span class="token string">&quot;Remove the project files not associated with the shared framework.&quot;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>28. Usage scenario: How to cut some files from earlier commits in Git?</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/11217206" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --tree-filter <span class="token string">'rm -f passwords.txt'</span> HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>29. Usage scenario: How to fix branches of partial directory structure in SVN to Git migration</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-update-index.html">git update-index</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-merge-base.html">git merge-base</a>, <a href="/./richen/git-ls-files.html">git ls-files</a> ]    🌐<a href="https://stackoverflow.com/questions/15481085" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Initial situation
project1/
project2/
project3/
project4/

project3/

.project
src/
test/

▲ Step 1: Rewrite branch to move all contents into subdirectory (if needed)
git filter-branch --index-filter \
    'git ls-files -s | sed <span class="token string">&quot;s-\t\&quot;*-&amp;project3/-&quot;</span> |
        GIT_INDEX_FILE=$GIT_INDEX_FILE.new \
            git update-index --index-info &amp;&amp;
     mv <span class="token string">&quot;$GIT_INDEX_FILE.new&quot;</span> <span class="token string">&quot;$GIT_INDEX_FILE&quot;</span>' \
     master..project3-production-branch

▲ Step 2: Rewrite branch to restore other projects
branch=<span class="token string">&quot;project3-production-branch&quot;</span>
parent=`git merge-base $branch master` # or replace master with trunk if needed
paths=<span class="token string">&quot;project1 project2 project4&quot;</span>
git filter-branch -f --index-filter \
<span class="token string">&quot;git reset -q $parent -- $paths&quot;</span> --tag-name-filter cat -- \
$parent..$branch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="force"><a href="#force" class="header-anchor">#</a> 🔹 --force</h2> <p><strong>1. Usage scenario: New repo with copied history of only currently tracked files</strong></p> <blockquote><p><font size="2">💯Score: 45    🔗Associated commands: [ <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-ls-files.html">git ls-files</a>, <a href="/./richen/git-gc.html">git gc</a> ]    🌐<a href="https://stackoverflow.com/questions/17909526" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Delete everything and restore what you want
<span class="token comment"># for unix</span>

<span class="token command">$ git checkout master</span>
<span class="token command">$ git ls-files &gt; keep-these.txt</span>
<span class="token command">$ git filter-branch<span class="token parameter"> --force</span><span class="token parameter"> --index</span>-filter \</span>
  &quot;git rm  --ignore-unmatch --cached -qr . ; \
  cat $PWD/keep-these.txt | tr <span class="token string">'\n'</span> <span class="token string">'\0'</span> | xargs -d <span class="token string">'\0'</span> git reset -q \$GIT_COMMIT --&quot; \
  --prune-empty --tag-name-filter cat -- --all

<span class="token comment"># for macOS</span>

<span class="token command">$ git checkout master</span>
<span class="token command">$ git ls-files &gt; keep-these.txt</span>
<span class="token command">$ git filter-branch<span class="token parameter"> --force</span><span class="token parameter"> --index</span>-filter \</span>
  &quot;git rm  --ignore-unmatch --cached -qr . ; \
  cat $PWD/keep-these.txt | tr <span class="token string">'\n'</span> <span class="token string">'\0'</span> | xargs -0 git reset -q \$GIT_COMMIT --&quot; \
  --prune-empty --tag-name-filter cat -- --all

▲ Cleanup steps
$ rm -rf .git/refs/original/
<span class="token command">$ git reflog expire<span class="token parameter"> --expire</span>=now<span class="token parameter"> --all</span></span>
<span class="token command">$ git gc<span class="token parameter"> --prune</span>=now</span>

<span class="token comment"># optional extra gc. Slow and may not further-reduce the repo size</span>
<span class="token command">$ git gc<span class="token parameter"> --aggressive</span><span class="token parameter"> --prune</span>=now</span>

▲ $GIT_COMMIT?
<span class="token command">$ git filter-branch<span class="token parameter"> --index</span>-filter </span><span class="token string">&quot;echo current commit is \$GIT_COMMIT&quot;</span>
Rewrite d832800a85be9ef4ee6fda2fe4b3b6715c8bb860 (1/xxxxx)current commit is d832800a85be9ef4ee6fda2fe4b3b6715c8bb860
Rewrite cd86555549ac17aeaa28abecaf450b49ce5ae663 (2/xxxxx)current commit is cd86555549ac17aeaa28abecaf450b49ce5ae663
...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p><strong>2. Usage scenario: Clean Git Repository using gitignore</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-ls-files.html">git ls-files</a> ]    🌐<a href="https://stackoverflow.com/questions/30359405" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Only the last commit
git rm --cached -r .
git add .

▲ All commits (entire history)
git ls-files --exclude-standard --others --directory --ignored

<span class="token comment">#!/bin/bash</span>
for f in `git ls-files --exclude-standard --others --directory --ignored`
do
    git filter-branch --force --index-filter <span class="token string">&quot;git rm --cached --ignore-unmatch '$f'&quot;</span> --prune-empty --tag-name-filter cat -- --all
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>3. Usage scenario: How to remove all traces of a single file in git</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a> ]    🌐<a href="https://stackoverflow.com/questions/21213019" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --force --index-filter \
  <span class="token string">'git rm --cached --ignore-unmatch Rakefile'</span> \
  --prune-empty --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>4. Usage scenario: How to permanently delete a commit from Git's history?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-reflog.html">git reflog</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-gc.html">git gc</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/18014262" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Delete the file from a checkout
<span class="token command">$ git filter-branch<span class="token parameter"> --force</span><span class="token parameter"> --index</span>-filter \</span>
  <span class="token string">'git rm --cached --ignore-unmatch 200MB-filename'</span> \
  --prune-empty --tag-name-filter cat -- --all
<span class="token command">$ git push<span class="token parameter"> --all</span><span class="token parameter"> -f</span></span>

$ rm -rf .git/refs/original/
<span class="token command">$ git reflog expire<span class="token parameter"> --expire</span>=now<span class="token parameter"> --all</span></span>
<span class="token command">$ git gc<span class="token parameter"> --prune</span>=now</span>

▲ Recovering space on the git server
$ ssh git server
$ cd /my/project/repo.git
<span class="token command">$ git gc<span class="token parameter"> --prune</span>=now</span>

▲ Teammates
▲ User has no local commits
<span class="token command">$ git fetch</span>
<span class="token command">$ git reset origin/master<span class="token parameter"> -hard</span></span>

▲ User does have local commits
<span class="token command">$ git fetch</span>
<span class="token command">$ git rebase<span class="token parameter"> -i</span> origin/master</span>

▲ User cleanup
$ rm -rf .git/refs/original/
<span class="token command">$ git reflog expire<span class="token parameter"> --expire</span>=now<span class="token parameter"> --all</span></span>
<span class="token command">$ git gc<span class="token parameter"> --prune</span>=now</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p><strong>5. Usage scenario: Rename directory throughout Git commit history</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/26642892" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --force --tree-filter \
    <span class="token string">'mkdir -p foo/bar; mv baz foo/bar/ || true'</span> \
    --tag-name-filter cat -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>6. Usage scenario: How to remove GitHub commit along with it's history?</strong></p> <blockquote><p><font size="2">💯Score: 2    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-push.html">git push</a> ]    🌐<a href="https://stackoverflow.com/questions/44978525" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch --force --index-filter \
<span class="token string">'git rm --cached --ignore-unmatch PATH-TO-YOUR-CONFIG-FILE'</span> \
<span class="token deleted">--prune-empty --tag-name-filter cat -- --all</span>

echo <span class="token string">&quot;YOUR-CONFIG-FILE&quot;</span> &gt;&gt; .gitignore
git add .gitignore
git commit -m <span class="token string">&quot;Add YOUR-CONFIG-FILE to .gitignore&quot;</span>
git push origin --force --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="none"><a href="#none" class="header-anchor">#</a> 🔹None</h2> <p><strong>1. Usage scenario: How do I make a Git commit in the past?</strong></p> <blockquote><p><font size="2">💯Score: 231    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-hash-object.html">git hash-object</a>, <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-update-index.html">git update-index</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-tag.html">git tag</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-rebase.html">git rebase</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-rm.html">git rm</a>, <a href="/./richen/git-rev-parse.html">git rev-parse</a> ]    🌐<a href="https://stackoverflow.com/questions/3898842" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Specifying Dates Other Than “now”
Git internal format = &lt;unix timestamp&gt; &lt;time zone offset&gt;, e.g.  1112926393 +0200
RFC 2822            = e.g. Thu, 07 Apr 2005 22:13:13 +0200
ISO 8601            = e.g. 2005-04-07T22:13:13

▲ Inserting a File Into a Single ref History
<span class="token deleted">---A---B---C---o---o---o   master</span>

git checkout master
git checkout A~0
git add path/to/file
git commit --date=<span class="token string">'whenever'</span>
git tag ,new-commit -m<span class="token string">'delete me later'</span>
git checkout -
git rebase --onto ,new-commit A
git tag -d ,new-commit

<span class="token deleted">---A---N                      (was &quot;,new-commit&quot;, but we delete the tag)</span>
        \
         B<span class="token string">'---C'</span>---o---o---o   master

<span class="token deleted">---A'---B'---C'---o---o---o   master</span>

B---C---o---o---o   master

git checkout master
git checkout --orphan new-root
git rm -rf .
git add path/to/file
GIT_AUTHOR_DATE=<span class="token string">'whenever'</span> git commit
git checkout -
git rebase --root --onto new-root
git branch -d new-root

N                       (was new-root, but we deleted it)
 \
  B<span class="token string">'---C'</span>---o---o---o   master

▲ Inserting a File Into a Multi-ref History
new_file=$(git hash-object -w path/to/file)
git filter-branch \
  --index-filter \
    <span class="token string">'git update-index --add --cacheinfo 100644 '</span><span class="token string">&quot;$new_file&quot;</span><span class="token string">' path/to/file'</span> \
  --tag-name-filter cat \
  -- --all
git reset --hard

file_path=path/to/file
before_commit=$(git rev-parse --verify A)
file_blob=$(git hash-object -w <span class="token string">&quot;$file_path&quot;</span>)
git filter-branch \
  --index-filter '

    if x=$(git rev-list -1 <span class="token string">&quot;$GIT_COMMIT&quot;</span> --not <span class="token string">'&quot;$before_commit&quot;'</span>) &amp;&amp;
       test -n <span class="token string">&quot;$x&quot;</span>; then
         git update-index --add --cacheinfo 100644 <span class="token string">'&quot;$file_blob $file_path&quot;'</span>
    fi

  ' \
  --tag-name-filter cat \
  -- --all
git reset --hard

file_path=path/to/file
before_commit=$(git rev-parse --verify A)

git checkout master
git checkout <span class="token string">&quot;$before_commit&quot;</span>
git add <span class="token string">&quot;$file_path&quot;</span>
git commit --date=<span class="token string">'whenever'</span>
new_commit=$(git rev-parse --verify HEAD)
file_blob=$(git rev-parse --verify HEAD:<span class="token string">&quot;$file_path&quot;</span>)
git checkout -

git filter-branch \
  --parent-filter <span class="token string">&quot;sed -e s/$before_commit/$new_commit/g&quot;</span> \
  --index-filter '

    if x=$(git rev-list -1 <span class="token string">&quot;$GIT_COMMIT&quot;</span> --not <span class="token string">'&quot;$new_commit&quot;'</span>) &amp;&amp;
       test -n <span class="token string">&quot;$x&quot;</span>; then
         git update-index --add --cacheinfo 100644 <span class="token string">'&quot;$file_blob $file_path&quot;'</span>
    fi

  ' \
  --tag-name-filter cat \
  -- --all
git reset --hard
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br></div></div><p><strong>2. Usage scenario: How do I prepend history to a Git repository?</strong></p> <blockquote><p><font size="2">💯Score: 30    🔗Associated commands: [ <a href="/./richen/git-cat-file.html">git cat-file</a>, <a href="/./richen/git-hash-object.html">git hash-object</a>, <a href="/./richen/git-rev-list.html">git rev-list</a>, <a href="/./richen/git-replace.html">git replace</a>, <a href="/./richen/git-rev-parse.html">git rev-parse</a> ]    🌐<a href="https://stackoverflow.com/questions/1547490" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ Finding commit to attach (root of short history)
<span class="token command">$ git rev-list<span class="token parameter"> --topo</span>-order master | tail<span class="token parameter"> -n</span> 1</span>

<span class="token command">$ git rev-list<span class="token parameter"> --parents</span> master | grep<span class="token parameter"> -v</span> </span><span class="token string">' '</span>

$ TAIL=$(git rev-list --topo-order master | tail -n 1)

▲ Finding a commit to attach to (top of the historical repository)
<span class="token command">$ git rev-parse<span class="token parameter"> --verify</span> history^0</span>

$ TOP=$(git rev-parse --verify history^0)

▲ Joining history using a grafts file
$ echo <span class="token string">&quot;$TAIL $TOP&quot;</span> &gt;&gt; .git/info/grafts

▲ Rewriting history according to the grafts file
<span class="token command">$ git filter-branch $TOP..master</span>

<span class="token command">$ git filter-branch<span class="token parameter"> --all</span></span>

▲ Using refs/replace/ mechanism
<span class="token command">$ git cat-file commit $TAIL &gt; TAIL_COMMIT</span>


tree 2b5bfdf7798569e0b59b16eb9602d5fa572d6038
author Joe R Hacker  1112911993 -0700
committer Joe R Hacker  1112911993 -0700

Initial revision of <span class="token string">&quot;project&quot;</span>, after moving to new repository


tree 2b5bfdf7798569e0b59b16eb9602d5fa572d6038
parent 0f6592e3c2f2fe01f7b717618e570ad8dff0bbb1
author Joe R Hacker  1112911993 -0700
committer Joe R Hacker  1112911993 -0700

Initial revision of <span class="token string">&quot;project&quot;</span>, after moving to new repository

$ NEW_TAIL=$(git hash-object -t commit -w TAIL_COMMIT)

<span class="token command">$ git replace $TAIL $NEW_TAIL</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p><strong>3. Usage scenario: Adding ignore files to git repo retroactively</strong></p> <blockquote><p><font size="2">💯Score: 7    🔗Associated commands: [ <a href="/./richen/git-rm.html">git rm</a> ]    🌐<a href="https://stackoverflow.com/questions/5718107" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch \
    --index-filter <span class="token string">'git rm --cached --ignore-unmatch filename'</span> \
    --tag-name-filter cat \
    -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>4. Usage scenario: Change the root directory of a Git repository</strong></p> <blockquote><p><font size="2">💯Score: 6    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/11764065" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch \
  --subdirectory-filter dir1 \
  --tag-name-filter cat \
  -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>5. Usage scenario: How to unshallow a clone without unshallow?</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-replace.html">git replace</a> ]    🌐<a href="https://stackoverflow.com/questions/35510771" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git checkout --orphan temp abc123
git commit -C abc123   #creates a root commit with the contents and commit message of abc123
git replace abc123 temp  #<span class="token string">&quot;tricks&quot;</span> git into using the root commit instead of `abc123`
git filter-branch -- --all  #rewrites the whole repo
git checkout master
git branch -D temp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>6. Usage scenario: Git: How to squash all commits between two commits into a single commit</strong></p> <blockquote><p><font size="2">💯Score: 5    🔗Associated commands: [ <a href="/./richen/git-rebase.html">git rebase</a> ]    🌐<a href="https://stackoverflow.com/questions/43816219" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>       X
      / \
...--B   A--C--D--E   &lt;-- branch
      \ /
       Y

...--B--A--C--D--E   &lt;-- branch

...--B--A'-...

...--B--A<span class="token string">'-C'</span>-D<span class="token string">'-E'</span>  &lt;-- branch

▲ Using git rebase -i
...--B--X--Y<span class="token string">'-C'</span>-D<span class="token string">'-E'</span>   &lt;-- branch

...--B--XY<span class="token string">'-C'</span>-D<span class="token string">'-E'</span>   &lt;-- branch

▲ Using git replace
       X
      / \
...--B   A--C--D--E   &lt;-- branch
     |\ /
     | Y
     \
      A'  &lt;-- refs/replace/&lt;complicated-thing&gt;

▲ Making the replacement permanent, shedding X and Y entirely
E, D, C, A'

       X
      / \
...--B   A--C--D--E   &lt;-- refs/original/refs/heads/branch
     |\ /
     | Y
     \
      A'  &lt;-- refs/replace/&lt;complicated-thing&gt;
       \
        C<span class="token string">'-D'</span>-E'  &lt;-- branch

...--B--A<span class="token string">'-C'</span>-D<span class="token string">'-E'</span>  &lt;-- branch

▲ The mechanics of filter-branch
git filter-branch -- &lt;hash&gt;..branchname

▲ Using cherry-pick
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p><strong>7. Usage scenario: Rebase entire git branch onto orphan branch while keeping commit tree intact</strong></p> <blockquote><p><font size="2">💯Score: 4    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/47441465" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch &lt;filter-list&gt; &lt;branch-name&gt;

E--F--G--H--A<span class="token string">'-B'</span>-C<span class="token string">'-D'</span>   &lt;-- master

▲ Using git replace
A--B--C--D   &lt;-- master

E--F--G--H   &lt;-- master-old
          \
           A'   &lt;-- refs/replace/deadcabf001...

▲ Using filter-branch with replacements
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>8. Usage scenario: How to split a git repository into recent and older commits at a specific commit point, preserving branches?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-remote.html">git remote</a>, <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-commit-tree.html">git commit-tree</a>, <a href="/./richen/git-init.html">git init</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-branch.html">git branch</a>, <a href="/./richen/git-log.html">git log</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-push.html">git push</a>, <a href="/./richen/git-rev-parse.html">git rev-parse</a> ]    🌐<a href="https://stackoverflow.com/questions/48396032" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>▲ First create a branch for the historical commits
git branch history $TRUNCPOINT
git push project-history history:master
git push project-history A

git log --graph --oneline --decorate --all
* fdc8f84 (A) branchA a1
| * 7237a3e (HEAD -&gt; master) fourth
| * 55be55d third
|/  
* 26555d8 second
* 5a68ca2 first

▲ Create a base commit to serve as the parent for the recent commits
MESSAGE=<span class="token string">&quot;Get history from historical repository&quot;</span>
BASECOMMIT=`echo $MESSAGE | git commit-tree ${TRUNCPARENT}^{tree}`

▲ Split the repository by grafting the TRUNCPARENT onto BASECOMMIT
echo <span class="token string">&quot;${TRUNCPOINT} ${BASECOMMIT}&quot;</span> &gt; .git/info/grafts
git filter-branch -- --all
git push project-recent master
git push project-recent B

git log --graph --oneline --decorate --all
* 2335aeb (B) branchB b2
* 2bb7ea3 branchB b1
| * 83c3ae9 (HEAD -&gt; master) sixth
|/  
* 25931c5 fifth
* 1e1e201 fourth
* a7f3373 Get history from historical repository

▲ Fully reproduced example bash script
<span class="token comment">#!/bin/bash</span>
WORKDIR=${PWD}

create_repos () {
    rm -rf repo-split-example repo-split-recent repo-split-history
    # Create the repo to be split
    example_repo

    # Create the repo to contain the historical commits
    HISTREPO=<span class="token string">&quot;file://${WORKDIR}/repo-split-history&quot;</span>
    mkdir ../repo-split-history
    cd ../repo-split-history/
    git init --bare
    cd ../repo-split-example
    git remote add project-history $HISTREPO

    # Create the repo to contain the recent commits
    RECEREPO=<span class="token string">&quot;file://${WORKDIR}/repo-split-recent&quot;</span>
    mkdir ../repo-split-recent
    cd ../repo-split-recent/
    git init --bare
    cd ../repo-split-example
    git remote add project-recent $RECEREPO
}

example_repo () {
    # Part I: set up a test repo with our example commits
    mkdir repo-split-example
    cd repo-split-example/
    git init
    echo <span class="token string">&quot;We want to split the repository into project-recent and project-history portions, following the instructions at https://git-scm.com/book/en/v2/Git-Tools-Replace., but also including branches.&quot;</span> &gt; README.md
    echo <span class="token string">&quot; &quot;</span>
    echo <span class="token string">&quot;First commit.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;first&quot;</span>
    echo <span class="token string">&quot;Second commit.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;second&quot;</span>

    git checkout -b A HEAD
    echo <span class="token string">&quot;Add Branch A change.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;branchA a1&quot;</span>

    git checkout master
    echo <span class="token string">&quot;Third commit.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;third&quot;</span>
    TRUNCPARENT=`git rev-parse HEAD`

    echo <span class="token string">&quot;Fourth commit.&quot;</span> &gt;&gt; README.md 
    git add README.md
    git commit -m <span class="token string">&quot;fourth&quot;</span>
    TRUNCPOINT=`git rev-parse HEAD`

    echo <span class="token string">&quot;Fifth commit.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;fifth&quot;</span>
    FIFTH=`git rev-parse HEAD`

    git checkout -b B HEAD
    echo <span class="token string">&quot;Add Branch B change. b1&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;branchB b1&quot;</span>
    B1=`git rev-parse HEAD`

    echo <span class="token string">&quot;Add Branch B change. b2&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;branchB b2&quot;</span>
    B2=`git rev-parse HEAD`

    git checkout master
    echo <span class="token string">&quot;Sixth commit.&quot;</span> &gt;&gt; README.md
    git add README.md
    git commit -m <span class="token string">&quot;sixth&quot;</span>

    # Now we have a repo with the requisite structure, ready to be split
    git log --graph --all --oneline --decorate
}


split_repo () {
    # Part II: Split the git repo into historical and current halves at $TRUNCPOINT
    # Following guidelines at https://git-scm.com/book/en/v2/Git-Tools-Replace

    # First create a branch for the historical commits
    echo <span class="token string">&quot;Branching history at $TRUNCPOINT&quot;</span>
    git branch history $TRUNCPOINT
    git log --graph --oneline --decorate history A

    # Now copy the history repo to the remote HISTREPO repository
    git push project-history history:master
    git push project-history A

    # Now to split the repo to get the recent history from TRUNCPOINT to HEAD of master
    # Create a base commit for the new new recent history
    MESSAGE=<span class="token string">&quot;Get history from historical repository at $HISTREPO&quot;</span>
    BASECOMMIT=`echo $MESSAGE | git commit-tree ${TRUNCPARENT}^{tree}`

    # Split the repository by grafting the TRUNCPARENT onto BASECOMMIT
    echo <span class="token string">&quot;${TRUNCPOINT} ${BASECOMMIT}&quot;</span> &gt; .git/info/grafts
    git filter-branch -- --all

    # Finally, push the current rewritten master and associated branches to a new repository
    git push project-recent master
    git push project-recent B
}

create_repos
split_repo 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br></div></div><p><strong>9. Usage scenario: How to move E..H commits into a separate repository?</strong></p> <blockquote><p><font size="2">💯Score: 3    🔗Associated commands: [ <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-rev-parse.html">git rev-parse</a> ]    🌐<a href="https://stackoverflow.com/questions/13376022" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>cd /path/to/repo
git checkout -b newbranch special
git rev-parse E &gt; .git/info/grafts
git filter-branch
rm .git/info/grafts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>10. Usage scenario: Insert a commit without merging</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-gc.html">git gc</a> ]    🌐<a href="https://stackoverflow.com/questions/16255435" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code><span class="token comment"># use a graft to temporarily change the parent of B to be D</span>
echo <span class="token string">&quot;$SHA_B $SHA_D&quot;</span> &gt; .git/info/grafts
<span class="token comment"># apply the grafts, changing the SHAs of the commits B...C</span>
git filter-branch
<span class="token comment"># remove old pending commits</span>
git gc
<span class="token comment"># remove the no longer needed grafts</span>
rm .git/info/grafts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>11. Usage scenario: Starting a new repository from a previous file on another repository</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ None ]    🌐<a href="https://stackoverflow.com/questions/40979642" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git filter-branch \
  --tree-filter \
    <span class="token string">'find . -path . -o -path path/to/keep.txt -o -print0 | xargs -0 rm -f'</span> \
  --prune-empty \
  --tag-name-filter cat \
  -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>12. Usage scenario: Git split commit before branch</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-commit.html">git commit</a>, <a href="/./richen/git-reset.html">git reset</a>, <a href="/./richen/git-add.html">git add</a>, <a href="/./richen/git-checkout.html">git checkout</a>, <a href="/./richen/git-replace.html">git replace</a> ]    🌐<a href="https://stackoverflow.com/questions/59848124" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git checkout B
git reset A

git add files whose changes all belong in B1
git add --patch files whose changes partially belong in B1
git reset --patch any hunks you added by mistake
git commit   # this makes B1
git add .    # everything that remains belongs in B2, so add everything
git commit   # this makes B2

git replace --graft C B2
git filter-branch -- --all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>13. Usage scenario: Migrating two svn paths to a new single git repository</strong></p> <blockquote><p><font size="2">💯Score: 1    🔗Associated commands: [ <a href="/./richen/git-fetch.html">git fetch</a>, <a href="/./richen/git-remote.html">git remote</a> ]    🌐<a href="https://stackoverflow.com/questions/44700289" target="_blank" rel="noopener noreferrer">Details<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></font></p></blockquote> <p><strong>Example:</strong></p> <div class="language-git line-numbers-mode"><pre class="language-git"><code>git remote add oldproject ../oldproject
git fetch

echo <span class="token string">&quot;$commit-id $graft-id&quot;</span> &gt;&gt; .git/info/grafts
git filter-branch $graft-id..HEAD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/./richen/git-fetch-pack.html" class="prev">
        git fetch-pack
      </a></span> <span class="next"><a href="/./richen/git-fmt-merge-msg.html">
        git fmt-merge-msg
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="./assets/js/app.e311b099.js" defer></script><script src="./assets/js/2.48635caf.js" defer></script><script src="./assets/js/56.d43fb632.js" defer></script>
  </body>
</html>
