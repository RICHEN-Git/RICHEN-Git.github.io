(window.webpackJsonp=window.webpackJsonp||[]).push([[150],{579:function(s,t,e){"use strict";e.r(t);var n=e(19),a=Object(n.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),e("p",[s._v("📖 "+s._s(s.$page.readingTime.text)+"    🔡 "+s._s(s.$page.readingTime.words)),e("br")])]),s._v(" "),e("h1",{attrs:{id:"git-verify-pack-validate-packed-git-archive-files"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#git-verify-pack-validate-packed-git-archive-files"}},[s._v("#")]),s._v(" 📌 git verify-pack - Validate packed Git archive files")]),s._v(" "),e("h2",{attrs:{id:"v"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#v"}},[s._v("#")]),s._v(" 🔹 -v")]),s._v(" "),e("p",[e("strong",[s._v("1. Usage scenario: How to find/identify large commits in git history?")])]),s._v(" "),e("blockquote",[e("p",[e("font",{attrs:{size:"2"}},[s._v("💯Score: 172    🔗Associated commands: [ "),e("RouterLink",{attrs:{to:"/richen/git-rev-list.html"}},[s._v("git rev-list")]),s._v(" ]    🌐"),e("a",{attrs:{href:"https://stackoverflow.com/questions/10622293",target:"_blank",rel:"noopener noreferrer"}},[s._v("Details"),e("OutboundLink")],1)],1)],1)]),s._v(" "),e("p",[e("strong",[s._v("Example:")])]),s._v(" "),e("div",{staticClass:"language-git line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-git"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#set -x ")]),s._v("\n \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Shows you the largest objects in your repo's pack file.")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Written for osx.")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# @see https://stubbisms.wordpress.com/2009/07/10/git-script-to-show-largest-pack-objects-and-trim-your-waist-line/")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# @author Antony Stubbs")]),s._v("\n \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# set the internal field separator to line break, so that we can iterate easily over the verify-pack output")]),s._v("\nIFS=$"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\n'")]),s._v(";\n \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# list all objects including their size, sort by size, take top 10")]),s._v("\nobjects=`git verify-pack -v .git/objects/pack/pack-*.idx | grep -v chain | sort -k3nr | head`\n \necho "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"All sizes are in kB\'s. The pack column is the size of the object, compressed, inside the pack file."')]),s._v("\n \noutput="),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"size,pack,SHA,location"')]),s._v("\nallObjects=`git rev-list --all --objects`\nfor y in $objects\ndo\n    # extract the size in bytes\n    size=$((`echo $y | cut -f 5 -d "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("' '")]),s._v("`/1024))\n    # extract the compressed size in bytes\n    compressedSize=$((`echo $y | cut -f 6 -d "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("' '")]),s._v("`/1024))\n    # extract the SHA\n    sha=`echo $y | cut -f 1 -d "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("' '")]),s._v("`\n    # find the objects location in the repository tree\n    other=`echo "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${allObjects}"')]),s._v(" | grep $sha`\n    #lineBreak=`echo -e "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\n"')]),s._v("`\n    output="),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${output}\\n${size},${compressedSize},${other}"')]),s._v("\ndone\n \necho -e $output | column -t -s "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("', '")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br")])]),e("p",[e("strong",[s._v("2. Usage scenario: How can I reduce the size of my git repo?")])]),s._v(" "),e("blockquote",[e("p",[e("font",{attrs:{size:"2"}},[s._v("💯Score: 1    🔗Associated commands: [ "),e("RouterLink",{attrs:{to:"/richen/git-rev-list.html"}},[s._v("git rev-list")]),s._v(", "),e("RouterLink",{attrs:{to:"/richen/git-filter-branch.html"}},[s._v("git filter-branch")]),s._v(", "),e("RouterLink",{attrs:{to:"/richen/git-rm.html"}},[s._v("git rm")]),s._v(", "),e("RouterLink",{attrs:{to:"/richen/git-clone.html"}},[s._v("git clone")]),s._v(", "),e("RouterLink",{attrs:{to:"/richen/git-gc.html"}},[s._v("git gc")]),s._v(", "),e("RouterLink",{attrs:{to:"/richen/git-push.html"}},[s._v("git push")]),s._v(" ]    🌐"),e("a",{attrs:{href:"https://stackoverflow.com/questions/34327110",target:"_blank",rel:"noopener noreferrer"}},[s._v("Details"),e("OutboundLink")],1)],1)],1)]),s._v(" "),e("p",[e("strong",[s._v("Example:")])]),s._v(" "),e("div",{staticClass:"language-git line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-git"}},[e("code",[s._v("git rev-list --objects --all | sort -k 2 > allfileshas.txt\n\ngit gc && git verify-pack -v .git/objects/pack/pack-*.idx | egrep "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^\\w+ blob\\W+[0-9]+ [0-9]+ [0-9]+$"')]),s._v(" | sort -k 3 -n -r > bigobjects.txt\n\ngit filter-branch --prune-empty --index-filter "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git rm -rf --cached --ignore-unmatch MY-BIG-DIRECTORY-OR-FILE'")]),s._v(" --tag-name-filter cat -- --all\n\ngit clone --no-hardlinks file:///Users/yourUser/your/full/repo/path repo-clone-name\n\ngit push --force\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])])])}),[],!1,null,null,null);t.default=a.exports}}]);